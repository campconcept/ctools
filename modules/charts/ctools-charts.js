var t={75:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function a(){a=function t(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",s=c.toStringTag||"@@toStringTag";function d(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:1,configurable:1,writable:1}),t[e]}try{d({},"")}catch(t){d=function t(e,r,n){return e[r]=n}}function h(t,e,r,n){var a=e&&e.prototype instanceof w?e:w,o=Object.create(a.prototype),c=new O(n||[]);return i(o,"_invoke",{value:C(t,r,c)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",g="suspendedYield",m="executing",y="completed",v={};function w(){}function b(){}function x(){}var D={};d(D,l,(function(){return this}));var E=Object.getPrototypeOf,k=E&&E(E(N([])));k&&k!==r&&o.call(k,l)&&(D=k);var S=x.prototype=w.prototype=Object.create(D);function T(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(a,i,c,l){var u=p(t[a],t,i);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==n(d)&&o.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,c,l)}),(function(t){r("throw",t,c,l)})):e.resolve(d).then((function(t){s.value=t,c(s)}),(function(t){return r("throw",t,c,l)}))}l(u.arg)}var a;i(this,"_invoke",{value:function t(n,o){function i(){return new e((function(t,e){r(n,o,t,e)}))}return a=a?a.then(i,i):i()}})}function C(e,r,n){var a=f;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===y){if("throw"===o)throw i;return{value:t,done:1}}for(n.method=o,n.arg=i;;){var c=n.delegate;if(c){var l=j(c,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=m;var u=p(e,r,n);if("normal"===u.type){if(a=n.done?y:g,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=y,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=p(a,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(1)}function N(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function r(){for(;++a<e.length;)if(o.call(e,a))return r.value=e[a],r.done=0,r;return r.value=t,r.done=1,r};return i.next=i}}throw new TypeError(n(e)+" is not iterable")}return b.prototype=x,i(S,"constructor",{value:x,configurable:1}),i(x,"constructor",{value:b,configurable:1}),b.displayName=d(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,d(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},T(L.prototype),d(L.prototype,u,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new L(h(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},T(S),d(S,s,"Generator"),d(S,l,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=0,t}return t.done=1,t}},e.values=N,O.prototype={constructor:O,reset:function e(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=0,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!r)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function t(){this.done=1;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function e(r){if(this.done)throw r;var n=this;function a(e,a){return l.type="throw",l.arg=r,n.next=e,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],l=c.completion;if("root"===c.tryLoc)return a("end");if(c.tryLoc<=this.prev){var u=o.call(c,"catchLoc"),s=o.call(c,"finallyLoc");if(u&&s){if(this.prev<c.catchLoc)return a(c.catchLoc,1);if(this.prev<c.finallyLoc)return a(c.finallyLoc)}else if(u){if(this.prev<c.catchLoc)return a(c.catchLoc,1)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return a(c.finallyLoc)}}}},abrupt:function t(e,r){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&o.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=e,c.arg=r,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(c)},complete:function t(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),v}},catch:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var o=a.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function e(r,n,a){return this.delegate={iterator:N(r),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),v}},e}function o(t,e,r,n,a,o,i){try{var c=t[o](i),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,a)}function i(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var i=t.apply(e,r);function c(t){o(i,n,a,c,l,"next",t)}function l(t){o(i,n,a,c,l,"throw",t)}c(void 0)}))}}r.d(e,{Qm:()=>g,kC:()=>L,tZ:()=>D,wi:()=>k});var c="ctoolsHourlyData",l=1,u="hourlyReadings",s="ctoolsHourlyDataSyncVersion",d="1.0.0",h=1e4,p,f=0;function g(){if(!f){f=1;var t=indexedDB.open(c,l);t.onerror=function(t){console.error("Error opening IndexedDB:",t.target.error)},t.onupgradeneeded=function(t){console.log("Creating or upgrading hourly data database...");var e=t.target.result;if(e.objectStoreNames.contains(u)){var r,n=t.target.transaction.objectStore(u);n.indexNames.contains("zaehlerid_datum")||(n.createIndex("zaehlerid_datum",["zaehlerid","datum"],{unique:0}),console.log("Added compound index for zaehlerid_datum"))}else{var a=e.createObjectStore(u,{keyPath:"dsid"});a.createIndex("zaehlerid","zaehlerid",{unique:0}),a.createIndex("datum","datum",{unique:0}),a.createIndex("zaehlerid_datum",["zaehlerid","datum"],{unique:0})}},t.onsuccess=function(t){p=t.target.result,console.log("Hourly data database opened successfully"),m(),w(),x()}}}function m(){var t=localStorage.getItem(s);t!==d&&(console.log("Updating sync version from ".concat(t||"none"," to ").concat(d)),localStorage.setItem(s,d))}function y(){return v.apply(this,arguments)}function v(){return(v=i(a().mark((function t(){return a().wrap((function t(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(t,e){try{if(!p)return void e(new Error("Database not initialized"));var r,n=p.transaction([u],"readonly").objectStore(u),a=null,o=null,i=n.openCursor(null,"next");i.onsuccess=function(e){var r=e.target.result;if(r){a=r.value.dsid;var i=n.openCursor(null,"prev");i.onsuccess=function(e){var r=e.target.result;if(r){o=r.value.dsid;var i=new Date,c="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(String(i.getDate()).padStart(2,"0"));if(null!==o){var l,u=n.index("datum").openCursor(IDBKeyRange.upperBound(c,1),"prev");u.onsuccess=function(e){var r=e.target.result;r&&(o=r.value.dsid),t({oldestDsid:a,newestDsid:o})},u.onerror=function(e){console.error("Error getting yesterday's data:",e.target.error),t({oldestDsid:a,newestDsid:o})}}else t({oldestDsid:a,newestDsid:o})}else t({oldestDsid:a,newestDsid:o})},i.onerror=function(e){console.error("Error getting max dsid:",e.target.error),t({oldestDsid:a,newestDsid:null})}}else t({oldestDsid:null,newestDsid:null})},i.onerror=function(e){console.error("Error getting min dsid:",e.target.error),t({oldestDsid:null,newestDsid:null})}}catch(c){console.error("Error in getDataBoundaries:",c),e(c)}})));case 1:case"end":return e.stop()}}),t)})))).apply(this,arguments)}function w(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new Promise(function(){var r=i(a().mark((function r(n,o){var i,c,l,u,s,d,p,f,g;return a().wrap((function r(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,console.log("Starting hourly data sync... (".concat(e?"newer":"older"," records)")),m.next=4,y();case 4:i=m.sent,c=i.oldestDsid,l=i.newestDsid,t&&(c=null,l=null),u=e?"newestDsid":"oldestDsid",d={action:"hourlyData",limit:h},null!==(s=e?l:c)&&(d[u]=s),p=0,f=0,g=a().mark((function t(){var r,o,i,c,l,u;return a().wrap((function t(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,fetch("index.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(d)});case 2:if((o=a.sent).ok){a.next=5;break}throw new Error("HTTP error: ".concat(o.status));case 5:return a.next=7,o.json();case 7:if(i=a.sent,c=i.data||[],p=(null===(r=i.meta)||void 0===r?void 0:r.has_more)||0,console.log("Received ".concat(c.length," hourly readings from server. Has more: ").concat(p)),0!==c.length){a.next=14;break}return n(1),a.abrupt("return",1);case 14:return a.next=16,b(c);case 16:f+=c.length,p&&(l=0,u=Number.MAX_SAFE_INTEGER,c.forEach((function(t){t[0]>l&&(l=t[0]),t[0]<u&&(u=t[0])})),d={action:"hourlyData",limit:h},e?d.newestDsid=l:d.oldestDsid=u);case 18:case"end":return a.stop()}}),t)}));case 15:return m.delegateYield(g(),"t0",16);case 16:if(!m.t0){m.next=18;break}return m.abrupt("break",19);case 18:if(p){m.next=15;break}case 19:if(console.log("Sync completed. Total records synchronized: ".concat(f)),!(f>0)){m.next=29;break}return m.prev=21,m.next=24,w(0,!e);case 24:m.next=29;break;case 26:m.prev=26,m.t1=m.catch(21),console.warn("Error syncing ".concat(e?"older":"newer"," records:"),m.t1);case 29:n(1),m.next=36;break;case 32:m.prev=32,m.t2=m.catch(0),console.error("Error in syncHourlyData:",m.t2),o(m.t2);case 36:case"end":return m.stop()}}),r,null,[[0,32],[21,26]])})));return function(t,e){return r.apply(this,arguments)}}())}function b(t){return new Promise((function(e,r){try{if(!p)return void r(new Error("Database not initialized"));var n=p.transaction([u],"readwrite"),a=n.objectStore(u);n.onerror=function(t){console.error("Transaction error:",t.target.error),r(t.target.error)},n.oncomplete=function(){e()},t.forEach((function(t){try{var e,r,n,o={dsid:Number(t[0]),zaehlerid:Number(t[1]),datum:String(t[2]),val_start:null!==t[3]?Number(t[3]):0,val_0:null!==t[4]?Number(t[4]):0,val_1:null!==t[5]?Number(t[5]):0,val_2:null!==t[6]?Number(t[6]):0,val_3:null!==t[7]?Number(t[7]):0,val_4:null!==t[8]?Number(t[8]):0,val_5:null!==t[9]?Number(t[9]):0,val_6:null!==t[10]?Number(t[10]):0,val_7:null!==t[11]?Number(t[11]):0,val_8:null!==t[12]?Number(t[12]):0,val_9:null!==t[13]?Number(t[13]):0,val_10:null!==t[14]?Number(t[14]):0,val_11:null!==t[15]?Number(t[15]):0,val_12:null!==t[16]?Number(t[16]):0,val_13:null!==t[17]?Number(t[17]):0,val_14:null!==t[18]?Number(t[18]):0,val_15:null!==t[19]?Number(t[19]):0,val_16:null!==t[20]?Number(t[20]):0,val_17:null!==t[21]?Number(t[21]):0,val_18:null!==t[22]?Number(t[22]):0,val_19:null!==t[23]?Number(t[23]):0,val_20:null!==t[24]?Number(t[24]):0,val_21:null!==t[25]?Number(t[25]):0,val_22:null!==t[26]?Number(t[26]):0,val_23:null!==t[27]?Number(t[27]):0,val_end:null!==t[28]?Number(t[28]):0,usage_day:null!==t[29]?Number(t[29]):0};a.put(o)}catch(i){console.error("Error processing row:",i,t)}}))}catch(o){console.error("Error in storeHourlyData:",o),r(o)}}))}function x(){setInterval((function(){w()}),3e5);var t=function e(){var r=new Date,n,a=60*(60-r.getMinutes())*1e3-1e3*r.getSeconds()-r.getMilliseconds();setTimeout((function(){console.log("Hour changed, syncing hourly data..."),w(),t()}),a)};t()}function D(t,e){return new Promise((function(r,n){try{var a=function t(){console.warn("Compound index not available, falling back to less efficient query method");var a,i=c.index("zaehlerid").getAll(o);i.onsuccess=function(t){var n=t.target.result,a=n.find((function(t){return t.datum===e}));console.log("Found ".concat(n.length," records with zaehlerid ").concat(o,", matching record for date ").concat(e,": ").concat(a?"yes":"no")),r(a||null)},i.onerror=function(t){console.error("Error querying hourly data:",t.target.error),n(t.target.error)}};if(!p)return void n(new Error("Database not initialized"));if(null==t)return void n(new Error("zaehlerid must be provided"));var o=Number(t);if(isNaN(o))return void n(new Error("Invalid zaehlerid: ".concat(t)));console.log("Looking up data for zaehlerid: ".concat(o,", date: ").concat(e));var i,c=p.transaction([u],"readonly").objectStore(u);if(c.indexNames.contains("zaehlerid_datum")){var l=c.index("zaehlerid_datum"),s=[o,e],d=l.get(s);d.onsuccess=function(t){var n=t.target.result;console.log("Direct compound index lookup for zaehlerid ".concat(o,", date ").concat(e,": ").concat(n?"found":"not found")),r(n||null)},d.onerror=function(t){console.error("Error querying hourly data with compound index:",t.target.error),a()}}else a()}catch(h){console.error("Error in getHourlyDataForCounter:",h),n(h)}}))}function E(t){return new Promise((function(e,r){try{if(!p)return void r(new Error("Database not initialized"));if(null==t)return void r(new Error("zaehlerid must be provided"));var n=Number(t);if(isNaN(n))return void r(new Error("Invalid zaehlerid: ".concat(t)));console.log("Getting all data for zaehlerid: ".concat(n));var a,o,i=p.transaction([u],"readonly").objectStore(u).getAll();i.onsuccess=function(t){var r,a=t.target.result.filter((function(t){return t.zaehlerid===n}));console.log("Found ".concat(a.length," records for zaehlerid ").concat(n)),e(a)},i.onerror=function(t){console.error("Error querying hourly data:",t.target.error),r(t.target.error)}}catch(c){console.error("Error in getAllHourlyDataForCounter:",c),r(c)}}))}function k(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(n,a){try{var o=function a(){if(null!==r&&"number"==typeof r){var o,c=s.index("zaehlerid").getAll(r);c.onsuccess=function(r){var a,o=(r.target.result||[]).filter((function(r){return r.datum>=t&&r.datum<=e}));n(o)},c.onerror=function(t){console.error("Error querying by zaehlerid:",t.target.error),i()}}else i()},i=function o(){var i=s.index("datum"),c=IDBKeyRange.bound(t,e),l=i.getAll(c);l.onsuccess=function(t){var e=t.target.result||[],a=null!==r&&"number"==typeof r?e.filter((function(t){return t.zaehlerid===r})):e;n(a)},l.onerror=function(t){console.error("Error querying by date range:",t.target.error),a(t.target.error)}};if(!p)return void a(new Error("db_not_init"));if(!t||!e)return void a(new Error("supply_start_and_end_date"));if(!/^\d{4}-\d{2}-\d{2}$/.test(t)||!/^\d{4}-\d{2}-\d{2}$/.test(e))return void a(new Error("date_mismatch"));if(t>e){console.log("Swapping dates: startDate (".concat(t,") was after endDate (").concat(e,")"));var c=[e,t];t=c[0],e=c[1]}var l,s=p.transaction([u],"readonly").objectStore(u);if(null!==r&&"number"==typeof r)if(s.indexNames.contains("zaehlerid_datum")){var d=s.index("zaehlerid_datum"),h=[],f=[r,t],g=[r,e],m=IDBKeyRange.bound(f,g),y=d.openCursor(m);y.onsuccess=function(t){var e=t.target.result;e?(h.push(e.value),e.continue()):n(h)},y.onerror=function(t){console.error("Error using compound index:",t.target.error),o()}}else o();else o()}catch(v){console.error("Error in getHourlyDataForDateRange:",v),a(v)}}))}function S(){return new Promise((function(t,e){try{if(!p)return void e(new Error("Database not initialized"));var r,n,a=p.transaction([u],"readwrite").objectStore(u).clear();a.onsuccess=function(){console.log("All hourly data cleared"),t()},a.onerror=function(t){console.error("Error clearing hourly data:",t.target.error),e(t.target.error)}}catch(o){console.error("Error in clearAllHourlyData:",o),e(o)}}))}function T(){return new Promise(function(){var t=i(a().mark((function t(e,r){var n,o,i,c,l,d,h;return a().wrap((function t(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,p){a.next=4;break}return r(new Error("Database not initialized")),a.abrupt("return");case 4:return n=p.transaction([u],"readonly"),o=n.objectStore(u),i=o.count(),a.next=9,y();case 9:c=a.sent,l=c.oldestDsid,d=c.newestDsid,h={recordCount:0,oldestDsid:l,newestDsid:d,syncVersion:localStorage.getItem(s)},i.onsuccess=function(){h.recordCount=i.result,e(h)},i.onerror=function(t){console.error("Error getting record count:",t.target.error),r(t.target.error)},a.next=21;break;case 17:a.prev=17,a.t0=a.catch(0),console.error("Error in getHourlyDataStats:",a.t0),r(a.t0);case 21:case"end":return a.stop()}}),t,null,[[0,17]])})));return function(e,r){return t.apply(this,arguments)}}())}function L(t){return new Promise((function(e,r){try{if(!p)return void r(new Error("Database not initialized"));if(null==t)return void r(new Error("zaehlerid must be provided"));var n=Number(t);if(isNaN(n))return void r(new Error("Invalid zaehlerid: ".concat(t)));var a,o,i,c=p.transaction([u],"readonly").objectStore(u).index("zaehlerid").getAll(n);c.onsuccess=function(t){var r=t.target.result,n=new Set;r.forEach((function(t){t.datum&&n.add(t.datum)}));var a=Array.from(n).sort();e(a)},c.onerror=function(t){console.error("Error querying available dates:",t.target.error),r(t.target.error)}}catch(l){console.error("Error in getAvailableDatesForCounter:",l),r(l)}}))}},121:(t,e,r)=>{r.r(e),r.d(e,{formatDateFromPicker:()=>x,highlightAvailableDates:()=>D,initDatePicker:()=>b,initializeChartResources:()=>d,initializeDatepicker:()=>g,loadChartJs:()=>p,setupDatepickerLocalization:()=>w});var n=r(75),a=r(515);function o(){o=function t(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},l=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",s=c.toStringTag||"@@toStringTag";function d(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:1,configurable:1,writable:1}),t[e]}try{d({},"")}catch(t){d=function t(e,r,n){return e[r]=n}}function h(t,e,r,n){var o=e&&e.prototype instanceof w?e:w,i=Object.create(o.prototype),c=new O(n||[]);return a(i,"_invoke",{value:C(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",g="suspendedYield",m="executing",y="completed",v={};function w(){}function b(){}function x(){}var D={};d(D,l,(function(){return this}));var E=Object.getPrototypeOf,k=E&&E(E(N([])));k&&k!==r&&n.call(k,l)&&(D=k);var S=x.prototype=w.prototype=Object.create(D);function T(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(a,o,c,l){var u=p(t[a],t,o);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==i(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,c,l)}),(function(t){r("throw",t,c,l)})):e.resolve(d).then((function(t){s.value=t,c(s)}),(function(t){return r("throw",t,c,l)}))}l(u.arg)}var o;a(this,"_invoke",{value:function t(n,a){function i(){return new e((function(t,e){r(n,a,t,e)}))}return o=o?o.then(i,i):i()}})}function C(e,r,n){var a=f;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===y){if("throw"===o)throw i;return{value:t,done:1}}for(n.method=o,n.arg=i;;){var c=n.delegate;if(c){var l=j(c,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=m;var u=p(e,r,n);if("normal"===u.type){if(a=n.done?y:g,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=y,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=p(a,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(1)}function N(e){if(e||""===e){var r=e[l];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=0,r;return r.value=t,r.done=1,r};return o.next=o}}throw new TypeError(i(e)+" is not iterable")}return b.prototype=x,a(S,"constructor",{value:x,configurable:1}),a(x,"constructor",{value:b,configurable:1}),b.displayName=d(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,d(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},T(L.prototype),d(L.prototype,u,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new L(h(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},T(S),d(S,s,"Generator"),d(S,l,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=0,t}return t.done=1,t}},e.values=N,O.prototype={constructor:O,reset:function e(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=0,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!r)for(var a in this)"t"===a.charAt(0)&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function t(){this.done=1;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function e(r){if(this.done)throw r;var a=this;function o(e,n){return l.type="throw",l.arg=r,a.next=e,n&&(a.method="next",a.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],l=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var u=n.call(c,"catchLoc"),s=n.call(c,"finallyLoc");if(u&&s){if(this.prev<c.catchLoc)return o(c.catchLoc,1);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(u){if(this.prev<c.catchLoc)return o(c.catchLoc,1)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function t(e,r){for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=e,c.arg=r,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(c)},complete:function t(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),v}},catch:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var o=a.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function e(r,n,a){return this.delegate={iterator:N(r),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),v}},e}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function c(t,e,r,n,a,o,i){try{var c=t[o](i),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,a)}function l(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(t){c(o,n,a,i,l,"next",t)}function l(t){c(o,n,a,i,l,"throw",t)}i(void 0)}))}}var u=0,s=0;function d(){return h.apply(this,arguments)}function h(){return(h=l(o().mark((function t(){var e,r;return o().wrap((function t(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,console.warn("Beginning to initialize chart resources"),(0,a.C)(),(0,n.Qm)(),o.next=6,p();case 6:return e=o.sent,o.next=9,g();case 9:return r=o.sent,o.abrupt("return",e&&r);case 13:return o.prev=13,o.t0=o.catch(0),console.error("Failed to initialize chart resources:",o.t0),o.abrupt("return",0);case 17:case"end":return o.stop()}}),t,null,[[0,13]])})))).apply(this,arguments)}function p(){return f.apply(this,arguments)}function f(){return(f=l(o().mark((function t(){return o().wrap((function t(e){for(;;)switch(e.prev=e.next){case 0:if(!s&&"undefined"==typeof Chart){e.next=3;break}return s=1,e.abrupt("return",1);case 3:return e.prev=3,e.next=6,y("https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js");case 6:if("undefined"!=typeof Chart){e.next=8;break}throw new Error("Chart.js loaded but Chart object not available");case 8:return s=1,console.log("Chart.js loaded successfully"),e.abrupt("return",1);case 13:return e.prev=13,e.t0=e.catch(3),console.error("Error loading Chart.js:",e.t0),e.abrupt("return",0);case 17:case"end":return e.stop()}}),t,null,[[3,13]])})))).apply(this,arguments)}function g(){return m.apply(this,arguments)}function m(){return(m=l(o().mark((function t(){return o().wrap((function t(e){for(;;)switch(e.prev=e.next){case 0:if(!u&&"undefined"==typeof tempusDominus){e.next=3;break}return"undefined"!=typeof tempusDominus&&(w(),u=1),e.abrupt("return",u);case 3:return e.prev=3,v("https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.7.7/dist/css/tempus-dominus.min.css"),e.next=7,y("https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.7.7/dist/js/tempus-dominus.min.js");case 7:if("undefined"!=typeof tempusDominus){e.next=9;break}throw new Error("Tempus Dominus loaded but object not available");case 9:return w(),u=1,console.warn("Datepicker initialized successfully"),e.abrupt("return",1);case 15:return e.prev=15,e.t0=e.catch(3),console.error("Failed to initialize datepicker:",e.t0),e.abrupt("return",0);case 19:case"end":return e.stop()}}),t,null,[[3,15]])})))).apply(this,arguments)}function y(t){return new Promise((function(e,r){var n=document.createElement("script");n.src=t,n.async=1,n.onload=function(){return e()},n.onerror=function(t){return r(t)},document.head.appendChild(n)}))}function v(t){var e=document.createElement("link");e.rel="stylesheet",e.href=t,document.head.appendChild(e)}function w(){if("undefined"!=typeof tempusDominus){var t=window.getCurrentLanguage(),e=t.substring(0,2);try{tempusDominus.DefaultOptions.localization={locale:e,format:"yyyy-MM-dd",dayViewHeaderFormat:{month:"long",year:"numeric"}},tempusDominus.DefaultOptions.useCurrent=0,tempusDominus.DefaultOptions.keepInvalid=0;try{for(var r=[],n=new Intl.DateTimeFormat(t,{weekday:"short"}),a=0;a<7;a++){var o=new Date(2023,0,a+1);r.push(n.format(o))}for(var i=[],c=new Intl.DateTimeFormat(t,{month:"long"}),l=0;l<12;l++){var u=new Date(2023,l,1);i.push(c.format(u))}tempusDominus.DefaultOptions.localization.dayNames=r,tempusDominus.DefaultOptions.localization.monthNames=i;var s=["en-US","en-CA"];if(tempusDominus.DefaultOptions.localization.startOfTheWeek=s.includes(t)?0:1,"function"==typeof window.getTranslatedText)try{tempusDominus.DefaultOptions.localization.today=window.getTranslatedText("general","today")||"Today"}catch(d){tempusDominus.DefaultOptions.localization.today="Today"}}catch(h){console.warn("Error setting up datepicker localization details:",h)}}catch(h){console.warn("Error in datepicker localization setup:",h)}}else console.warn("Tempus Dominus library not loaded, skipping datepicker localization")}function b(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;try{var o=function e(){try{D(t,u)}catch(r){console.error("Error in datepicker highlight callback:",r)}};console.warn("Attempting to initialize datepicker: ".concat(t));var c=document.getElementById(t),l;if(!c)return console.error("Datepicker container #".concat(t," not found!")),null;if("undefined"==typeof tempusDominus||!tempusDominus.TempusDominus)return console.error("tempusDominus library not available!",{tempusDominus:"undefined"==typeof tempusDominus?"undefined":i(tempusDominus),TempusDominus:null!==(l=tempusDominus)&&void 0!==l&&l.TempusDominus?"exists":"undefined"}),null;var u=new Set(r),s=new Date;a||(a="".concat(s.getFullYear(),"-").concat(String(s.getMonth()+1).padStart(2,"0"),"-").concat(String(s.getDate()).padStart(2,"0")));var d=new tempusDominus.TempusDominus(c,{display:{inline:1,components:{clock:0},calendarWeeks:0},restrictions:{minDate:n?new Date(n+"T00:00:00"):void 0,maxDate:a?new Date(a+"T23:59:59"):void 0},localization:{locale:window.getCurrentLanguage().substring(0,2),format:"L",dayViewHeaderFormat:{month:"long",year:"numeric"}},useCurrent:0,defaultDate:e});if(!d)return console.error("Failed to create datepicker instance"),null;if(console.warn("Datepicker created successfully: ".concat(t),{pickerExists:!!d,subscribeMethod:i(d.subscribe),hasDisplay:!!d.display}),D(t,u),"function"==typeof d.subscribe)try{d.subscribe(tempusDominus.Namespace.events.update,o),d.subscribe(tempusDominus.Namespace.events.change,o),console.warn("Datepicker event subscriptions added successfully")}catch(h){console.error("Failed to subscribe to datepicker events:",h)}else console.error("datepicker.subscribe is not a function!",d);return d}catch(h){return console.error("Exception in initDatePicker:",h),null}}function x(t){if(!t.date)return null;var e=t.date.year,r=String(t.date.month+1).padStart(2,"0"),n=String(t.date.date).padStart(2,"0");return"".concat(e,"-").concat(r,"-").concat(n)}function D(t,e){var r=document.getElementById(t),n;r&&r.querySelectorAll(".date-container-days .day").forEach((function(t){if(t.classList.remove("highlighted"),!t.classList.contains("disabled")){var r=t.getAttribute("data-value");if(r){var n=r.split("T")[0];e.has(n)&&t.classList.add("highlighted")}}}))}},178:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n={charts:{counterValue:"Compteur: {0}",backToDailyView:"Retour \xe0 l'aper\xe7u quotidien",clickDayInstructions:"Cliquez sur un jour pour afficher les donn\xe9es horaires",hourlyConsumption:"Consommation Horaire (kWh)",dailyConsumption:"Consommation Journali\xe8re (kWh)",hourlyData:"Donn\xe9es Horaires: {0}",dailyData:"Consommation Journali\xe8re: {0}",date:"Date:",startDate:"Date de D\xe9but",endDate:"Date de Fin",consumption:"Consommation: {0}",noDataAvailable:"Aucune donn\xe9e disponible pour cette p\xe9riode.",close:"Fermer",day:"Jour",hour:"Heure",history:{title:"Historique: {0}",hourlyData:"Consommation Horaire (Aujourd'hui)",dailyData:"Consommation Journali\xe8re (7 Derniers Jours)"}},chartStats:{title:"Statistiques",total:"Consommation Totale",average:"Moyenne",median:"M\xe9diane",statistics:"Statistiques",averageLine:"Moyenne",medianLine:"M\xe9diane"},chartExport:{abortExport:"Annuler",processingMonth:"Traitement du mois: {current} / {total}",processingDay:"Traitement du jour: {current} / {total}",aborting:"Annulation en cours...",exportCancelled:"L'exportation PDF a \xe9t\xe9 annul\xe9e",hourlyConsumptionData:"Donn\xe9es de Consommation Horaire",dailyConsumptionData:"Donn\xe9es de Consommation Journali\xe8re",exportDropdown:"Exporter",exportingPDF:"G\xe9n\xe9ration du PDF en cours...",exportPDFWithDaily:"PDF avec valeurs horaires",exportExcelWithDaily:"Excel avec valeurs horaires",overviewSheet:"Vue d'ensemble",detailsSheet:"D\xe9tails Quotidiens",exportExcel:"Exporter vers Excel",exportPDF:"Exporter en PDF",hour:"Heure",date:"Date",consumption:"Consommation",counter:"Compteur",dataSheet:"Donn\xe9es de Consommation",errorExporting:"Erreur lors de l'exportation des donn\xe9es"},chartPDF:{pageNumbers:"Page {current} sur {total}"}}},240:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n={charts:{counterValue:"Contatore: {0}",backToDailyView:"Torna alla panoramica giornaliera",clickDayInstructions:"Clicca su un giorno per visualizzare i dati orari",hourlyConsumption:"Consumo Orario (kWh)",dailyConsumption:"Consumo Giornaliero (kWh)",hourlyData:"Dati Orari: {0}",dailyData:"Consumo Giornaliero: {0}",date:"Data:",startDate:"Data di Inizio",endDate:"Data di Fine",consumption:"Consumo: {0}",noDataAvailable:"Nessun dato disponibile per questo periodo.",close:"Chiudi",day:"Giorno",hour:"Ora",history:{title:"Cronologia: {0}",hourlyData:"Consumo Orario (Oggi)",dailyData:"Consumo Giornaliero (Ultimi 7 Giorni)"}},chartStats:{title:"Statistiche",total:"Consumo Totale",average:"Media",median:"Mediana",statistics:"Statistiche",averageLine:"Media",medianLine:"Mediana"},chartExport:{abortExport:"Interrompere",processingMonth:"Elaborazione mese: {current} / {total}",processingDay:"Elaborazione giorno: {current} / {total}",aborting:"Interruzione in corso...",exportCancelled:"L'esportazione PDF \xe8 stata annullata",hourlyConsumptionData:"Dati di Consumo Orario",dailyConsumptionData:"Dati di Consumo Giornaliero",exportDropdown:"Esporta",exportingPDF:"Generazione PDF in corso...",exportPDFWithDaily:"PDF con valori orari",exportExcelWithDaily:"Excel con valori orari",overviewSheet:"Panoramica",detailsSheet:"Dettagli Giornalieri",exportExcel:"Esporta Excel",exportPDF:"Esporta PDF",hour:"Ora",date:"Data",consumption:"Consumo",counter:"Contatore",dataSheet:"Dati di Consumo",errorExporting:"Errore durante l'esportazione dei dati"},chartPDF:{pageNumbers:"Pagina {current} di {total}"}}},290:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n={charts:{counterValue:"Contador: {0}",backToDailyView:"Volver a la vista diaria",clickDayInstructions:"Haga clic en un d\xeda para ver los datos por hora",hourlyConsumption:"Consumo Por Hora (kWh)",dailyConsumption:"Consumo Diario (kWh)",hourlyData:"Datos Por Hora: {0}",dailyData:"Consumo Diario: {0}",date:"Fecha:",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",consumption:"Consumo: {0}",noDataAvailable:"No hay datos disponibles para este per\xedodo.",close:"Cerrar",day:"D\xeda",hour:"Hora",history:{title:"Historial: {0}",hourlyData:"Consumo Por Hora (Hoy)",dailyData:"Consumo Diario (\xdaltimos 7 D\xedas)"}},chartStats:{title:"Estad\xedsticas",total:"Consumo Total",average:"Promedio",median:"Mediana",statistics:"Estad\xedsticas",averageLine:"Promedio",medianLine:"Mediana"},chartExport:{abortExport:"Abortar",processingMonth:"Procesando mes: {current} / {total}",processingDay:"Procesando d\xeda: {current} / {total}",aborting:"Abortando...",exportCancelled:"La exportaci\xf3n PDF ha sido cancelada",hourlyConsumptionData:"Datos de Consumo por Hora",dailyConsumptionData:"Datos de Consumo Diario",exportDropdown:"Exportar",exportingPDF:"Generando PDF...",exportPDFWithDaily:"PDF con valores por hora",exportExcelWithDaily:"Excel con valores por hora",overviewSheet:"Resumen",detailsSheet:"Detalles Diarios",exportExcel:"Exportar Excel",exportPDF:"Exportar PDF",hour:"Hora",date:"Fecha",consumption:"Consumo",counter:"Contador",dataSheet:"Datos de Consumo",errorExporting:"Error al exportar datos"},chartPDF:{pageNumbers:"P\xe1gina {current} de {total}"}}},359:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n={charts:{counterValue:"\u0160tevec: {0}",backToDailyView:"Nazaj na dnevni pregled",clickDayInstructions:"Kliknite na dan za ogled urnih podatkov",hourlyConsumption:"Urna Poraba (kWh)",dailyConsumption:"Dnevna Poraba (kWh)",hourlyData:"Urni Podatki: {0}",dailyData:"Dnevna Poraba: {0}",date:"Datum:",startDate:"Za\u010detni Datum",endDate:"Kon\u010dni Datum",consumption:"Poraba: {0}",noDataAvailable:"Za to obdobje ni na voljo podatkov.",close:"Zapri",day:"Dan",hour:"Ura",history:{title:"Zgodovina: {0}",hourlyData:"Urna Poraba (Danes)",dailyData:"Dnevna Poraba (Zadnjih 7 Dni)"}},chartStats:{title:"Statistika",total:"Skupna Poraba",average:"Povpre\u010dje",median:"Mediana",statistics:"Statistika",averageLine:"Povpre\u010dje",medianLine:"Mediana"},chartExport:{abortExport:"Prekini",processingMonth:"Obdelava meseca: {current} / {total}",processingDay:"Obdelava dneva: {current} / {total}",aborting:"Prekinjanje...",exportCancelled:"Izvoz PDF je bil preklican",hourlyConsumptionData:"Podatki o Urni Porabi",dailyConsumptionData:"Podatki o Dnevni Porabi",exportDropdown:"Izvoz",exportingPDF:"Ustvarjanje PDF-ja...",exportPDFWithDaily:"PDF z urnimi vrednostmi",exportExcelWithDaily:"Excel z urnimi vrednostmi",overviewSheet:"Pregled",detailsSheet:"Dnevni Podatki",exportExcel:"Izvoz Excel",exportPDF:"Izvoz PDF",hour:"Ura",date:"Datum",consumption:"Poraba",counter:"\u0160tevec",dataSheet:"Podatki o Porabi",errorExporting:"Napaka pri izvozu podatkov"},chartPDF:{pageNumbers:"Stran {current} od {total}"}}},405:(t,e,r)=>{var n={"./charts-lang-de-DE.js":456,"./charts-lang-en-US.js":559,"./charts-lang-es-ES.js":290,"./charts-lang-fr-FR.js":178,"./charts-lang-hr-HR.js":778,"./charts-lang-it-IT.js":240,"./charts-lang-nl-NL.js":846,"./charts-lang-sl-SI.js":359};function a(t){var e=o(t);return r(e)}function o(t){if(!r.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}a.keys=function t(){return Object.keys(n)},a.resolve=o,t.exports=a,a.id=405},456:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n={charts:{counterValue:"Z\xe4hlerstand: {0}",backToDailyView:"Zur\xfcck zur Tages\xfcbersicht",clickDayInstructions:"Klicke auf einen Tag, um st\xfcndliche Daten anzuzeigen",hourlyConsumption:"St\xfcndlicher Verbrauch (kWh)",dailyConsumption:"T\xe4glicher Verbrauch (kWh)",hourlyData:"St\xfcndliche Daten: {0}",dailyData:"T\xe4glicher Verbrauch: {0}",date:"Datum:",startDate:"Startdatum",endDate:"Enddatum",consumption:"Verbrauch: {0}",noDataAvailable:"Keine Daten f\xfcr diesen Zeitraum verf\xfcgbar.",close:"Schlie\xdfen",day:"Tag",hour:"Stunde",history:{title:"Verlauf: {0}",hourlyData:"St\xfcndlicher Verbrauch (Heute)",dailyData:"T\xe4glicher Verbrauch (Letzte 7 Tage)"}},chartStats:{title:"Statistik",total:"Gesamtverbrauch",average:"Durchschnitt",median:"Median",statistics:"Statistiken",averageLine:"Durchschnitt",medianLine:"Median"},chartExport:{abortExport:"Abbrechen",processingMonth:"Verarbeitung Monat: {current} / {total}",processingDay:"Verarbeitung Tag: {current} / {total}",aborting:"Wird abgebrochen...",exportCancelled:"PDF-Export wurde abgebrochen",hourlyConsumptionData:"St\xfcndliche Verbrauchsdaten",dailyConsumptionData:"T\xe4gliche Verbrauchsdaten",exportDropdown:"Exportieren",exportingPDF:"PDF wird erstellt...",exportPDFWithDaily:"PDF mit Stundenwerten",exportExcelWithDaily:"Excel mit Stundenwerten",overviewSheet:"\xdcbersicht",detailsSheet:"Tagesdetails",exportExcel:"Excel exportieren",exportPDF:"PDF exportieren",hour:"Stunde",date:"Datum",consumption:"Verbrauch",counter:"Z\xe4hlerstand",dataSheet:"Verbrauchsdaten",errorExporting:"Fehler beim Exportieren der Daten"},chartPDF:{pageNumbers:"Seite {current} von {total}"}}},515:(t,e,r)=>{r.d(e,{j:()=>Wt,C:()=>Gt});var n=r(75);function a(t){return l(t)||c(t)||i(t)||o()}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(t,e){if(t){if("string"==typeof t)return u(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,e):void 0}}function c(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function l(t){if(Array.isArray(t))return u(t)}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function s(t){if(!t||0===t.length)return{total:0,average:0,median:0};var e=t.filter((function(t){return null!=t&&!isNaN(t)}));if(0===e.length)return{total:0,average:0,median:0};var r=e.reduce((function(t,e){return t+e}),0),n=r/e.length,o=a(e).sort((function(t,e){return t-e})),i;if(o.length%2==0){var c=o.length/2;i=(o[c-1]+o[c])/2}else i=o[Math.floor(o.length/2)];return{total:r,average:n,median:i}}function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"kWh",r=t.total,n=t.average,a=t.median,o=window.getCurrentLanguage();return'\n    <div class="chart-stats-panel">\n        <div class="stat-item">\n            <span class="stat-label">'.concat(window.getTranslatedText("chartStats","total"),':</span>\n            <span class="stat-value">').concat(window.formatNumber(r," ".concat(e),o,2),'</span>\n        </div>\n        <div class="stat-item">\n            <span class="stat-label">').concat(window.getTranslatedText("chartStats","average"),':</span>\n            <span class="stat-value">').concat(window.formatNumber(n," ".concat(e),o,2),'</span>\n        </div>\n        \x3c!--\n        <div class="stat-item">\n            <span class="stat-label">').concat(window.getTranslatedText("chartStats","median"),':</span>\n            <span class="stat-value">').concat(window.formatNumber(a," ".concat(e),o,2),"</span>\n        </div>\n        --\x3e\n    </div>")}function h(t,e){return{averageLine:{type:"line",label:window.getTranslatedText("chartStats","averageLine"),data:Array(e).fill(t.average),borderColor:"rgba(255, 99, 132, 1)",borderWidth:1.5,borderDash:[5,5],pointRadius:0,fill:0,tension:0}}}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"kWh";return{responsive:1,maintainAspectRatio:0,devicePixelRatio:window.devicePixelRatio,scales:{y:{beginAtZero:1,title:{display:1,text:t},grace:"5%",ticks:{callback:function t(e){return window.formatNumber(e,"",window.getCurrentLanguage(),2)}}}},plugins:{tooltip:{callbacks:{label:function t(e){var r=e.raw,n="",a;if(n=window.getTranslatedText("charts","consumption").replace("{0}",window.formatNumber(r," kWh",window.getCurrentLanguage(),2)),e.dataset&&e.dataset.counterValues&&void 0!==e.dataset.counterValues[e.dataIndex]){var o=e.dataset.counterValues[e.dataIndex],i;n=[n,window.getTranslatedText("charts","counterValue").replace("{0}",window.formatNumber(o," kWh",window.getCurrentLanguage(),2))]}return n}}},legend:{display:1}}}}function f(t){t&&(t.innerHTML='\n        <div class="alert alert-info">\n            '.concat(window.getTranslatedText("charts","noDataAvailable"),"\n        </div>\n    "))}function g(t){var e=t.modalId,r=t.chartId,n=t.title,a=t.isHourly,o=t.hasParent,i=t.minDate,c=void 0===i?"":i,l=t.maxDate,u=void 0===l?"":l,s=t.startDate,d=void 0===s?"":s,h=t.endDate,p=void 0===h?"":h,f=t.showClickInstructions,g,m=void 0!==f&&f?'<div class="text-end me-3 mt-1 small text-muted">\n             <i class="fa-solid fa-circle-info me-1"></i>'.concat(window.getTranslatedText("charts","clickDayInstructions"),"\n           </div>"):"",y=o?'<div class="text-center mt-3">\n             <button type="button" id="back-to-daily-btn" class="btn btn-outline-secondary" data-translation-key="charts.backToDailyView">\n                 <i class="fa-solid fa-arrow-left me-2"></i>'.concat(window.getTranslatedText("charts","backToDailyView"),"\n             </button>\n           </div>"):"",v=a?"":'<div class="row mb-3">\n             <div class="col-md-6">\n                 <label class="form-label text-center w-100">'.concat(window.getTranslatedText("charts","startDate"),'</label>\n                 <div id="').concat(e,'-start-datepicker" class="inline-calendar d-flex justify-content-center"></div>\n                 <input type="hidden" id="').concat(e,'-start-date" value="').concat(d,'">\n             </div>\n             <div class="col-md-6">\n                 <label class="form-label text-center w-100">').concat(window.getTranslatedText("charts","endDate"),'</label>\n                 <div id="').concat(e,'-end-datepicker" class="inline-calendar d-flex justify-content-center"></div>\n                 <input type="hidden" id="').concat(e,'-end-date" value="').concat(p,'">\n             </div>\n           </div>'),w='\n        <li><a class="dropdown-item" href="#" data-export-action="pdf" data-chart-id="'.concat(r,'" data-include-daily="false">\n            <i class="fa-solid fa-file-pdf me-2"></i>').concat(window.getTranslatedText("chartExport","exportPDF"),"\n        </a></li>\n        ").concat(a?"":'\n        <li><a class="dropdown-item" href="#" data-export-action="pdf-daily" data-chart-id="'.concat(r,'" data-include-daily="true">\n            <i class="fa-solid fa-file-pdf me-2"></i>').concat(window.getTranslatedText("chartExport","exportPDFWithDaily"),"\n        </a></li>\n        "),'\n        <li><hr class="dropdown-divider"></li>\n        <li><a class="dropdown-item" href="#" data-export-action="excel" data-chart-id="').concat(r,'" data-include-daily="false">\n            <i class="fa-solid fa-file-excel me-2"></i>').concat(window.getTranslatedText("chartExport","exportExcel"),"\n        </a></li>\n        ").concat(a?"":'\n        <li><a class="dropdown-item" href="#" data-export-action="excel-daily" data-chart-id="'.concat(r,'" data-include-daily="true">\n            <i class="fa-solid fa-file-excel me-2"></i>').concat(window.getTranslatedText("chartExport","exportExcelWithDaily"),"\n        </a></li>\n        "));return'\n    <div class="modal fade" id="'.concat(e,'" tabindex="-1" aria-labelledby="').concat(e,'-label" aria-hidden="true">\n        <div class="modal-dialog modal-dialog-centered modal-lg">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title" id="').concat(e,'-label">').concat(n,'</h5>\n                    <div class="d-flex" style="padding: calc(var(--bs-modal-header-padding-y) * .5) calc(var(--bs-modal-header-padding-x) * .5); margin: calc(-.5 * var(--bs-modal-header-padding-y)) calc(-.5 * var(--bs-modal-header-padding-x)) calc(-.5 * var(--bs-modal-header-padding-y)) auto;">\n                        <div class="dropdown me-2">\n                            <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" id="').concat(e,'-export-dropdown" data-bs-toggle="dropdown" aria-expanded="false">\n                                <i class="fa-solid fa-file-export"></i> ').concat(window.getTranslatedText("chartExport","exportDropdown"),'\n                            </button>\n                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="').concat(e,'-export-dropdown">\n                                ').concat(w,'\n                            </ul>\n                        </div>\n                    </div>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="padding: calc(var(--bs-modal-header-padding-y) * .5) calc(var(--bs-modal-header-padding-x) * .5);margin: 0 !important;"></button>                    \n                </div>\n                <div class="modal-body">\n                    ').concat(v,'\n                    <div class="chart-container" style="position: relative; height: 400px; max-height: 500px; overflow: hidden;">\n                        <div id="').concat(r,'" style="width: 100%; height: 100%;"></div>\n                    </div>\n                    ').concat(m,"\n                    ").concat(y,"\n                </div>\n            </div>\n        </div>\n    </div>\n    ")}function m(t){if(!t)return{consumption:[],counterValues:[]};var e=[t.val_1||0,t.val_2||0,t.val_3||0,t.val_4||0,t.val_5||0,t.val_6||0,t.val_7||0,t.val_8||0,t.val_9||0,t.val_10||0,t.val_11||0,t.val_12||0,t.val_13||0,t.val_14||0,t.val_15||0,t.val_16||0,t.val_17||0,t.val_18||0,t.val_19||0,t.val_20||0,t.val_21||0,t.val_22||0,t.val_23||0,t.val_end||0],r=[],n=t.val_start||0,a=[];return e.forEach((function(t,o){if(0===t&&o>0&&0!==e[o-1])r.push(0),a.push(n);else{var i=Math.max(0,t-n);r.push(i),a.push(t),0!==t&&(n=t)}})),{consumption:r,counterValues:a}}function y(){return["00 - 01","01 - 02","02 - 03","03 - 04","04 - 05","05 - 06","06 - 07","07 - 08","08 - 09","09 - 10","10 - 11","11 - 12","12 - 13","13 - 14","14 - 15","15 - 16","16 - 17","17 - 18","18 - 19","19 - 20","20 - 21","21 - 22","22 - 23","23 - 24"]}function v(t){return t.map((function(t){var e=t.split("-");return"".concat(e[2],".").concat(e[1],".")}))}function w(t,e,r){return"hourly"===t?{label:window.getTranslatedText("charts","hourlyConsumption"),data:e,backgroundColor:"rgba(54, 162, 235, 0.5)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1,counterValues:r}:{label:window.getTranslatedText("charts","dailyConsumption"),data:e,backgroundColor:"rgba(75, 192, 192, 0.5)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1,counterValues:r}}function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function x(t){return k(t)||E(t)||_(t)||D()}function D(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function k(t){if(Array.isArray(t))return O(t)}function S(){S=function t(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:1,configurable:1,writable:1}),t[e]}try{u({},"")}catch(t){u=function t(e,r,n){return e[r]=n}}function s(t,e,r,n){var o=e&&e.prototype instanceof y?e:y,i=Object.create(o.prototype),c=new O(n||[]);return a(i,"_invoke",{value:C(t,r,c)}),i}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function y(){}function v(){}function w(){}var x={};u(x,i,(function(){return this}));var D=Object.getPrototypeOf,E=D&&D(D(N([])));E&&E!==r&&n.call(E,i)&&(x=E);var k=w.prototype=y.prototype=Object.create(x);function T(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(a,o,i,c){var l=d(t[a],t,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==b(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function t(n,a){function i(){return new e((function(t,e){r(n,a,t,e)}))}return o=o?o.then(i,i):i()}})}function C(e,r,n){var a=h;return function(o,i){if(a===f)throw Error("Generator is already running");if(a===g){if("throw"===o)throw i;return{value:t,done:1}}for(n.method=o,n.arg=i;;){var c=n.delegate;if(c){var l=j(c,n);if(l){if(l===m)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===h)throw a=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=f;var u=d(e,r,n);if("normal"===u.type){if(a=n.done?g:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=g,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=d(a,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(1)}function N(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=0,r;return r.value=t,r.done=1,r};return o.next=o}}throw new TypeError(b(e)+" is not iterable")}return v.prototype=w,a(k,"constructor",{value:w,configurable:1}),a(w,"constructor",{value:v,configurable:1}),v.displayName=u(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,u(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},T(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new L(s(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},T(k),u(k,l,"Generator"),u(k,i,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=0,t}return t.done=1,t}},e.values=N,O.prototype={constructor:O,reset:function e(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=0,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!r)for(var a in this)"t"===a.charAt(0)&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function t(){this.done=1;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function e(r){if(this.done)throw r;var a=this;function o(e,n){return l.type="throw",l.arg=r,a.next=e,n&&(a.method="next",a.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],l=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var u=n.call(c,"catchLoc"),s=n.call(c,"finallyLoc");if(u&&s){if(this.prev<c.catchLoc)return o(c.catchLoc,1);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(u){if(this.prev<c.catchLoc)return o(c.catchLoc,1)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function t(e,r){for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=e,c.arg=r,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(c)},complete:function t(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),m},finish:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),m}},catch:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var o=a.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function e(r,n,a){return this.delegate={iterator:N(r),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),m}},e}function T(t,e){return j(t)||C(t,e)||_(t,e)||L()}function L(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function C(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,a,o,i,c=[],l=1,u=0;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;l=0}else for(;!(l=(n=o.call(r)).done)&&(c.push(n.value),c.length!==e);l=1);}catch(t){u=1,a=t}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(u)throw a}}return c}}function j(t){if(Array.isArray(t))return t}function P(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=_(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,a=function t(){};return{s:a,n:function e(){return n>=t.length?{done:1}:{done:0,value:t[n++]}},e:function t(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=1,c=0;return{s:function e(){r=r.call(t)},n:function t(){var e=r.next();return i=e.done,e},e:function t(e){c=1,o=e},f:function t(){try{i||null==r.return||r.return()}finally{if(c)throw o}}}}function _(t,e){if(t){if("string"==typeof t)return O(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(t,e):void 0}}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function N(t,e,r,n,a,o,i){try{var c=t[o](i),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,a)}function F(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(t){N(o,n,a,i,c,"next",t)}function c(t){N(o,n,a,i,c,"throw",t)}i(void 0)}))}}var z=0,I=0;function A(t,e,r,n){return M.apply(this,arguments)}function M(){return M=F(S().mark((function t(e,r,n,a){var o,i,c,l,u,s,d,h,p,f,g,m,y,v,w,b,x,D,E,k,L,C,j,P,_,O,N,F,M,H,V,W,U,Y,K,q,X,$,J,Q,tt,et,rt,nt,ot,ct,ut,st,dt,ht,pt,ft,gt,mt=arguments;return S().wrap((function t(S){for(;;)switch(S.prev=S.next){case 0:if(o=mt.length>4&&void 0!==mt[4]?mt[4]:"kWh",i=mt.length>5&&void 0!==mt[5]?mt[5]:0,S.prev=2,"undefined"!=typeof jspdf||"undefined"!=typeof jsPDF){S.next=7;break}return console.error("jsPDF library not found. Loading fallback..."),Z((function(){setTimeout((function(){return A(e,r,n,a,o)}),1e3)})),S.abrupt("return");case 7:if(z=0,I=0,(c=document.createElement("div")).style.position="fixed",c.style.top="0",c.style.left="0",c.style.width="100%",c.style.height="100%",c.style.backgroundColor="rgba(0,0,0,0.5)",c.style.display="flex",c.style.justifyContent="center",c.style.alignItems="center",c.style.zIndex="9999",c.innerHTML='\n            <div style="background: white; padding: 20px; border-radius: 5px; text-align: center; min-width: 300px;">\n                <div><i class="fa-solid fa-spinner fa-spin fa-2x"></i></div>\n                <div style="margin-top: 10px;">'.concat(window.getTranslatedText("chartExport","exportingPDF")||"Generating PDF...",'</div>\n                <div id="pdf-export-month-progress-container" style="margin-top: 15px; display: none;">\n                    <div class="progress" style="height: 10px;">\n                        <div id="pdf-export-month-progress-bar" class="progress-bar" role="progressbar" style="width: 0%;" \n                            aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                    </div>\n                    <div id="pdf-export-month-progress-text" style="margin-top: 5px; font-size: 0.8em;">\n                        <span id="pdf-export-month-current">0</span> / <span id="pdf-export-month-total">0</span>\n                    </div>\n                </div>\n                <div id="pdf-export-progress-container" style="margin-top: 15px; display: none;">\n                    <div class="progress" style="height: 10px;">\n                        <div id="pdf-export-progress-bar" class="progress-bar" role="progressbar" style="width: 0%;" \n                            aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                    </div>\n                    <div id="pdf-export-progress-text" style="margin-top: 5px; font-size: 0.8em;">\n                        <span id="pdf-export-progress-type"></span>: <span id="pdf-export-current">0</span> / <span id="pdf-export-total">0</span>\n                    </div>\n                </div>\n                <div style="margin-top: 15px;">\n                    <button id="pdf-export-abort-btn" class="btn btn-sm btn-outline-secondary">\n                        <i class="fa-solid fa-times me-1"></i>').concat(window.getTranslatedText("chartExport","abortExport")||"Abort","\n                    </button>\n                </div>\n            </div>\n        "),document.body.appendChild(c),(l=document.getElementById("pdf-export-abort-btn"))&&l.addEventListener("click",(function(){z=1,l.disabled=1,l.innerHTML='<i class="fa-solid fa-spinner fa-spin me-1"></i>'.concat(window.getTranslatedText("chartExport","aborting")||"Aborting...")})),u=function t(e){"Escape"===e.key&&(z=1,l&&(l.disabled=1,l.innerHTML='<i class="fa-solid fa-spinner fa-spin me-1"></i>'.concat(window.getTranslatedText("chartExport","aborting")||"Aborting...")))},document.addEventListener("keydown",u),s="undefined"!=typeof jspdf?jspdf.jsPDF:jsPDF,d=e.data.labels||[],h=e.data.datasets||[],p=h.length>0?h[0]:{data:[]},f=p.data||[],g=p.counterValues||[],m=e.data.rawDates||[],y="hourly"===a,v=e.zaehlerid||null,w=window.decodeChannel(window.getChannelById(v)),b=w.beschreibung,x=0,D=new Set,E={},!y&&m&&m.length>0&&(x=m.length,m.forEach((function(t,e){var r=t.split("-"),n="".concat(r[0],"-").concat(r[1]);D.add(n),E[n]||(E[n]=[]),E[n].push({date:t,label:d[e],consumption:f[e]||0,counter:g[e]||0})}))),L=new s({orientation:k=x>14?"landscape":"portrait",compress:1}),C=document.getElementById("sitename").innerHTML,L.setProperties({title:b,subject:window.getTranslatedText("chartExport","hourly"===a?"hourlyConsumptionData":"dailyConsumptionData"),author:C,creator:"CTOOLS.io",compress:1}),j=L.internal.pageSize.getWidth(),P=L.internal.pageSize.getHeight(),_=15,!(D.size>1&&x>31)){S.next=81;break}lt(0,O=Object.keys(E).length),N=0,F=Object.entries(E);case 52:if(!(N<F.length)){S.next=79;break}if(M=T(F[N],2),H=M[0],V=M[1],lt(++I,O),!z){S.next=59;break}return console.log("PDF export aborted by user during month processing"),S.abrupt("break",79);case 59:return H!==Object.keys(E)[0]&&(L.addPage(k),_=15),W=new Date(H+"-01"),U=W.toLocaleDateString(window.getCurrentLanguage(),{month:"long",year:"numeric"}),L.setFontSize(16),L.text("".concat(b," - ").concat(U),j/2,_,{align:"center"}),_+=10,S.next=67,G(L,V,_,j,k,o);case 67:if(_=S.sent,"function"==typeof L.autoTable?(Y=V.map((function(t){return{label:t.label,consumption:window.formatNumber(t.consumption||0,"",window.getCurrentLanguage(),2),counter:window.formatNumber(t.counter||0,"",window.getCurrentLanguage(),2)}})),K=[{header:window.getTranslatedText("chartExport","date"),dataKey:"label"},{header:"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(o,")"),dataKey:"consumption"},{header:"".concat(window.getTranslatedText("chartExport","counter")," (").concat(o,")"),dataKey:"counter"}],L.autoTable({startY:_,columns:K,body:Y,margin:{left:20,right:20},theme:"grid",headStyles:{fillColor:[0,118,168],textColor:255},alternateRowStyles:{fillColor:[245,245,245]}})):L.text("Data table could not be generated - autoTable plugin not available",20,_),y||!i){S.next=76;break}if(q=V.map((function(t){return t.date})),!z){S.next=74;break}return console.log("PDF export aborted by user during monthly detail pages"),S.abrupt("break",79);case 74:return S.next=76,R(L,q,b,o,v);case 76:N++,S.next=52;break;case 79:S.next=100;break;case 81:if("daily"===a?X=at(d,m):e&&e.chartDate?($=new Date(e.chartDate),X=$.toLocaleDateString(window.getCurrentLanguage())):(console.warn("Chart date not available for hourly export"),X=(new Date).toLocaleDateString(window.getCurrentLanguage())),L.setFontSize(16),L.text(b,j/2,_,{align:"center"}),_+=8,L.setFontSize(12),L.text("".concat("hourly"===a?window.getTranslatedText("charts","hourlyData").replace("{0}",""):window.getTranslatedText("charts","dailyData").replace("{0}","")," ").concat(X),j/2,_,{align:"center"}),_+=10,J=e.canvas,Q=J.toDataURL("image/png",1),tt=J.width/J.height,"portrait"===k?rt=(et=j-40)/tt:(et=j-40,rt=Math.min(et/tt,110)),L.addImage(Q,"PNG",20,_,et,rt,"","FAST"),_+=rt+15,!y&&x>14&&(L.addPage(k),_=15,L.setFontSize(14),L.text("".concat(b," - ").concat(window.getTranslatedText("chartExport","detailsSheet")),j/2,_,{align:"center"}),_+=10),nt=B(d,f,g,y,m),"function"==typeof L.autoTable?(ot=[{header:y?window.getTranslatedText("chartExport","hour"):window.getTranslatedText("chartExport","date"),dataKey:"label"},{header:"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(o,")"),dataKey:"consumption"},{header:"".concat(window.getTranslatedText("chartExport","counter")," (").concat(o,")"),dataKey:"counter"}],L.autoTable({startY:_,columns:ot,body:nt,margin:{left:20,right:20},theme:"grid",headStyles:{fillColor:[0,118,168],textColor:255},alternateRowStyles:{fillColor:[245,245,245]}}),_=L.previousAutoTable.finalY+10):(L.text("Data table could not be generated - autoTable plugin not available",20,_),_+=10,console.warn("autoTable plugin not available, trying to load it"),Z()),y||!i){S.next=100;break}return S.next=100,R(L,m,b,o,v);case 100:for(ct=L.internal.getNumberOfPages(),ut=new Date,st=window.getCurrentLanguage(),dt=1;dt<=ct;dt++)L.setPage(dt),L.setFontSize(8),L.text(C,20,P-10,{align:"left"}),ht=ut.toLocaleDateString(st,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),pt=(pt=window.getTranslatedText("chartPDF","pageNumbers")).replace("{current}",dt).replace("{total}",ct),L.text("CTOOLS.io - ".concat(ht," - ").concat(pt),j-20,P-10,{align:"right"});ft=it(b,window.formatDate(new Date,"date"),"pdf"),L.save(ft),c&&(document.removeEventListener("keydown",u),document.body.removeChild(c)),S.next=114;break;case 109:S.prev=109,S.t0=S.catch(2),z?console.log("PDF export aborted by user"):(console.error("Error exporting to PDF:",S.t0),window.getTranslatedText("chartExport","errorExporting")),(gt=document.querySelector('div[style*="rgba(0,0,0,0.5)"]'))&&(document.removeEventListener("keydown",keyHandler),document.body.removeChild(gt));case 114:case"end":return S.stop()}}),t,null,[[2,109]])}))),M.apply(this,arguments)}function G(t,e,r,n,a){return H.apply(this,arguments)}function H(){return H=F(S().mark((function t(e,r,n,a,o){var i,c=arguments;return S().wrap((function t(o){for(;;)switch(o.prev=o.next){case 0:return i=c.length>5&&void 0!==c[5]?c[5]:"kWh",o.abrupt("return",new Promise((function(t,o){try{var c=r.map((function(t){return t.label})),l=r.map((function(t){return t.consumption})),u=r.map((function(t){return t.counter})),d=document.createElement("canvas");d.width=800,d.height=400,document.body.appendChild(d);var h={labels:c,datasets:[{label:window.getTranslatedText("charts","dailyConsumption"),data:l,backgroundColor:"rgba(75, 192, 192, 0.5)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1,counterValues:u}]},p=s(l),f=window.formatNumber(p.total," kWh",window.getCurrentLanguage(),2),g=window.formatNumber(p.average," kWh",window.getCurrentLanguage(),2),m=window.getTranslatedText("chartStats","total"),y=window.getTranslatedText("charts","day"),v="".concat(f," ").concat(m," - \xd8 ").concat(g," / ").concat(y);p.average>0&&h.datasets.push({type:"line",label:window.getTranslatedText("chartStats","averageLine"),data:Array(l.length).fill(p.average),borderColor:"rgba(255, 99, 132, 1)",borderWidth:1.5,borderDash:[5,5],pointRadius:0,fill:0,tension:0});var w=new Chart(d.getContext("2d"),{type:"bar",data:h,options:{responsive:1,maintainAspectRatio:1,scales:{y:{beginAtZero:1,title:{display:1,text:i},ticks:{callback:function t(e){return window.formatNumber(e,"",window.getCurrentLanguage(),2)}}}},plugins:{legend:{display:1,position:"top"},title:{display:1,position:"bottom",text:v}},animation:{duration:0}}});setTimeout((function(){try{var r=d.toDataURL("image/png"),o,i;i=(o=a-40)*(d.height/d.width),e.addImage(r,"PNG",20,n,o,i),document.body.removeChild(d),t(n+i+10)}catch(c){console.error("Error converting chart to image:",c),e.setFontSize(10),e.text("Error generating monthly chart",20,n+10),document.body.contains(d)&&document.body.removeChild(d),t(n+20)}}),500)}catch(b){console.error("Error creating monthly chart:",b),e.setFontSize(10),e.text("Error generating monthly chart",20,n+10),t(n+20)}})));case 2:case"end":return o.stop()}}),t)}))),H.apply(this,arguments)}function V(t,e,r,n,a,o){if("function"==typeof t.autoTable){var i=e.map((function(t){return{label:t.label,consumption:window.formatNumber(t.consumption||0,"",window.getCurrentLanguage(),2),counter:window.formatNumber(t.counter||0,"",window.getCurrentLanguage(),2)}})),c=[{header:window.getTranslatedText("chartExport","date"),dataKey:"label"},{header:"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(o,")"),dataKey:"consumption"},{header:"".concat(window.getTranslatedText("chartExport","counter")," (").concat(o,")"),dataKey:"counter"}];return t.autoTable({startY:r,columns:c,body:i,margin:{left:20,right:20},theme:"grid",headStyles:{fillColor:[0,118,168],textColor:255},alternateRowStyles:{fillColor:[245,245,245]}}),t.previousAutoTable.finalY+10}return t.text("Data table could not be generated - autoTable plugin not available",20,r),r+20}function W(t,e,r,n){var a=e.total,o=e.average,i=e.median,c=window.getCurrentLanguage();return t.setFontSize(12),t.text(window.getTranslatedText("chartStats","statistics"),20,r),t.setFontSize(10),t.text("".concat(window.getTranslatedText("chartStats","total"),": ").concat(window.formatNumber(a," ".concat(n),c,2)),20,r+7),t.text("".concat(window.getTranslatedText("chartStats","average"),": ").concat(window.formatNumber(o," ".concat(n),c,2)),20,r+14),r+18}function B(t,e,r,n,a){var o=window.getCurrentLanguage(),i=[];return n?t.forEach((function(t,n){n<e.length&&i.push({label:t,consumption:window.formatNumber(e[n]||0,"",o,2),counter:window.formatNumber(r[n]||0,"",o,2)})})):t.forEach((function(t,n){if(n<e.length){var c=ot(t,a?a[n]:null);i.push({label:c,consumption:window.formatNumber(e[n]||0,"",o,2),counter:window.formatNumber(r[n]||0,"",o,2)})}})),i}function R(t,e,r,n){return U.apply(this,arguments)}function U(){return U=F(S().mark((function t(e,r,n,a){var o,i,c,l,u,s,d,h,p,f,g,y=arguments;return S().wrap((function t(v){for(;;)switch(v.prev=v.next){case 0:if(o=y.length>4&&void 0!==y[4]?y[4]:null){v.next=3;break}return v.abrupt("return");case 3:return i=document.getElementById("pdf-export-progress-container"),c=document.getElementById("pdf-export-progress-bar"),l=document.getElementById("pdf-export-current"),u=document.getElementById("pdf-export-total"),i&&c&&l&&u&&(i.style.display="block",u.textContent=r.length,l.textContent="0",c.style.width="0%",c.setAttribute("aria-valuenow","0")),s={},v.prev=9,v.next=12,J(r,n,o);case 12:s=v.sent,v.next=18;break;case 15:v.prev=15,v.t0=v.catch(9),console.warn("Error pre-fetching hourly data for days:",v.t0);case 18:d=0,h=P(r),v.prev=20,f=S().mark((function t(){var o,i,c,l,u,h,f,g,y,v;return S().wrap((function t(w){for(;;)switch(w.prev=w.next){case 0:if(o=p.value,!z){w.next=4;break}return console.log("PDF export aborted by user"),w.abrupt("return",0);case 4:if(i=s[o]){w.next=10;break}return console.warn("No hourly data available for ".concat(o)),ct(++d,r.length),w.abrupt("return",1);case 10:return w.prev=10,e.addPage("portrait"),c=new Date(o).toLocaleDateString(window.getCurrentLanguage()),e.setFontSize(14),e.text("".concat(n," - ").concat(c),e.internal.pageSize.getWidth()/2,15,{align:"center"}),l=m(i),u=l.consumption,h=l.counterValues,f=["00 - 01","01 - 02","02 - 03","03 - 04","04 - 05","05 - 06","06 - 07","07 - 08","08 - 09","09 - 10","10 - 11","11 - 12","12 - 13","13 - 14","14 - 15","15 - 16","16 - 17","17 - 18","18 - 19","19 - 20","20 - 21","21 - 22","22 - 23","23 - 24"],w.next=19,Y(e,i,25,e.internal.pageSize.getWidth(),a);case 19:g=w.sent,y=f.map((function(t,e){return{label:t,consumption:window.formatNumber(u[e]||"0","",window.getCurrentLanguage(),2),counter:u[e]&&h[e]?window.formatNumber(h[e],"",window.getCurrentLanguage(),2):""}})),v=[{header:window.getTranslatedText("chartExport","hour"),dataKey:"label"},{header:"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(a,")"),dataKey:"consumption"},{header:"".concat(window.getTranslatedText("chartExport","counter")," (").concat(a,")"),dataKey:"counter"}],"function"==typeof e.autoTable?e.autoTable({startY:g+10,columns:v,body:y,margin:{left:20,right:20},theme:"grid",headStyles:{fillColor:[0,118,168],textColor:255},alternateRowStyles:{fillColor:[245,245,245]}}):e.text("Hourly data table could not be generated",20,50),ct(++d,r.length),w.next=33;break;case 27:return w.prev=27,w.t0=w.catch(10),console.warn("Error processing hourly data for ".concat(o,":"),w.t0),ct(++d,r.length),w.abrupt("return",1);case 33:case"end":return w.stop()}}),t,null,[[10,27]])})),h.s();case 23:if((p=h.n()).done){v.next=32;break}return v.delegateYield(f(),"t1",25);case 25:if(0!==(g=v.t1)){v.next=28;break}return v.abrupt("break",32);case 28:if(1!==g){v.next=30;break}return v.abrupt("continue",30);case 30:v.next=23;break;case 32:v.next=37;break;case 34:v.prev=34,v.t2=v.catch(20),h.e(v.t2);case 37:return v.prev=37,h.f(),v.finish(37);case 40:case"end":return v.stop()}}),t,null,[[9,15],[20,34,37,40]])}))),U.apply(this,arguments)}function Y(t,e,r,n){return K.apply(this,arguments)}function K(){return K=F(S().mark((function t(e,r,n,a){var o,i=arguments;return S().wrap((function t(c){for(;;)switch(c.prev=c.next){case 0:return o=i.length>4&&void 0!==i[4]?i[4]:"kWh",c.abrupt("return",new Promise((function(t,i){try{var c=m(r),l=c.consumption,u=c.counterValues,d=["00 - 01","01 - 02","02 - 03","03 - 04","04 - 05","05 - 06","06 - 07","07 - 08","08 - 09","09 - 10","10 - 11","11 - 12","12 - 13","13 - 14","14 - 15","15 - 16","16 - 17","17 - 18","18 - 19","19 - 20","20 - 21","21 - 22","22 - 23","23 - 24"],h=document.createElement("canvas");h.width=800,h.height=400,document.body.appendChild(h);var p={labels:d,datasets:[{label:window.getTranslatedText("charts","hourlyConsumption"),data:l,backgroundColor:"rgba(54, 162, 235, 0.5)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1,counterValues:u}]},f=s(l),g=window.formatNumber(f.total," kWh",window.getCurrentLanguage(),2),y=window.formatNumber(f.average," kWh",window.getCurrentLanguage(),2),v=window.getTranslatedText("chartStats","total"),w=window.getTranslatedText("charts","hour"),b="".concat(g," ").concat(v," - \xd8 ").concat(y," / ").concat(w);f.average>0&&p.datasets.push({type:"line",label:window.getTranslatedText("chartStats","averageLine"),data:Array(l.length).fill(f.average),borderColor:"rgba(255, 99, 132, 1)",borderWidth:1.5,borderDash:[5,5],pointRadius:0,fill:0,tension:0});var x=new Chart(h.getContext("2d"),{type:"bar",data:p,options:{responsive:1,maintainAspectRatio:1,scales:{y:{beginAtZero:1,title:{display:1,text:o},ticks:{font:{size:44},callback:function t(e){return window.formatNumber(e,"",window.getCurrentLanguage(),2)}}},x:{ticks:{font:{size:44}}}},plugins:{legend:{display:1,position:"top",labels:{font:{size:44}}},title:{display:1,position:"bottom",text:b,font:{size:44}}},animation:{duration:0}}});setTimeout((function(){try{var r=h.toDataURL("image/png"),o=a-40,i=o*(h.height/h.width),c;e.addImage(r,"PNG",20,n,o,i,"","FAST"),document.body.removeChild(h),t(n+i+10+25)}catch(l){console.error("Error converting chart to image:",l),e.setFontSize(10),e.text("Error generating hourly chart",20,n+10),document.body.contains(h)&&document.body.removeChild(h),t(n+20)}}),500)}catch(D){console.error("Error creating hourly chart:",D),e.setFontSize(10),e.text("Error generating hourly chart",20,n+10),t(n+20)}})));case 2:case"end":return c.stop()}}),t)}))),K.apply(this,arguments)}function q(t,e,r,n){var a=calculateHourlyConsumption(e),o=a.consumption,i=a.counterValues,c,l=getHourLabels().map((function(t,e){return{label:t,consumption:window.formatNumber(o[e]||0,"",window.getCurrentLanguage(),2),counter:window.formatNumber(i[e]||0,"",window.getCurrentLanguage(),2)}})),u=[{header:window.getTranslatedText("chartExport","hour"),dataKey:"label"},{header:"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(n,")"),dataKey:"consumption"},{header:"".concat(window.getTranslatedText("chartExport","counter")," (").concat(n,")"),dataKey:"counter"}];"function"==typeof t.autoTable?t.autoTable({startY:r,columns:u,body:l,margin:{left:20,right:20},theme:"grid",headStyles:{fillColor:[0,118,168],textColor:255},alternateRowStyles:{fillColor:[245,245,245]}}):t.text("Hourly data table could not be generated",20,r)}function Z(t){var e=0,r=2,n=function r(){++e>=2&&"function"==typeof t&&t()};if(void 0===window.jspdf&&void 0===window.jsPDF){var a=document.createElement("script");a.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js",a.onload=n,document.head.appendChild(a)}else n();var o=document.createElement("script");o.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js",o.onload=n,document.head.appendChild(o)}function X(t,e,r,n){var a,o,i=t.target.closest("[data-export-action]");if(i){t.preventDefault();var c=i.getAttribute("data-chart-id"),l="true"===i.getAttribute("data-include-daily"),u=i.getAttribute("data-export-action"),s=e[c],d=r[c],h=n[c];if(s){var p=c.includes("hourly")?"hourly":"daily",f="kWh";switch(u){case"excel":d&&$(d,h,p,f,l,s);break;case"excel-daily":d&&$(d,h,p,f,1,s);break;case"pdf":var g;A(s,(null===(a=s.options.plugins.title)||void 0===a?void 0:a.text)||"Chart",h,p,f,l);break;case"pdf-daily":var m;A(s,(null===(o=s.options.plugins.title)||void 0===o?void 0:o.text)||"Chart",h,p,f,1);break}}}}function $(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"kWh",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;try{var i=t.labels||[],c=t.datasets||[],l=c.length>0?c[0]:{data:[]},u=l.data||[],s=l.counterValues||[],d=window.getCurrentLanguage(),h=window.decodeChannel(window.getChannelById(o.zaehlerid)),p=h&&h.beschreibung||"",f;if("daily"===r)f=at(i,t.rawDates);else if(o&&o.chartDate){var g=new Date(o.chartDate);f=g.toLocaleDateString(window.getCurrentLanguage())}else console.warn("Chart date not available for hourly export"),f=(new Date).toLocaleDateString(window.getCurrentLanguage());var m=XLSX.utils.book_new(),y=[];if(y.push(["".concat(p," - ").concat("hourly"===r?window.getTranslatedText("charts","hourlyData").replace("{0}",""):window.getTranslatedText("charts","dailyData").replace("{0}",""))]),y.push(["".concat(f)]),y.push([]),"hourly"===r)y.push([window.getTranslatedText("chartExport","hour"),"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(n,")"),"".concat(window.getTranslatedText("chartExport","counter")," (").concat(n,")")]),i.forEach((function(t,e){e<u.length&&y.push([t,window.formatNumber(u[e]||0,"",window.getCurrentLanguage(),3),window.formatNumber(s[e]||0,"",window.getCurrentLanguage(),3)])}));else{y.push([window.getTranslatedText("chartExport","date"),"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(n,")"),"".concat(window.getTranslatedText("chartExport","counter")," (").concat(n,")")]);var v=t.rawDates||[];i.forEach((function(t,e){if(e<u.length){var r=v[e]||null,n,a;n=r?new Date(r).toLocaleDateString(d,{year:"numeric",month:"2-digit",day:"2-digit"}):ot(t,null),y.push([n,window.formatNumber(u[e]||0,"",d,3),window.formatNumber(s[e]||0,"",d,3)])}}))}y.push([]),y.push([window.getTranslatedText("chartStats","statistics")]),y.push(["".concat(window.getTranslatedText("chartStats","total")," (").concat(n,")"),window.formatNumber(e.total||0,"",d,3)]),y.push(["".concat(window.getTranslatedText("chartStats","average")," (").concat(n,")"),window.formatNumber(e.average||0,"",d,3)]);var w=XLSX.utils.aoa_to_sheet(y),b=[{wch:18},{wch:18},{wch:18}];if(w["!cols"]=b,XLSX.utils.book_append_sheet(m,w,window.getTranslatedText("chartExport","overviewSheet")),"daily"===r&&t.rawDates&&t.rawDates.length>0&&a)return console.log("Exporting hourly details for ".concat(t.rawDates.length," days")),void J(t.rawDates,p,o.zaehlerid).then((function(t){console.log("Received hourly data for ".concat(Object.keys(t).length," days")),tt(m,t,p,n);var e=it(p,f,"xlsx");XLSX.writeFile(m,e)})).catch((function(t){console.error("Error fetching hourly data:",t),"".concat(window.getTranslatedText("chartExport","errorExporting")," (details): ").concat(t.message);var e=it(p,f,"xlsx");XLSX.writeFile(m,e)}));var x=new Date,D=it(p,f,"xlsx");XLSX.writeFile(m,D)}catch(E){console.error("Error exporting to Excel:",E),window.getTranslatedText("chartExport","errorExporting")}}function J(t,e){return Q.apply(this,arguments)}function Q(){return Q=F(S().mark((function t(e,r){var a,o,i,c,l,u,s,d,h,p,f,g=arguments;return S().wrap((function t(r){for(;;)switch(r.prev=r.next){case 0:if(a=g.length>2&&void 0!==g[2]?g[2]:null){r.next=3;break}throw new Error("Could not determine channel ID from name");case 3:if(o={},e&&0!==e.length){r.next=6;break}return r.abrupt("return",o);case 6:return r.prev=6,i=x(e).sort(),c=i[0],l=i[i.length-1],console.log("Fetching hourly data for date range ".concat(c," to ").concat(l," for channel ").concat(a)),r.next=13,(0,n.wi)(c,l,a);case 13:u=r.sent,console.log("Retrieved ".concat(u.length," hourly data records")),u.length>0&&console.log("Sample data structure:",u[0]),s=P(u);try{for(s.s();!(d=s.n()).done;)(h=d.value).datum&&e.includes(h.datum)&&(o[h.datum]=h)}catch(m){s.e(m)}finally{s.f()}if(p=Object.keys(o),console.log("Found hourly data for ".concat(p.length," of ").concat(e.length," requested dates")),!((f=e.filter((function(t){return!o[t]}))).length>0)){r.next=25;break}return console.log("Fetching ".concat(f.length," missing dates individually"),f),r.next=25,Promise.all(f.map(function(){var t=F(S().mark((function t(e){var r;return S().wrap((function t(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,(0,n.tZ)(a,e);case 3:(r=i.sent)?(o[e]=r,console.log("Successfully retrieved data for ".concat(e))):console.log("No data found for ".concat(e)),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),console.warn("Could not fetch individual hourly data for ".concat(e,":"),i.t0);case 10:case"end":return i.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()));case 25:r.next=32;break;case 27:return r.prev=27,r.t0=r.catch(6),console.error("Error in batch fetching hourly data:",r.t0),r.next=32,Promise.all(e.map(function(){var t=F(S().mark((function t(e){var r;return S().wrap((function t(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,(0,n.tZ)(a,e);case 3:(r=i.sent)&&(o[e]=r),i.next=10;break;case 7:i.prev=7,i.t0=i.catch(0),console.warn("Could not fetch hourly data for ".concat(e,":"),i.t0);case 10:case"end":return i.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()));case 32:return console.log("Total dates with hourly data: ".concat(Object.keys(o).length)),r.abrupt("return",o);case 34:case"end":return r.stop()}}),t,null,[[6,27]])}))),Q.apply(this,arguments)}function tt(t,e,r,n){if(0!==Object.keys(e).length){console.log("Creating hourly details worksheet with data for ".concat(Object.keys(e).length," dates"));var a=[];a.push(["".concat(r," - ").concat(window.getTranslatedText("chartExport","detailsSheet"))]),a.push([]);var o=Object.keys(e).sort();console.log("Processing data for dates: ".concat(o.join(", ")));var i=[window.getTranslatedText("chartExport","hour")],c;o.forEach((function(t){var e=ot("",t);i.push(e)})),a.push(i),["00 - 01","01 - 02","02 - 03","03 - 04","04 - 05","05 - 06","06 - 07","07 - 08","08 - 09","09 - 10","10 - 11","11 - 12","12 - 13","13 - 14","14 - 15","15 - 16","16 - 17","17 - 18","18 - 19","19 - 20","20 - 21","21 - 22","22 - 23","23 - 24"].forEach((function(t,r){var n=[t];if(o.length>0&&0===r){var i=o[0],c=e[i];console.log("Sample data for ".concat(i,":"),c)}o.forEach((function(t){var a=e[t],o=null;if(a)try{var i;if(1)(i=m(a))&&i.consumption&&void 0!==i.consumption[r]&&(o=i.consumption[r]);else{var c="val_".concat(r+1),l=0===r?"val_start":"val_".concat(r);void 0!==a[c]&&void 0!==a[l]&&(o=a[c]-a[l])<0&&(o=0)}}catch(s){console.error("Error calculating consumption for ".concat(t,", hour ").concat(r,":"),s)}if(null!=o){var u="function"==typeof window.formatNumber?window.formatNumber(o,"",window.getCurrentLanguage(),2):o.toFixed(2);n.push(u)}else n.push("")})),a.push(n)}));for(var l=XLSX.utils.aoa_to_sheet(a),u=[{wch:15}],s=0;s<o.length;s++)u.push({wch:15});l["!cols"]=u,XLSX.utils.book_append_sheet(t,l,window.getTranslatedText("chartExport","detailsSheet")),console.log("Hourly details worksheet created successfully")}else console.warn("No hourly data available for details worksheet")}function et(t){var e=t.match(/\((\d+)\)$/),r;if(e&&e[1])return e[1];if(window.$channels&&Array.isArray(window.$channels)){var n=P(window.$channels),a;try{for(n.s();!(a=n.n()).done;){var o=a.value;if(o[2]===t)return o[0]}}catch(i){n.e(i)}finally{n.f()}}return rt(t)||(console.warn("Could not extract channel ID from name:",t),"1")}function rt(t){if(window.$channels&&Array.isArray(window.$channels)){var e=P(window.$channels),r;try{for(e.s();!(r=e.n()).done;){var n=r.value;if(n[2]===t)return n[0].toString()}}catch(a){e.e(a)}finally{e.f()}}return null}function nt(t){if(!t)return"";var e=t.match(/:\s*(.+)$/);if(e&&e[1])return e[1].trim();var r=t.match(/\s+-\s+(.+)$/);if(r&&r[1])return r[1].trim();var n=t.replace(/\{0\}/g,"").trim();if("Chart"===n)return"Channel Data";for(var a,o=0,i=["Daily Consumption","Hourly Data","Hourly Consumption","Tagesdaten","Tagesverbrauch","Stundendaten","Stundenverbrauch","Consommation Journali\xe8re","Donn\xe9es Horaires","Dagelijks Verbruik","Uurlijkse Gegevens"];o<i.length;o++){var c=i[o];if(n.startsWith(c)&&(n=(n=n.substring(c.length).trim()).replace(/^[-:]\s*/,"")))return n}return t}function at(t){if(!t||0===t.length)return window.formatDate(new Date,"date");if(1===t.length)return ot(t[0]);var e=ot(t[0]),r=ot(t[t.length-1]);return"".concat(e," - ").concat(r)}function ot(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e&&e.match(/^\d{4}-\d{2}-\d{2}$/)){var r=e.split("-"),n=r[0],a=r[1],o=r[2],i=window.getCurrentLanguage(),c;return new Date(n,a-1,o).toLocaleDateString(i)}var l=t.match(/(\d{1,2})\.(\d{1,2})\.?/);if(l&&l.length>=3){var u=parseInt(l[1],10),s=parseInt(l[2],10)-1,d=(new Date).getFullYear(),h=window.getCurrentLanguage(),p;return new Date(d,s,u).toLocaleDateString(h)}return t}function it(t,e,r){t||(t="channel_data"),e||(e=window.formatDate(new Date,"date")),r||(r="txt");var n=[t,e].map((function(t){return t.replace(/[\\/:*?"<>|]+/g,"_").replace(/\s+/g,"_")})).join("_"),a=r.replace(/^\./,"");return"".concat(n,".").concat(a)}function ct(t,e){var r=document.getElementById("pdf-export-progress-container"),n=document.getElementById("pdf-export-progress-bar"),a=document.getElementById("pdf-export-current"),o=document.getElementById("pdf-export-total"),i=document.getElementById("pdf-export-progress-text"),c=document.getElementById("pdf-export-progress-type");if(r&&n&&a&&o){if(r.style.display="block",c&&(c.textContent=window.getTranslatedText("chartExport","processingDay")||"Processing day"),i){var l=window.getTranslatedText("chartExport","processingDay")||"Processing day: {current} / {total}";i.innerHTML=l.replace("{current}",'<span id="pdf-export-current">'.concat(t,"</span>")).replace("{total}",'<span id="pdf-export-total">'.concat(e,"</span>"))}else a.textContent=t,o.textContent=e;var u=Math.round(t/e*100);n.style.width="".concat(u,"%"),n.setAttribute("aria-valuenow",u)}}function lt(t,e){var r=document.getElementById("pdf-export-month-progress-container"),n=document.getElementById("pdf-export-month-progress-bar"),a=document.getElementById("pdf-export-month-current"),o=document.getElementById("pdf-export-month-total"),i=document.getElementById("pdf-export-month-progress-text");if(r&&n&&a&&o){if(r.style.display="block",i){var c=window.getTranslatedText("chartExport","processingMonth")||"Processing month: {current} / {total}";i.innerHTML=c.replace("{current}",'<span id="pdf-export-month-current">'.concat(t,"</span>")).replace("{total}",'<span id="pdf-export-month-total">'.concat(e,"</span>"))}else a.textContent=t,o.textContent=e;var l=Math.round(t/e*100);n.style.width="".concat(l,"%"),n.setAttribute("aria-valuenow",l)}}var ut=r(121);function st(){st=function t(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:1,configurable:1,writable:1}),t[e]}try{u({},"")}catch(t){u=function t(e,r,n){return e[r]=n}}function s(t,e,r,n){var o=e&&e.prototype instanceof y?e:y,i=Object.create(o.prototype),c=new P(n||[]);return a(i,"_invoke",{value:T(t,r,c)}),i}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function y(){}function v(){}function w(){}var b={};u(b,i,(function(){return this}));var x=Object.getPrototypeOf,D=x&&x(x(_([])));D&&D!==r&&n.call(D,i)&&(b=D);var E=w.prototype=y.prototype=Object.create(b);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(a,o,i,c){var l=d(t[a],t,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==Dt(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function t(n,a){function i(){return new e((function(t,e){r(n,a,t,e)}))}return o=o?o.then(i,i):i()}})}function T(e,r,n){var a=h;return function(o,i){if(a===f)throw Error("Generator is already running");if(a===g){if("throw"===o)throw i;return{value:t,done:1}}for(n.method=o,n.arg=i;;){var c=n.delegate;if(c){var l=L(c,n);if(l){if(l===m)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===h)throw a=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=f;var u=d(e,r,n);if("normal"===u.type){if(a=n.done?g:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=g,n.method="throw",n.arg=u.arg)}}}function L(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=d(a,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(1)}function _(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=0,r;return r.value=t,r.done=1,r};return o.next=o}}throw new TypeError(Dt(e)+" is not iterable")}return v.prototype=w,a(E,"constructor",{value:w,configurable:1}),a(w,"constructor",{value:v,configurable:1}),v.displayName=u(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,u(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new S(s(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},k(E),u(E,l,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=0,t}return t.done=1,t}},e.values=_,P.prototype={constructor:P,reset:function e(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=0,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!r)for(var a in this)"t"===a.charAt(0)&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function t(){this.done=1;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function e(r){if(this.done)throw r;var a=this;function o(e,n){return l.type="throw",l.arg=r,a.next=e,n&&(a.method="next",a.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],l=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var u=n.call(c,"catchLoc"),s=n.call(c,"finallyLoc");if(u&&s){if(this.prev<c.catchLoc)return o(c.catchLoc,1);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(u){if(this.prev<c.catchLoc)return o(c.catchLoc,1)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function t(e,r){for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=e,c.arg=r,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(c)},complete:function t(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),m},finish:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),j(n),m}},catch:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var o=a.arg;j(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function e(r,n,a){return this.delegate={iterator:_(r),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),m}},e}function dt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function ht(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?dt(Object(r),1).forEach((function(e){pt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):dt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function pt(t,e,r){return(e=ft(e))in t?Object.defineProperty(t,e,{value:r,enumerable:1,configurable:1,writable:1}):t[e]=r,t}function ft(t){var e=gt(t,"string");return"symbol"==Dt(e)?e:e+""}function gt(t,e){if("object"!=Dt(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=Dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function mt(t){return bt(t)||wt(t)||vt(t)||yt()}function yt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function vt(t,e){if(t){if("string"==typeof t)return xt(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?xt(t,e):void 0}}function wt(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function bt(t){if(Array.isArray(t))return xt(t)}function xt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Dt(t){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dt(t)}function Et(t,e,r,n,a,o,i){try{var c=t[o](i),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,a)}function kt(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(t){Et(o,n,a,i,c,"next",t)}function c(t){Et(o,n,a,i,c,"throw",t)}i(void 0)}))}}var St={},Tt={},Lt={};function Ct(t,e,r){return jt.apply(this,arguments)}function jt(){return(jt=kt(st().mark((function t(e,a,o){var i,c,l,u,d,g,y,v,b,x,D,E,k,S,T,L,C,j,P,_,O;return st().wrap((function t(N){for(;;)switch(N.prev=N.next){case 0:if(N.prev=0,"undefined"!=typeof Chart){N.next=11;break}return N.next=4,Promise.resolve().then(r.bind(r,121));case 4:return i=N.sent,c=i.loadChartJs,N.next=8,c();case 8:if(l=N.sent){N.next=11;break}throw new Error("Failed to load Chart.js");case 11:if(u=document.getElementById(e)){N.next=15;break}return console.error("Container element ".concat(e," not found")),N.abrupt("return",null);case 15:if(null!=a){N.next=17;break}throw new Error("zaehlerid must be provided");case 17:if(d=Number(a),!isNaN(d)){N.next=21;break}throw console.error('Invalid zaehlerid provided: "'.concat(a,'" (').concat(Dt(a),")")),new Error("Invalid zaehlerid: ".concat(a));case 21:return console.log("Creating hourly chart for zaehlerid: ".concat(d,", date: ").concat(o)),N.next=24,(0,n.tZ)(a,o);case 24:if(g=N.sent){N.next=29;break}return console.log("No hourly data found for counter ".concat(a," on ").concat(o)),f(u),N.abrupt("return",null);case 29:return y=["00 - 01","01 - 02","02 - 03","03 - 04","04 - 05","05 - 06","06 - 07","07 - 08","08 - 09","09 - 10","10 - 11","11 - 12","12 - 13","13 - 14","14 - 15","15 - 16","16 - 17","17 - 18","18 - 19","19 - 20","20 - 21","21 - 22","22 - 23","23 - 24"],v=m(g),b=v.consumption,x=v.counterValues,D=s(b),E=window.formatNumber(D.total," kWh",window.getCurrentLanguage(),2),k=window.formatNumber(D.average," kWh",window.getCurrentLanguage(),2),S=window.getTranslatedText("chartStats","total"),T=window.getTranslatedText("charts","hour"),L="".concat(E," ").concat(S," - \xd8 ").concat(k," / ").concat(T),u.innerHTML='\n            <canvas id="'.concat(e,'-canvas"></canvas>\n        '),C=document.getElementById("".concat(e,"-canvas")),j={labels:y,datasets:[w("hourly",b,x)]},D.average>0&&(P=h(D,b.length),j.datasets.push(P.averageLine)),Tt[e]=j,Lt[e]=D,_=C.getContext("2d"),O=new Chart(_,{type:"bar",data:j,options:ht(ht({},p()),{},{responsive:1,plugins:ht(ht({},p().plugins),{},{title:{display:1,position:"bottom",text:L}}),layout:{padding:{top:10,right:25,bottom:10,left:10}},animation:{duration:0},resizeDelay:0})}),St[e]=O,O.zaehlerid=a,N.abrupt("return",O);case 50:return N.prev=50,N.t0=N.catch(0),console.error("Error creating hourly chart:",N.t0),N.abrupt("return",null);case 54:case"end":return N.stop()}}),t,null,[[0,50]])})))).apply(this,arguments)}function Pt(t,e,r,n){return _t.apply(this,arguments)}function _t(){return _t=kt(st().mark((function t(e,a,o,i){var c,l,u,d,g,m,y,b,x,D,E,k,S,T,L,C,j,P,_,O,N,F,z,I,A,M,G,H,V,W,B=arguments;return st().wrap((function t(R){for(;;)switch(R.prev=R.next){case 0:if(c=B.length>4&&void 0!==B[4]?B[4]:[],l=B.length>5&&void 0!==B[5]?B[5]:0,u=B.length>6&&void 0!==B[6]?B[6]:"",R.prev=3,"undefined"!=typeof Chart){R.next=14;break}return R.next=7,Promise.resolve().then(r.bind(r,121));case 7:return d=R.sent,g=d.loadChartJs,R.next=11,g();case 11:if(m=R.sent){R.next=14;break}throw new Error("Failed to load Chart.js");case 14:return R.next=16,(0,n.wi)(o,i,a);case 16:if(y=R.sent,b=document.getElementById(e)){R.next=20;break}return R.abrupt("return",null);case 20:if(0!==y.length){R.next=24;break}return console.log("No data found for counter ".concat(a," between ").concat(o," and ").concat(i)),f(b),R.abrupt("return",null);case 24:for(x={},D={},y.forEach((function(t){x[t.datum]=t.usage_day||0,D[t.datum]=t.val_end||0})),E=new Date(o),(k=new Date(i)).setHours(23,59,59);E<=k;)S=E.toISOString().split("T")[0],x[S]||(x[S]=0),D[S]||((T=new Date(E)).setDate(T.getDate()-1),L=T.toISOString().split("T")[0],D[S]=D[L]||0),E.setDate(E.getDate()+1);if(C=Object.keys(x).sort(),j=C.map((function(t){return x[t]})),P=C.map((function(t){return D[t]})),_=v(C),O=s(j),N=window.formatNumber(O.total," kWh",window.getCurrentLanguage(),2),F=window.formatNumber(O.average," kWh",window.getCurrentLanguage(),2),z=window.getTranslatedText("chartStats","total"),I=window.getTranslatedText("charts","day"),A="".concat(N," ").concat(z," - \xd8 ").concat(F," / ").concat(I),b.innerHTML='\n            <canvas id="'.concat(e,'-canvas"></canvas>\n        '),M=document.getElementById("".concat(e,"-canvas"))){R.next=45;break}return R.abrupt("return",null);case 45:return G={labels:_,datasets:[w("daily",j,P)],rawDates:C},O.average>0&&(H=h(O,j.length),G.datasets.push(H.averageLine)),G.rawDates=C,Tt[e]=G,Lt[e]=O,V=M.getContext("2d"),(W=new Chart(V,{type:"bar",data:G,options:ht(ht({},p()),{},{responsive:1,plugins:ht(ht({},p().plugins),{},{title:{display:1,position:"bottom",text:A}}),onClick:l?function(t,e){if("click"===t.type&&e&&1===e.length){var r=e[0].index,n=C[r];c.includes(n)&&Wt(a,u,n,c)}}:void 0,layout:{padding:{top:10,right:25,bottom:10,left:10}},animation:{duration:0},resizeDelay:0})})).zaehlerid=a,St[e]=W,W.zaehlerid=a,R.abrupt("return",W);case 58:return R.prev=58,R.t0=R.catch(3),console.error("Error creating daily consumption chart:",R.t0),R.abrupt("return",null);case 62:case"end":return R.stop()}}),t,null,[[3,58]])}))),_t.apply(this,arguments)}function Ot(t,e,r,n){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(console.log("call to showHourly"),null!=t){var o=Number(t);if(isNaN(o))console.error('Invalid zaehlerid provided: "'.concat(t,'" (').concat(Dt(t),")"));else{if(console.log("Showing hourly data dialog for zaehlerid: ".concat(o)),!r){var i=new Date;r="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(String(i.getDate()).padStart(2,"0"))}var c=null;if(a&&(c=document.getElementById(a))){var l=bootstrap.Modal.getInstance(c);l&&l.hide()}var u="hourly-data-modal-".concat(t),s="hourly-data-chart-".concat(t),d=document.getElementById(u);d&&d.remove();var h=new Date(r).toLocaleDateString(window.getCurrentLanguage()),p=g({modalId:u,chartId:s,title:window.getTranslatedText("charts","hourlyData").replace("{0}","".concat(e," (").concat(h,")")),isHourly:1,hasParent:!!a}),f;if(document.body.insertAdjacentHTML("beforeend",p),d=document.getElementById(u),Ct(s,t,r),a&&c){var m=document.getElementById("back-to-daily-btn");m&&m.addEventListener("click",(function(){var t=d.querySelector(".btn-close");t&&t.click()}))}new bootstrap.Modal(d).show(),d.addEventListener("hidden.bs.modal",(function(){if(a){var t=document.getElementById(a),e;t&&new bootstrap.Modal(t).show()}}))}}else console.error("zaehlerid must be provided")}function Nt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;console.log("call to showdaily "+(new Date).toISOString()+" "+t+" description: "+e);var i=new Date;if(n||(n="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(String(i.getDate()).padStart(2,"0"))),!r){var c=new Date(i);c.setDate(i.getDate()-6),r="".concat(c.getFullYear(),"-").concat(String(c.getMonth()+1).padStart(2,"0"),"-").concat(String(c.getDate()).padStart(2,"0"))}var l="daily-consumption-modal-".concat(t),u="daily-consumption-chart-".concat(t),s=document.getElementById(l);s&&s.remove();var d=g({modalId:l,chartId:u,title:window.getTranslatedText("charts","dailyData").replace("{0}",e),isHourly:0,hasParent:0,startDate:r,endDate:n,showClickInstructions:o});document.body.insertAdjacentHTML("beforeend",d),s=document.getElementById(l),Pt(u,t,r,n,a,o,e);var h=window.safeParseDate(r),p=window.safeParseDate(n),f=mt(a).sort(),m=f.length>0?f[0]:null,y=(0,ut.initDatePicker)("".concat(l,"-start-datepicker"),h,a,m,null),v=(0,ut.initDatePicker)("".concat(l,"-end-datepicker"),p,a,m,null),w;[document.getElementById("".concat(l,"-start-datepicker")),document.getElementById("".concat(l,"-end-datepicker"))].forEach((function(t){var e;if(t)if(t.classList.add("force-visible"),t.querySelector(".tempus-dominus-widget"))console.warn("Found tempus dominus widget in container: ".concat(t.id));else{console.warn("No tempus dominus widget in container: ".concat(t.id));var r=t.id.includes("start")?h:p,n=(0,ut.initDatePicker)(t.id,r,a,m,null);console.warn("Re-initialization attempt result: ".concat(n?"success":"failed"))}}));var b=new Set(a);(0,ut.highlightAvailableDates)("".concat(l,"-start-datepicker"),b),(0,ut.highlightAvailableDates)("".concat(l,"-end-datepicker"),b);var x=null,D=null,E=function r(){var n=document.getElementById("".concat(l,"-start-date")).value,i=document.getElementById("".concat(l,"-end-date")).value;n&&i?n!==x||i!==D?(x=n,D=i,Pt(u,t,n,i,a,o,e)):console.log("Dates have not changed, skipping chart update"):console.warn("Start or end date is missing")},k;y.subscribe(tempusDominus.Namespace.events.update,(function(t){(0,ut.highlightAvailableDates)("".concat(l,"-start-datepicker"),b)})),y.subscribe(tempusDominus.Namespace.events.change,(function(t){try{var e=(0,ut.formatDateFromPicker)(t),r;e&&(document.getElementById("".concat(l,"-start-date")).value=e,e>document.getElementById("".concat(l,"-end-date")).value&&(document.getElementById("".concat(l,"-end-date")).value=e,t.date&&v.dates.setValue(t.date)),E())}catch(n){console.error("Error in start date change handler:",n)}})),v.subscribe(tempusDominus.Namespace.events.update,(function(t){(0,ut.highlightAvailableDates)("".concat(l,"-end-datepicker"),b)})),v.subscribe(tempusDominus.Namespace.events.change,(function(t){try{var e=(0,ut.formatDateFromPicker)(t),r;e&&(document.getElementById("".concat(l,"-end-date")).value=e,e<document.getElementById("".concat(l,"-start-date")).value&&(document.getElementById("".concat(l,"-start-date")).value=e,t.date&&y.dates.setValue(t.date)),E())}catch(n){console.error("Error in end date change handler:",n)}})),new bootstrap.Modal(s).show()}function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function zt(){zt=function t(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:1,configurable:1,writable:1}),t[e]}try{u({},"")}catch(t){u=function t(e,r,n){return e[r]=n}}function s(t,e,r,n){var o=e&&e.prototype instanceof y?e:y,i=Object.create(o.prototype),c=new P(n||[]);return a(i,"_invoke",{value:T(t,r,c)}),i}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var h="suspendedStart",p="suspendedYield",f="executing",g="completed",m={};function y(){}function v(){}function w(){}var b={};u(b,i,(function(){return this}));var x=Object.getPrototypeOf,D=x&&x(x(_([])));D&&D!==r&&n.call(D,i)&&(b=D);var E=w.prototype=y.prototype=Object.create(b);function k(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function r(a,o,i,c){var l=d(t[a],t,o);if("throw"!==l.type){var u=l.arg,s=u.value;return s&&"object"==Ft(s)&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,i,c)}),(function(t){r("throw",t,i,c)})):e.resolve(s).then((function(t){u.value=t,i(u)}),(function(t){return r("throw",t,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function t(n,a){function i(){return new e((function(t,e){r(n,a,t,e)}))}return o=o?o.then(i,i):i()}})}function T(e,r,n){var a=h;return function(o,i){if(a===f)throw Error("Generator is already running");if(a===g){if("throw"===o)throw i;return{value:t,done:1}}for(n.method=o,n.arg=i;;){var c=n.delegate;if(c){var l=L(c,n);if(l){if(l===m)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===h)throw a=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=f;var u=d(e,r,n);if("normal"===u.type){if(a=n.done?g:p,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=g,n.method="throw",n.arg=u.arg)}}}function L(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var o=d(a,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(1)}function _(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function r(){for(;++a<e.length;)if(n.call(e,a))return r.value=e[a],r.done=0,r;return r.value=t,r.done=1,r};return o.next=o}}throw new TypeError(Ft(e)+" is not iterable")}return v.prototype=w,a(E,"constructor",{value:w,configurable:1}),a(w,"constructor",{value:v,configurable:1}),v.displayName=u(w,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,u(t,l,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},k(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new S(s(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},k(E),u(E,l,"Generator"),u(E,i,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=0,t}return t.done=1,t}},e.values=_,P.prototype={constructor:P,reset:function e(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=0,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!r)for(var a in this)"t"===a.charAt(0)&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function t(){this.done=1;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function e(r){if(this.done)throw r;var a=this;function o(e,n){return l.type="throw",l.arg=r,a.next=e,n&&(a.method="next",a.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],l=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var u=n.call(c,"catchLoc"),s=n.call(c,"finallyLoc");if(u&&s){if(this.prev<c.catchLoc)return o(c.catchLoc,1);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(u){if(this.prev<c.catchLoc)return o(c.catchLoc,1)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function t(e,r){for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=e,c.arg=r,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(c)},complete:function t(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),m},finish:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),j(n),m}},catch:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var o=a.arg;j(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function e(r,n,a){return this.delegate={iterator:_(r),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),m}},e}function It(t,e,r,n,a,o,i){try{var c=t[o](i),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,a)}function At(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(t){It(o,n,a,i,c,"next",t)}function c(t){It(o,n,a,i,c,"throw",t)}i(void 0)}))}}document.addEventListener("click",(function(t){X(t,St,Tt,Lt)}));var Mt=0;function Gt(){Mt||(Mt=1,document.addEventListener("click",(function(t){var e=t.target.closest('a[data-translation-key="actions.history"]');if(e){t.preventDefault();var r=e.closest('tr[id^="chn"]'),n=e.closest('div[id^="mobile-chn"]'),a=null;if(r?a=r.id.replace("chn",""):n&&(a=n.id.replace("mobile-chn","")),a){var o=window.getChannelById(a),i;o?Ht(a,window.decodeChannel(o).beschreibung):console.error("Channel ".concat(a," not found"))}else console.error("Could not find channel ID for history link")}})))}function Ht(t,e){return Vt.apply(this,arguments)}function Vt(){return(Vt=At(zt().mark((function t(e,a){var o,i,c,l,u,s,d,h,p,f,g,m;return zt().wrap((function t(y){for(;;)switch(y.prev=y.next){case 0:if(o="daily-consumption-modal-".concat(e),!(i=document.getElementById(o))){y.next=7;break}return console.log("Modal for channel ".concat(e," already exists, focusing instead of recreating")),(c=bootstrap.Modal.getInstance(i))?c.show():new bootstrap.Modal(i).show(),y.abrupt("return");case 7:if("undefined"!=typeof Chart){y.next=18;break}return y.next=10,Promise.resolve().then(r.bind(r,121));case 10:return l=y.sent,u=l.loadChartJs,y.next=14,u();case 14:if(s=y.sent){y.next=18;break}return console.error("Failed to load Chart.js, cannot display chart"),y.abrupt("return");case 18:if(d=Number(e),!isNaN(d)){y.next=22;break}return console.error('Invalid channelId: "'.concat(e,'"')),y.abrupt("return");case 22:return h=new Date,p="".concat(h.getFullYear(),"-").concat(String(h.getMonth()+1).padStart(2,"0"),"-").concat(String(h.getDate()).padStart(2,"0")),(f=new Date(h)).setDate(h.getDate()-6),g="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0"),"-").concat(String(f.getDate()).padStart(2,"0")),m=[],y.prev=28,y.next=31,(0,n.kC)(d);case 31:m=y.sent,console.log("Available dates for clickable days:",m),y.next=38;break;case 35:y.prev=35,y.t0=y.catch(28),console.warn("Could not fetch available dates:",y.t0);case 38:Nt(d,a,g,p,m,1);case 39:case"end":return y.stop()}}),t,null,[[28,35]])})))).apply(this,arguments)}function Wt(t,e,r,n){var a;console.log("Day clicked in weekly chart: channelId=".concat(t,", date=").concat(r)),Ot(t,e,r,n,"daily-consumption-modal-".concat(t))}},559:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n={charts:{counterValue:"Counter: {0}",backToDailyView:"Back to Daily Overview",clickDayInstructions:"Click on a day to view hourly data",hourlyConsumption:"Hourly Consumption (kWh)",dailyConsumption:"Daily Consumption (kWh)",hourlyData:"Hourly Data: {0}",dailyData:"Daily Consumption: {0}",date:"Date:",startDate:"Start Date",endDate:"End Date",consumption:"Consumption: {0}",noDataAvailable:"No data available for this date range.",close:"Close",day:"Day",hour:"Hour",history:{title:"History: {0}",hourlyData:"Hourly Consumption (Today)",dailyData:"Daily Consumption (Last 7 Days)"}},chartStats:{title:"Statistics",total:"Total Consumption",average:"Average",median:"Median",statistics:"Statistics",averageLine:"Average",medianLine:"Median"},chartExport:{abortExport:"Abort",processingMonth:"Processing month: {current} / {total}",processingDay:"Processing day: {current} / {total}",aborting:"Aborting...",exportCancelled:"PDF export was cancelled",hourlyConsumptionData:"Hourly Consumption Data",dailyConsumptionData:"Daily Consumption Data",exportDropdown:"Export",exportingPDF:"Generating PDF...",exportPDFWithDaily:"PDF with hourly values",exportExcelWithDaily:"Excel with hourly values",overviewSheet:"Overview",detailsSheet:"Daily Details",exportExcel:"Export Excel",exportPDF:"Export PDF",hour:"Hour",date:"Date",consumption:"Consumption",counter:"Counter",dataSheet:"Consumption Data",errorExporting:"Error exporting data"},chartPDF:{pageNumbers:"Page {current} of {total}"}}},750:(t,e,r)=>{var n={"./charts-lang-de-DE.js":456,"./charts-lang-en-US.js":559,"./charts-lang-es-ES.js":290,"./charts-lang-fr-FR.js":178,"./charts-lang-hr-HR.js":778,"./charts-lang-it-IT.js":240,"./charts-lang-nl-NL.js":846,"./charts-lang-sl-SI.js":359};function a(t){return Promise.resolve().then((()=>{if(!r.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}var a;return r(n[t])}))}a.keys=()=>Object.keys(n),a.id=750,t.exports=a},778:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n={charts:{counterValue:"Brojilo: {0}",backToDailyView:"Natrag na dnevni pregled",clickDayInstructions:"Kliknite na dan za pregled satnih podataka",hourlyConsumption:"Satna Potro\u0161nja (kWh)",dailyConsumption:"Dnevna Potro\u0161nja (kWh)",hourlyData:"Satni Podaci: {0}",dailyData:"Dnevna Potro\u0161nja: {0}",date:"Datum:",startDate:"Po\u010detni Datum",endDate:"Zavr\u0161ni Datum",consumption:"Potro\u0161nja: {0}",noDataAvailable:"Nema dostupnih podataka za ovo razdoblje.",close:"Zatvori",day:"Dan",hour:"Sat",history:{title:"Povijest: {0}",hourlyData:"Satna Potro\u0161nja (Danas)",dailyData:"Dnevna Potro\u0161nja (Zadnjih 7 Dana)"}},chartStats:{title:"Statistika",total:"Ukupna Potro\u0161nja",average:"Prosjek",median:"Medijan",statistics:"Statistika",averageLine:"Prosjek",medianLine:"Medijan"},chartExport:{abortExport:"Odustani",processingMonth:"Obrada mjeseca: {current} / {total}",processingDay:"Obrada dana: {current} / {total}",aborting:"Odustajanje...",exportCancelled:"Izvoz PDF-a je otkazan",hourlyConsumptionData:"Podaci o Satnoj Potro\u0161nji",dailyConsumptionData:"Podaci o Dnevnoj Potro\u0161nji",exportDropdown:"Izvoz",exportingPDF:"Stvaranje PDF-a...",exportPDFWithDaily:"PDF sa satnim vrijednostima",exportExcelWithDaily:"Excel sa satnim vrijednostima",overviewSheet:"Pregled",detailsSheet:"Dnevni Detalji",exportExcel:"Izvoz Excel",exportPDF:"Izvoz PDF",hour:"Sat",date:"Datum",consumption:"Potro\u0161nja",counter:"Brojilo",dataSheet:"Podaci o Potro\u0161nji",errorExporting:"Gre\u0161ka pri izvozu podataka"},chartPDF:{pageNumbers:"Stranica {current} od {total}"}}},846:(t,e,r)=>{r.r(e),r.d(e,{default:()=>n});const n={charts:{counterValue:"Teller: {0}",backToDailyView:"Terug naar dagelijks overzicht",clickDayInstructions:"Klik op een dag om uurgegevens te bekijken",hourlyConsumption:"Uurlijks Verbruik (kWh)",dailyConsumption:"Dagelijks Verbruik (kWh)",hourlyData:"Uurlijkse Gegevens: {0}",dailyData:"Dagelijks Verbruik: {0}",date:"Datum:",startDate:"Startdatum",endDate:"Einddatum",consumption:"Verbruik: {0}",noDataAvailable:"Geen gegevens beschikbaar voor deze periode.",close:"Sluiten",day:"Dag",hour:"Uur",history:{title:"Geschiedenis: {0}",hourlyData:"Uurlijks Verbruik (Vandaag)",dailyData:"Dagelijks Verbruik (Laatste 7 Dagen)"}},chartStats:{title:"Statistieken",total:"Totaal Verbruik",average:"Gemiddelde",median:"Mediaan",statistics:"Statistieken",averageLine:"Gemiddelde",medianLine:"Mediaan"},chartExport:{abortExport:"Afbreken",processingMonth:"Maand verwerken: {current} / {total}",processingDay:"Dag verwerken: {current} / {total}",aborting:"Afbreken...",exportCancelled:"PDF-export is geannuleerd",hourlyConsumptionData:"Uurlijkse Verbruiksgegevens",dailyConsumptionData:"Dagelijkse Verbruiksgegevens",exportDropdown:"Exporteren",exportingPDF:"PDF wordt gegenereerd...",exportPDFWithDaily:"PDF met uurwaarden",exportExcelWithDaily:"Excel met uurwaarden",overviewSheet:"Overzicht",detailsSheet:"Dagelijkse Details",exportExcel:"Exporteren naar Excel",exportPDF:"Exporteren als PDF",hour:"Uur",date:"Datum",consumption:"Verbruik",counter:"Tellerstand",dataSheet:"Verbruiksgegevens",errorExporting:"Fout bij exporteren gegevens"},chartPDF:{pageNumbers:"Pagina {current} van {total}"}}}},e={},r;function n(r){var a=e[r];if(void 0!==a)return a.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:1,get:e[r]})},n.e=()=>Promise.resolve(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:1})},(r=n(405)).keys().forEach(r),(()=>{var t=n(121),e=n(75),r=n(515);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),1).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return(e=l(e))in t?Object.defineProperty(t,e,{value:r,enumerable:1,configurable:1,writable:1}):t[e]=r,t}function l(t){var e=u(t,"string");return"symbol"==a(e)?e:e+""}function u(t,e){if("object"!=a(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function s(){s=function t(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function d(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:1,configurable:1,writable:1}),t[e]}try{d({},"")}catch(t){d=function t(e,r,n){return e[r]=n}}function h(t,e,r,n){var a=e&&e.prototype instanceof w?e:w,i=Object.create(a.prototype),c=new O(n||[]);return o(i,"_invoke",{value:C(t,r,c)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",g="suspendedYield",m="executing",y="completed",v={};function w(){}function b(){}function x(){}var D={};d(D,c,(function(){return this}));var E=Object.getPrototypeOf,k=E&&E(E(N([])));k&&k!==r&&n.call(k,c)&&(D=k);var S=x.prototype=w.prototype=Object.create(D);function T(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,c,l){var u=p(t[o],t,i);if("throw"!==u.type){var s=u.arg,d=s.value;return d&&"object"==a(d)&&n.call(d,"__await")?e.resolve(d.__await).then((function(t){r("next",t,c,l)}),(function(t){r("throw",t,c,l)})):e.resolve(d).then((function(t){s.value=t,c(s)}),(function(t){return r("throw",t,c,l)}))}l(u.arg)}var i;o(this,"_invoke",{value:function t(n,a){function o(){return new e((function(t,e){r(n,a,t,e)}))}return i=i?i.then(o,o):o()}})}function C(e,r,n){var a=f;return function(o,i){if(a===m)throw Error("Generator is already running");if(a===y){if("throw"===o)throw i;return{value:t,done:1}}for(n.method=o,n.arg=i;;){var c=n.delegate;if(c){var l=j(c,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=m;var u=p(e,r,n);if("normal"===u.type){if(a=n.done?y:g,u.arg===v)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=y,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,a=e.iterator[n];if(a===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),v;var o=p(a,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,v;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,v):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(1)}function N(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=0,r;return r.value=t,r.done=1,r};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return b.prototype=x,o(S,"constructor",{value:x,configurable:1}),o(x,"constructor",{value:b,configurable:1}),b.displayName=d(x,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,d(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},T(L.prototype),d(L.prototype,l,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,a,o){void 0===o&&(o=Promise);var i=new L(h(t,r,n,a),o);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},T(S),d(S,u,"Generator"),d(S,c,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=0,t}return t.done=1,t}},e.values=N,O.prototype={constructor:O,reset:function e(r){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=0,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!r)for(var a in this)"t"===a.charAt(0)&&n.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=t)},stop:function t(){this.done=1;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function e(r){if(this.done)throw r;var a=this;function o(e,n){return l.type="throw",l.arg=r,a.next=e,n&&(a.method="next",a.arg=t),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var c=this.tryEntries[i],l=c.completion;if("root"===c.tryLoc)return o("end");if(c.tryLoc<=this.prev){var u=n.call(c,"catchLoc"),s=n.call(c,"finallyLoc");if(u&&s){if(this.prev<c.catchLoc)return o(c.catchLoc,1);if(this.prev<c.finallyLoc)return o(c.finallyLoc)}else if(u){if(this.prev<c.catchLoc)return o(c.catchLoc,1)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<c.finallyLoc)return o(c.finallyLoc)}}}},abrupt:function t(e,r){for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=r&&r<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=e,c.arg=r,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(c)},complete:function t(e,r){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&r&&(this.next=r),v},finish:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),_(n),v}},catch:function t(e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var o=a.arg;_(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function e(r,n,a){return this.delegate={iterator:N(r),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),v}},e}function d(t,e,r,n,a,o,i){try{var c=t[o](i),l=c.value}catch(t){return void r(t)}c.done?e(l):Promise.resolve(l).then(n,a)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,a){var o=t.apply(e,r);function i(t){d(o,n,a,i,c,"next",t)}function c(t){d(o,n,a,i,c,"throw",t)}i(void 0)}))}}console.log("Module body executing, script URL:","file:///home/runner/work/zfa.io_v1/zfa.io_v1/modules/charts/ctools-charts.js"),void 0===window._chartsModuleInitialized&&(window._chartsModuleInitialized=0);var p=new Set,f={initialized:0,initializing:0,error:null};function g(){return m.apply(this,arguments)}function m(){return m=h(s().mark((function t(){return s().wrap((function t(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x();case 3:return window.translations=window.translations||{},window.translations.charts=window.translations.charts||{},window.translations.chartStats=window.translations.chartStats||{},window.translations.chartExport=window.translations.chartExport||{},window.translations.chartPDF=window.translations.chartPDF||{},e.next=10,w(window.getCurrentLanguage());case 10:return document.addEventListener("languageChanged",function(){var t=h(s().mark((function t(e){return s().wrap((function t(r){for(;;)switch(r.prev=r.next){case 0:if(!e.detail||!e.detail.newLanguage){r.next=3;break}return r.next=3,w(e.detail.newLanguage);case 3:case"end":return r.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),k(),console.log("Chart statistics and export features initialized"),e.abrupt("return",1);case 16:return e.prev=16,e.t0=e.catch(0),console.error("Error initializing chart extensions:",e.t0),e.abrupt("return",0);case 20:case"end":return e.stop()}}),t,null,[[0,16]])}))),m.apply(this,arguments)}function y(t){return v.apply(this,arguments)}function v(){return(v=h(s().mark((function t(e){var r,n;return s().wrap((function t(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,fetch(e,{method:"HEAD"});case 3:if((r=a.sent).ok){a.next=6;break}return a.abrupt("return",0);case 6:return n=r.headers.get("content-type"),a.abrupt("return",n&&(n.includes("javascript")||n.includes("application/json")||n.includes("text/plain")));case 10:return a.prev=10,a.t0=a.catch(0),a.abrupt("return",0);case 13:case"end":return a.stop()}}),t,null,[[0,10]])})))).apply(this,arguments)}function w(t){return b.apply(this,arguments)}function b(){return(b=h(s().mark((function t(e){var r;return s().wrap((function t(a){for(;;)switch(a.prev=a.next){case 0:if(e=e||"en-US",!p.has(e)){a.next=3;break}return a.abrupt("return",1);case 3:return a.prev=3,a.next=6,n(750)("./charts-lang-".concat(e,".js"));case 6:if(!(r=a.sent).default){a.next=17;break}return r.default.charts&&(window.translations.charts=i(i({},window.translations.charts),r.default.charts)),r.default.chartStats&&(window.translations.chartStats=i(i({},window.translations.chartStats),r.default.chartStats)),r.default.chartExport&&(window.translations.chartExport=i(i({},window.translations.chartExport),r.default.chartExport)),r.default.chartPDF&&(window.translations.chartPDF=i(i({},window.translations.chartPDF),r.default.chartPDF)),p.add(e),console.log("Chart language ".concat(e," loaded successfully")),a.abrupt("return",1);case 17:throw new Error("Invalid language module format for ".concat(e));case 18:a.next=27;break;case 20:if(a.prev=20,a.t0=a.catch(3),console.error("Failed to load chart language ".concat(e,":"),a.t0),"en-US"===e){a.next=26;break}return console.log("Attempting to load fallback language (en-US)"),a.abrupt("return",w("en-US"));case 26:return a.abrupt("return",0);case 27:case"end":return a.stop()}}),t,null,[[3,20]])})))).apply(this,arguments)}function x(){return D.apply(this,arguments)}function D(){return(D=h(s().mark((function t(){return s().wrap((function t(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Loading chart export libraries directly..."),e.next=4,E("https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js");case 4:return e.next=6,E("https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js");case 6:return e.next=8,E("https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js");case 8:return console.log("Chart export libraries loaded successfully"),e.abrupt("return",1);case 12:return e.prev=12,e.t0=e.catch(0),console.error("Error loading chart export libraries:",e.t0),e.abrupt("return",0);case 16:case"end":return e.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}function E(t){return new Promise((function(e,r){var n=document.createElement("script");n.src=t,n.async=1,n.onload=function(){return e()},n.onerror=function(t){return r(t)},document.head.appendChild(n)}))}function k(){var t=document.createElement("style");t.textContent="\n    /* Chart statistics panel */\n    .chart-stats-panel {\n        display: flex;\n        justify-content: space-around;\n        background-color: #f8f9fa;\n        border-radius: 4px;\n        padding: 8px 16px;\n        margin: 15px 0;\n        border: 1px solid #dee2e6;\n    }\n    \n    .chart-stats-panel .stat-item {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        padding: 5px 10px;\n    }\n    \n    .chart-stats-panel .stat-label {\n        font-size: 0.85rem;\n        color: #6c757d;\n        margin-bottom: 3px;\n    }\n    \n    .chart-stats-panel .stat-value {\n        font-size: 1.1rem;\n        font-weight: 500;\n        color: #0076A8; /* CTOOLS blue */\n    }\n    \n    /* Export buttons container */\n    .chart-export-buttons {\n        display: flex;\n        justify-content: flex-end;\n        gap: 10px;\n        margin-bottom: 15px;\n    }\n    \n    .chart-export-buttons .btn {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        white-space: nowrap;\n    }\n    \n    .chart-export-buttons .btn i {\n        margin-right: 5px;\n    }\n    \n    /* Responsive adjustments */\n    @media (max-width: 768px) {\n        .chart-stats-panel {\n            flex-direction: column;\n            align-items: center;\n            padding: 8px;\n        }\n        \n        .chart-stats-panel .stat-item {\n            margin-bottom: 5px;\n            width: 100%;\n            flex-direction: row;\n            justify-content: space-between;\n        }\n        \n        .chart-stats-panel .stat-label {\n            margin-right: 10px;\n            margin-bottom: 0;\n        }\n        \n        /* Adjust export buttons for mobile */\n        .chart-export-buttons {\n            justify-content: center;\n        }\n        \n        .chart-export-buttons .btn {\n            padding: 4px 8px;\n            font-size: 0.85rem;\n        }\n    }\n    ",document.head.appendChild(t)}function S(t){return T.apply(this,arguments)}function T(){return(T=h(s().mark((function t(e){return s().wrap((function t(r){for(;;)switch(r.prev=r.next){case 0:if(!e.detail||!e.detail.newLanguage){r.next=3;break}return r.next=3,w(e.detail.newLanguage);case 3:case"end":return r.stop()}}),t)})))).apply(this,arguments)}!function(){var n=h(s().mark((function n(){var a;return s().wrap((function n(o){for(;;)switch(o.prev=o.next){case 0:if(!window.__CTOOLSchartsModuleInitialized){o.next=2;break}return o.abrupt("return");case 2:return window.__CTOOLSchartsModuleInitialized=1,f.initializing=1,o.prev=4,o.next=7,(0,r.C)();case 7:return o.next=9,(0,e.Qm)();case 9:return o.next=11,(0,t.initializeChartResources)();case 11:return o.next=13,g();case 13:if(a=o.sent,f.initialized=a,f.initializing=0,!a){o.next=21;break}console.log("Chart module: Self-initialization complete"),document.dispatchEvent(new CustomEvent("moduleReady",{detail:{module:"charts",success:1}})),o.next=22;break;case 21:throw new Error("Chart initialization failed");case 22:o.next=30;break;case 24:o.prev=24,o.t0=o.catch(4),f.error=o.t0,f.initializing=0,console.error("Chart module: Initialization failed",o.t0),document.dispatchEvent(new CustomEvent("moduleReady",{detail:{module:"charts",success:0,error:o.t0.message}}));case 30:case"end":return o.stop()}}),n,null,[[4,24]])})));function a(){return n.apply(this,arguments)}return a}()()})();