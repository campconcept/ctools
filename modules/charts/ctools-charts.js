var t,e={121:(t,e,n)=>{n.r(e),n.d(e,{formatDateFromPicker:()=>b,highlightAvailableDates:()=>x,initDatePicker:()=>w,initializeChartResources:()=>d,initializeDatepicker:()=>m,loadChartJs:()=>h,setupDatepickerLocalization:()=>y});var r=n(690),a=n(618);function o(){o=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",s=c.toStringTag||"@@toStringTag";function d(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var o=e&&e.prototype instanceof w?e:w,i=Object.create(o.prototype),c=new O(r||[]);return a(i,"_invoke",{value:L(t,n,c)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var f="suspendedStart",m="suspendedYield",v="executing",g="completed",y={};function w(){}function b(){}function x(){}var D={};d(D,u,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(I([])));E&&E!==n&&r.call(E,u)&&(D=E);var S=x.prototype=w.prototype=Object.create(D);function C(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(a,o,c,u){var l=h(t[a],t,o);if("throw"!==l.type){var s=l.arg,d=s.value;return d&&"object"==i(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,c,u)}),(function(t){n("throw",t,c,u)})):e.resolve(d).then((function(t){s.value=t,c(s)}),(function(t){return n("throw",t,c,u)}))}u(l.arg)}var o;a(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,a){n(t,r,e,a)}))}return o=o?o.then(a,a):a()}})}function L(e,n,r){var a=f;return function(o,i){if(a===v)throw Error("Generator is already running");if(a===g){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var u=j(c,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===f)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var l=h(e,n,r);if("normal"===l.type){if(a=r.done?g:m,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=g,r.method="throw",r.arg=l.arg)}}}function j(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,j(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function I(e){if(e||""===e){var n=e[u];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(i(e)+" is not iterable")}return b.prototype=x,a(S,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:b,configurable:!0}),b.displayName=d(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,d(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},C(T.prototype),d(T.prototype,l,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new T(p(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},C(S),d(S,s,"Generator"),d(S,u,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;_(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function c(t,e,n,r,a,o,i){try{var c=t[o](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,a)}function u(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){c(o,r,a,i,u,"next",t)}function u(t){c(o,r,a,i,u,"throw",t)}i(void 0)}))}}var l=!1,s=!1;function d(){return p.apply(this,arguments)}function p(){return(p=u(o().mark((function t(){var e,n;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(0,a.C)(),(0,r.Qm)(),t.next=6,h();case 6:return e=t.sent,t.next=9,m();case 9:return n=t.sent,t.abrupt("return",e&&n);case 13:return t.prev=13,t.t0=t.catch(0),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,null,[[0,13]])})))).apply(this,arguments)}function h(){return f.apply(this,arguments)}function f(){return(f=u(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!s&&"undefined"==typeof Chart){t.next=3;break}return s=!0,t.abrupt("return",!0);case 3:return t.prev=3,t.next=6,g("https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js");case 6:if("undefined"!=typeof Chart){t.next=8;break}throw new Error("Chart.js loaded but Chart object not available");case 8:return s=!0,t.abrupt("return",!0);case 13:return t.prev=13,t.t0=t.catch(3),t.abrupt("return",!1);case 17:case"end":return t.stop()}}),t,null,[[3,13]])})))).apply(this,arguments)}function m(){return v.apply(this,arguments)}function v(){return(v=u(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!l&&"undefined"==typeof tempusDominus){t.next=3;break}return"undefined"!=typeof tempusDominus&&(y(),l=!0),t.abrupt("return",l);case 3:return t.prev=3,e=void 0,(e=document.createElement("link")).rel="stylesheet",e.href="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.7.7/dist/css/tempus-dominus.min.css",document.head.appendChild(e),t.next=7,g("https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.7.7/dist/js/tempus-dominus.min.js");case 7:if("undefined"!=typeof tempusDominus){t.next=9;break}throw new Error("Tempus Dominus loaded but object not available");case 9:return y(),l=!0,t.abrupt("return",!0);case 14:return t.prev=14,t.t0=t.catch(3),t.abrupt("return",!1);case 18:case"end":return t.stop()}var e}),t,null,[[3,14]])})))).apply(this,arguments)}function g(t){return new Promise((function(e,n){var r=document.createElement("script");r.src=t,r.async=!0,r.onload=function(){return e()},r.onerror=function(t){return n(t)},document.head.appendChild(r)}))}function y(){if("undefined"!=typeof tempusDominus){var t=window.getCurrentLanguage(),e=t.substring(0,2);try{tempusDominus.DefaultOptions.localization={locale:e,format:"yyyy-MM-dd",dayViewHeaderFormat:{month:"long",year:"numeric"}},tempusDominus.DefaultOptions.useCurrent=!1,tempusDominus.DefaultOptions.keepInvalid=!1;try{for(var n=[],r=new Intl.DateTimeFormat(t,{weekday:"short"}),a=0;a<7;a++){var o=new Date(2023,0,a+1);n.push(r.format(o))}for(var i=[],c=new Intl.DateTimeFormat(t,{month:"long"}),u=0;u<12;u++){var l=new Date(2023,u,1);i.push(c.format(l))}if(tempusDominus.DefaultOptions.localization.dayNames=n,tempusDominus.DefaultOptions.localization.monthNames=i,tempusDominus.DefaultOptions.localization.startOfTheWeek=["en-US","en-CA"].includes(t)?0:1,"function"==typeof window.getTranslatedText)try{tempusDominus.DefaultOptions.localization.today=window.getTranslatedText("general","today")||"Today"}catch(t){tempusDominus.DefaultOptions.localization.today="Today"}}catch(t){}}catch(t){}}}function w(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;try{var o=function(){try{x(t,c)}catch(t){}},i=document.getElementById(t);if(!i)return null;if("undefined"==typeof tempusDominus||!tempusDominus.TempusDominus)return null;var c=new Set(n),u=new Date;a||(a="".concat(u.getFullYear(),"-").concat(String(u.getMonth()+1).padStart(2,"0"),"-").concat(String(u.getDate()).padStart(2,"0")));var l=new tempusDominus.TempusDominus(i,{display:{inline:!0,components:{clock:!1},calendarWeeks:!1},restrictions:{minDate:r?new Date(r+"T00:00:00"):void 0,maxDate:a?new Date(a+"T23:59:59"):void 0},localization:{locale:window.getCurrentLanguage().substring(0,2),format:"L",dayViewHeaderFormat:{month:"long",year:"numeric"}},useCurrent:!1,defaultDate:e});if(!l)return null;if(x(t,c),"function"==typeof l.subscribe)try{l.subscribe(tempusDominus.Namespace.events.update,o),l.subscribe(tempusDominus.Namespace.events.change,o)}catch(t){}return l}catch(t){return null}}function b(t){if(!t.date)return null;var e=t.date.year,n=String(t.date.month+1).padStart(2,"0"),r=String(t.date.date).padStart(2,"0");return"".concat(e,"-").concat(n,"-").concat(r)}function x(t,e){var n=document.getElementById(t);n&&n.querySelectorAll(".date-container-days .day").forEach((function(t){if(t.classList.remove("highlighted"),!t.classList.contains("disabled")){var n=t.getAttribute("data-value");if(n){var r=n.split("T")[0];e.has(r)&&t.classList.add("highlighted")}}}))}},178:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});const r={charts:{counterValue:"Compteur: {0}",backToDailyView:"Retour \xe0 l'aper\xe7u quotidien",clickDayInstructions:"Cliquez sur un jour pour afficher les donn\xe9es horaires",hourlyConsumption:"Consommation Horaire (kWh)",dailyConsumption:"Consommation Journali\xe8re (kWh)",hourlyData:"Donn\xe9es Horaires: {0}",dailyData:"Consommation Journali\xe8re: {0}",date:"Date:",startDate:"Date de D\xe9but",endDate:"Date de Fin",consumption:"Consommation: {0}",noDataAvailable:"Aucune donn\xe9e disponible pour cette p\xe9riode.",close:"Fermer",day:"Jour",hour:"Heure",history:{title:"Historique: {0}",hourlyData:"Consommation Horaire (Aujourd'hui)",dailyData:"Consommation Journali\xe8re (7 Derniers Jours)"},totalConsumption:"Analyses"},chartStats:{title:"Statistiques",total:"Consommation Totale",average:"Moyenne",median:"M\xe9diane",statistics:"Statistiques",averageLine:"Moyenne",medianLine:"M\xe9diane"},chartExport:{abortExport:"Annuler",processingMonth:"Traitement du mois: {current} / {total}",processingDay:"Traitement du jour: {current} / {total}",aborting:"Annulation en cours...",exportCancelled:"L'exportation PDF a \xe9t\xe9 annul\xe9e",hourlyConsumptionData:"Donn\xe9es de Consommation Horaire",dailyConsumptionData:"Donn\xe9es de Consommation Journali\xe8re",exportDropdown:"Exporter",exportingPDF:"G\xe9n\xe9ration du PDF en cours...",exportPDFWithDaily:"PDF avec valeurs horaires",exportExcelWithDaily:"Excel avec valeurs horaires",overviewSheet:"Vue d'ensemble",detailsSheet:"D\xe9tails Quotidiens",exportExcel:"Exporter vers Excel",exportPDF:"Exporter en PDF",hour:"Heure",date:"Date",consumption:"Consommation",counter:"Compteur",dataSheet:"Donn\xe9es de Consommation",errorExporting:"Erreur lors de l'exportation des donn\xe9es"},chartPDF:{pageNumbers:"Page {current} sur {total}"},totalConsumption:{menuItem:"Graphique de Consommation Totale",chartTitle:"Consommation Totale du Site",totalDailyConsumption:"Consommation Quotidienne Totale (kWh)",noDataAvailable:"Aucune donn\xe9e de consommation totale disponible pour la p\xe9riode s\xe9lectionn\xe9e.",errorLoadingChart:"Erreur lors du chargement du graphique de consommation totale."}}},240:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});const r={charts:{counterValue:"Contatore: {0}",backToDailyView:"Torna alla panoramica giornaliera",clickDayInstructions:"Clicca su un giorno per visualizzare i dati orari",hourlyConsumption:"Consumo Orario (kWh)",dailyConsumption:"Consumo Giornaliero (kWh)",hourlyData:"Dati Orari: {0}",dailyData:"Consumo Giornaliero: {0}",date:"Data:",startDate:"Data di Inizio",endDate:"Data di Fine",consumption:"Consumo: {0}",noDataAvailable:"Nessun dato disponibile per questo periodo.",close:"Chiudi",day:"Giorno",hour:"Ora",history:{title:"Cronologia: {0}",hourlyData:"Consumo Orario (Oggi)",dailyData:"Consumo Giornaliero (Ultimi 7 Giorni)"},totalConsumption:"Analisi"},chartStats:{title:"Statistiche",total:"Consumo Totale",average:"Media",median:"Mediana",statistics:"Statistiche",averageLine:"Media",medianLine:"Mediana"},chartExport:{abortExport:"Interrompere",processingMonth:"Elaborazione mese: {current} / {total}",processingDay:"Elaborazione giorno: {current} / {total}",aborting:"Interruzione in corso...",exportCancelled:"L'esportazione PDF \xe8 stata annullata",hourlyConsumptionData:"Dati di Consumo Orario",dailyConsumptionData:"Dati di Consumo Giornaliero",exportDropdown:"Esporta",exportingPDF:"Generazione PDF in corso...",exportPDFWithDaily:"PDF con valori orari",exportExcelWithDaily:"Excel con valori orari",overviewSheet:"Panoramica",detailsSheet:"Dettagli Giornalieri",exportExcel:"Esporta Excel",exportPDF:"Esporta PDF",hour:"Ora",date:"Data",consumption:"Consumo",counter:"Contatore",dataSheet:"Dati di Consumo",errorExporting:"Errore durante l'esportazione dei dati"},chartPDF:{pageNumbers:"Pagina {current} di {total}"},totalConsumption:{menuItem:"Grafico dei Consumi Totali",chartTitle:"Consumo Totale del Sito",totalDailyConsumption:"Consumo Giornaliero Totale (kWh)",noDataAvailable:"Nessun dato di consumo totale disponibile per il periodo selezionato.",errorLoadingChart:"Errore nel caricamento del grafico dei consumi totali."}}},290:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});const r={charts:{counterValue:"Contador: {0}",backToDailyView:"Volver a la vista diaria",clickDayInstructions:"Haga clic en un d\xeda para ver los datos por hora",hourlyConsumption:"Consumo Por Hora (kWh)",dailyConsumption:"Consumo Diario (kWh)",hourlyData:"Datos Por Hora: {0}",dailyData:"Consumo Diario: {0}",date:"Fecha:",startDate:"Fecha de Inicio",endDate:"Fecha de Fin",consumption:"Consumo: {0}",noDataAvailable:"No hay datos disponibles para este per\xedodo.",close:"Cerrar",day:"D\xeda",hour:"Hora",history:{title:"Historial: {0}",hourlyData:"Consumo Por Hora (Hoy)",dailyData:"Consumo Diario (\xdaltimos 7 D\xedas)"},totalConsumption:"An\xe1lisis"},chartStats:{title:"Estad\xedsticas",total:"Consumo Total",average:"Promedio",median:"Mediana",statistics:"Estad\xedsticas",averageLine:"Promedio",medianLine:"Mediana"},chartExport:{abortExport:"Abortar",processingMonth:"Procesando mes: {current} / {total}",processingDay:"Procesando d\xeda: {current} / {total}",aborting:"Abortando...",exportCancelled:"La exportaci\xf3n PDF ha sido cancelada",hourlyConsumptionData:"Datos de Consumo por Hora",dailyConsumptionData:"Datos de Consumo Diario",exportDropdown:"Exportar",exportingPDF:"Generando PDF...",exportPDFWithDaily:"PDF con valores por hora",exportExcelWithDaily:"Excel con valores por hora",overviewSheet:"Resumen",detailsSheet:"Detalles Diarios",exportExcel:"Exportar Excel",exportPDF:"Exportar PDF",hour:"Hora",date:"Fecha",consumption:"Consumo",counter:"Contador",dataSheet:"Datos de Consumo",errorExporting:"Error al exportar datos"},chartPDF:{pageNumbers:"P\xe1gina {current} de {total}"},totalConsumption:{menuItem:"Gr\xe1fico de Consumo Total",chartTitle:"Consumo Total del Sitio",totalDailyConsumption:"Consumo Diario Total (kWh)",noDataAvailable:"No hay datos de consumo total disponibles para el per\xedodo seleccionado.",errorLoadingChart:"Error al cargar el gr\xe1fico de consumo total."}}},313:(t,e,n)=>{function r(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"kWh";return{responsive:!0,maintainAspectRatio:!1,devicePixelRatio:window.devicePixelRatio,scales:{y:{beginAtZero:!0,title:{display:!0,text:t},grace:"5%",ticks:{callback:function(t){return window.formatNumber(t,"",window.getCurrentLanguage(),2)}}}},plugins:{tooltip:{callbacks:{label:function(t){var e=t.raw,n="";if(n=window.getTranslatedText("charts","consumption").replace("{0}",window.formatNumber(e," kWh",window.getCurrentLanguage(),2)),t.dataset&&t.dataset.counterValues&&void 0!==t.dataset.counterValues[t.dataIndex]){var r=t.dataset.counterValues[t.dataIndex];n=[n,window.getTranslatedText("charts","counterValue").replace("{0}",window.formatNumber(r," kWh",window.getCurrentLanguage(),2))]}return n}}},legend:{display:!0}}}}function a(t){t&&(t.innerHTML='\n        <div class="alert alert-info">\n            '.concat(window.getTranslatedText("charts","noDataAvailable"),"\n        </div>\n    "))}function o(t){var e=t.modalId,n=t.chartId,r=t.title,a=t.isHourly,o=t.hasParent,i=(t.minDate,t.maxDate,t.startDate),c=void 0===i?"":i,u=t.endDate,l=void 0===u?"":u,s=t.showClickInstructions,d=void 0!==s&&s?'<div class="text-end me-3 mt-1 small text-muted">\n             <i class="fa-solid fa-circle-info me-1"></i>'.concat(window.getTranslatedText("charts","clickDayInstructions"),"\n           </div>"):"",p=o?'<div class="text-center mt-3">\n             <button type="button" id="back-to-daily-btn" class="btn btn-outline-secondary" data-translation-key="charts.backToDailyView">\n                 <i class="fa-solid fa-arrow-left me-2"></i>'.concat(window.getTranslatedText("charts","backToDailyView"),"\n             </button>\n           </div>"):"",h=a?"":'<div class="row mb-3">\n             <div class="col-md-6">\n                 <label class="form-label text-center w-100">'.concat(window.getTranslatedText("charts","startDate"),'</label>\n                 <div id="').concat(e,'-start-datepicker" class="inline-calendar d-flex justify-content-center"></div>\n                 <input type="hidden" id="').concat(e,'-start-date" value="').concat(c,'">\n             </div>\n             <div class="col-md-6">\n                 <label class="form-label text-center w-100">').concat(window.getTranslatedText("charts","endDate"),'</label>\n                 <div id="').concat(e,'-end-datepicker" class="inline-calendar d-flex justify-content-center"></div>\n                 <input type="hidden" id="').concat(e,'-end-date" value="').concat(l,'">\n             </div>\n           </div>'),f='\n        <li><a class="dropdown-item" href="#" data-export-action="pdf" data-chart-id="'.concat(n,'" data-include-daily="false">\n            <i class="fa-solid fa-file-pdf me-2"></i>').concat(window.getTranslatedText("chartExport","exportPDF"),"\n        </a></li>\n        ").concat(a?"":'\n        <li><a class="dropdown-item" href="#" data-export-action="pdf-daily" data-chart-id="'.concat(n,'" data-include-daily="true">\n            <i class="fa-solid fa-file-pdf me-2"></i>').concat(window.getTranslatedText("chartExport","exportPDFWithDaily"),"\n        </a></li>\n        "),'\n        <li><hr class="dropdown-divider"></li>\n        <li><a class="dropdown-item" href="#" data-export-action="excel" data-chart-id="').concat(n,'" data-include-daily="false">\n            <i class="fa-solid fa-file-excel me-2"></i>').concat(window.getTranslatedText("chartExport","exportExcel"),"\n        </a></li>\n        ").concat(a?"":'\n        <li><a class="dropdown-item" href="#" data-export-action="excel-daily" data-chart-id="'.concat(n,'" data-include-daily="true">\n            <i class="fa-solid fa-file-excel me-2"></i>').concat(window.getTranslatedText("chartExport","exportExcelWithDaily"),"\n        </a></li>\n        "));return'\n    <div class="modal fade" id="'.concat(e,'" tabindex="-1" aria-labelledby="').concat(e,'-label" aria-hidden="true">\n        <div class="modal-dialog modal-dialog-centered modal-lg">\n            <div class="modal-content">\n                <div class="modal-header">\n                    <h5 class="modal-title" id="').concat(e,'-label">').concat(r,'</h5>\n                    <div class="d-flex" style="padding: calc(var(--bs-modal-header-padding-y) * .5) calc(var(--bs-modal-header-padding-x) * .5); margin: calc(-.5 * var(--bs-modal-header-padding-y)) calc(-.5 * var(--bs-modal-header-padding-x)) calc(-.5 * var(--bs-modal-header-padding-y)) auto;">\n                        <div class="dropdown me-2">\n                            <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" id="').concat(e,'-export-dropdown" data-bs-toggle="dropdown" aria-expanded="false">\n                                <i class="fa-solid fa-file-export"></i> ').concat(window.getTranslatedText("chartExport","exportDropdown"),'\n                            </button>\n                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="').concat(e,'-export-dropdown">\n                                ').concat(f,'\n                            </ul>\n                        </div>\n                    </div>\n                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="padding: calc(var(--bs-modal-header-padding-y) * .5) calc(var(--bs-modal-header-padding-x) * .5);margin: 0 !important;"></button>                    \n                </div>\n                <div class="modal-body">\n                    ').concat(h,'\n                    <div class="chart-container" style="position: relative; height: 400px; max-height: 500px; overflow: hidden;">\n                        <div id="').concat(n,'" style="width: 100%; height: 100%;"></div>\n                    </div>\n                    ').concat(d,"\n                    ").concat(p,"\n                </div>\n            </div>\n        </div>\n    </div>\n    ")}function i(t){if(!t)return{consumption:[],counterValues:[]};if(-1===t.zaehlerid){for(var e=[],n=0;n<24;n++){var r="usage_".concat(n.toString().padStart(2,"0"));e.push(t[r]||0)}return{consumption:e,counterValues:Array(24).fill(0)}}var a={raw:{date:t.datum,zaehlerid:t.zaehlerid,val_start:t.val_start||0,val_1:t.val_1||0,val_2:t.val_2||0,val_3:t.val_3||0,val_4:t.val_4||0,val_5:t.val_5||0,val_6:t.val_6||0,val_7:t.val_7||0,val_8:t.val_8||0,val_9:t.val_9||0,val_10:t.val_10||0,val_11:t.val_11||0,val_12:t.val_12||0,val_13:t.val_13||0,val_14:t.val_14||0,val_15:t.val_15||0,val_16:t.val_16||0,val_17:t.val_17||0,val_18:t.val_18||0,val_19:t.val_19||0,val_20:t.val_20||0,val_21:t.val_21||0,val_22:t.val_22||0,val_23:t.val_23||0,val_end:t.val_end||0},current:{isCurrentDay:!1,currentHour:-1,currentValue:0},calculated:{consumption:[],counterValues:[],lastNonZeroIndex:-1,processingSteps:[]}},o=new Date,i="".concat(o.getFullYear(),"-").concat(String(o.getMonth()+1).padStart(2,"0"),"-").concat(String(o.getDate()).padStart(2,"0")),c=t.datum===i;a.current.isCurrentDay=c;var u={value:0,hour:-1};c&&(u=function(t){if(!t)return{value:0,hour:-1};var e=(new Date).getHours(),n=window.getChannelById(t);if(n){var r=window.decodeChannel(n);if(r&&"number"==typeof r.stand)return{value:r.stand,hour:e}}return{value:0,hour:e}}(t.zaehlerid),a.current.currentHour=u.hour,a.current.currentValue=u.value);for(var l=[t.val_1||0,t.val_2||0,t.val_3||0,t.val_4||0,t.val_5||0,t.val_6||0,t.val_7||0,t.val_8||0,t.val_9||0,t.val_10||0,t.val_11||0,t.val_12||0,t.val_13||0,t.val_14||0,t.val_15||0,t.val_16||0,t.val_17||0,t.val_18||0,t.val_19||0,t.val_20||0,t.val_21||0,t.val_22||0,t.val_23||0,t.val_end||0],s=-1,d=0;d<l.length-1;d++)l[d]>0&&(s=d);a.calculated.lastNonZeroIndex=s;for(var p=[],h=[],f=t.val_start||0,m=0;m<l.length;m++){var v=l[m],g={hour:m,value:v,prevValue:f,action:"",result:{consumption:0,counterValue:0}};if(c)if(m<u.hour)if(0===v&&m>0&&0!==l[m-1])p.push(0),h.push(f),g.action="past hour with missing value",g.result={consumption:0,counterValue:f};else{var y=Math.max(0,v-f);p.push(y),h.push(v),g.action="past hour with value",g.result={consumption:y,counterValue:v},0!==v&&(f=v)}else if(m===u.hour)if(u.value>0){var w=Math.max(0,u.value-f);p.push(w),h.push(u.value),g.action="current hour with live value",g.result={consumption:w,counterValue:u.value},f=u.value}else{var b=Math.max(0,v-f);p.push(b),h.push(v>0?v:f),g.action="current hour without live value",g.result={consumption:b,counterValue:v>0?v:f},0!==v&&(f=v)}else p.push(0),h.push(0),g.action="future hour",g.result={consumption:0,counterValue:0};else if(m===l.length-1&&s!==l.length-2){if(p.push(0),h.push(v),g.action="historical val_end with gap",g.result={consumption:0,counterValue:v},s>=0&&s<l.length-2){var x=s+1,D=Math.max(0,v-l[s]);p[x]=D,h[x]=l[s]+D,a.calculated.processingSteps.push({hour:x,action:"historical attribution of val_end consumption",calculation:{endValue:v,lastValidValue:l[s],consumption:D},result:{consumption:D,counterValue:l[s]+D}})}}else if(0===v)p.push(0),h.push(f),g.action="historical hour with missing value",g.result={consumption:0,counterValue:f};else{var k=Math.max(0,v-f);p.push(k),h.push(v),g.action="historical hour with value",g.result={consumption:k,counterValue:v},f=v}a.calculated.processingSteps.push(g)}return a.calculated.consumption=p,a.calculated.counterValues=h,{consumption:p,counterValues:h}}function c(){return["00 - 01","01 - 02","02 - 03","03 - 04","04 - 05","05 - 06","06 - 07","07 - 08","08 - 09","09 - 10","10 - 11","11 - 12","12 - 13","13 - 14","14 - 15","15 - 16","16 - 17","17 - 18","18 - 19","19 - 20","20 - 21","21 - 22","22 - 23","23 - 24"]}function u(t){return t.map((function(t){var e=t.split("-");return"".concat(e[2],".").concat(e[1],".")}))}function l(t,e,n){return"hourly"===t?{label:window.getTranslatedText("charts","hourlyConsumption"),data:e,backgroundColor:"rgba(54, 162, 235, 0.5)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1,counterValues:n}:{label:window.getTranslatedText("charts","dailyConsumption"),data:e,backgroundColor:"rgba(75, 192, 192, 0.5)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1,counterValues:n}}function s(){try{var t=document.querySelector(".tools-dropdown .dropdown-menu");if(!t)return;var e=t.querySelector(".dropdown-divider");if(e){var n=document.createElement("div");n.innerHTML='\n                <li><hr class="dropdown-divider"></li>\n                <li><h6 class="dropdown-header">'.concat(window.getTranslatedText("charts","totalConsumption"),'</h6></li>\n                <li>\n                    <a class="dropdown-item" href="#" id="total-consumption-chart">\n                        <i class="fa-solid fa-chart-line"></i>\n                        <span>').concat(window.getTranslatedText("totalConsumption","menuItem"),"</span>\n                    </a>\n                </li>\n            "),e.parentNode.insertBefore(n,e)}else{var r=document.createElement("li");r.innerHTML='\n                <a class="dropdown-item" href="#" id="total-consumption-chart">\n                    <i class="fa-solid fa-chart-line"></i>\n                    <span>'.concat(window.getTranslatedText("totalConsumption","menuItem"),"</span>\n                </a>\n            "),t.appendChild(r)}var a=document.getElementById("total-consumption-chart");a&&a.addEventListener("click",(function(t){t.preventDefault(),window.showTotalConsumptionChart()}))}catch(t){}}n.d(e,{Ah:()=>r,MU:()=>c,Se:()=>s,a1:()=>a,lN:()=>l,nF:()=>i,rJ:()=>o,yC:()=>u})},359:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});const r={charts:{counterValue:"\u0160tevec: {0}",backToDailyView:"Nazaj na dnevni pregled",clickDayInstructions:"Kliknite na dan za ogled urnih podatkov",hourlyConsumption:"Urna Poraba (kWh)",dailyConsumption:"Dnevna Poraba (kWh)",hourlyData:"Urni Podatki: {0}",dailyData:"Dnevna Poraba: {0}",date:"Datum:",startDate:"Za\u010detni Datum",endDate:"Kon\u010dni Datum",consumption:"Poraba: {0}",noDataAvailable:"Za to obdobje ni na voljo podatkov.",close:"Zapri",day:"Dan",hour:"Ura",history:{title:"Zgodovina: {0}",hourlyData:"Urna Poraba (Danes)",dailyData:"Dnevna Poraba (Zadnjih 7 Dni)"},totalConsumption:"Analize"},chartStats:{title:"Statistika",total:"Skupna Poraba",average:"Povpre\u010dje",median:"Mediana",statistics:"Statistika",averageLine:"Povpre\u010dje",medianLine:"Mediana"},chartExport:{abortExport:"Prekini",processingMonth:"Obdelava meseca: {current} / {total}",processingDay:"Obdelava dneva: {current} / {total}",aborting:"Prekinjanje...",exportCancelled:"Izvoz PDF je bil preklican",hourlyConsumptionData:"Podatki o Urni Porabi",dailyConsumptionData:"Podatki o Dnevni Porabi",exportDropdown:"Izvoz",exportingPDF:"Ustvarjanje PDF-ja...",exportPDFWithDaily:"PDF z urnimi vrednostmi",exportExcelWithDaily:"Excel z urnimi vrednostmi",overviewSheet:"Pregled",detailsSheet:"Dnevni Podatki",exportExcel:"Izvoz Excel",exportPDF:"Izvoz PDF",hour:"Ura",date:"Datum",consumption:"Poraba",counter:"\u0160tevec",dataSheet:"Podatki o Porabi",errorExporting:"Napaka pri izvozu podatkov"},chartPDF:{pageNumbers:"Stran {current} od {total}"},totalConsumption:{menuItem:"Graf Skupne Porabe",chartTitle:"Skupna Poraba Lokacije",totalDailyConsumption:"Skupna Dnevna Poraba (kWh)",noDataAvailable:"Za izbrano obdobje ni na voljo podatkov o skupni porabi.",errorLoadingChart:"Napaka pri nalaganju grafa skupne porabe."}}},405:(t,e,n)=>{var r={"./charts-lang-de-DE.js":456,"./charts-lang-en-US.js":559,"./charts-lang-es-ES.js":290,"./charts-lang-fr-FR.js":178,"./charts-lang-hr-HR.js":778,"./charts-lang-it-IT.js":240,"./charts-lang-nl-NL.js":846,"./charts-lang-sl-SI.js":359};function a(t){var e=o(t);return n(e)}function o(t){if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return r[t]}a.keys=function(){return Object.keys(r)},a.resolve=o,t.exports=a,a.id=405},456:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});const r={charts:{counterValue:"Z\xe4hlerstand: {0}",backToDailyView:"Zur\xfcck zur Tages\xfcbersicht",clickDayInstructions:"Klicke auf einen Tag, um st\xfcndliche Daten anzuzeigen",hourlyConsumption:"St\xfcndlicher Verbrauch (kWh)",dailyConsumption:"T\xe4glicher Verbrauch (kWh)",hourlyData:"St\xfcndliche Daten: {0}",dailyData:"T\xe4glicher Verbrauch: {0}",date:"Datum:",startDate:"Startdatum",endDate:"Enddatum",consumption:"Verbrauch: {0}",noDataAvailable:"Keine Daten f\xfcr diesen Zeitraum verf\xfcgbar.",close:"Schlie\xdfen",day:"Tag",hour:"Stunde",history:{title:"Verlauf: {0}",hourlyData:"St\xfcndlicher Verbrauch (Heute)",dailyData:"T\xe4glicher Verbrauch (Letzte 7 Tage)"},totalConsumption:"Auswertungen"},chartStats:{title:"Statistik",total:"Gesamtverbrauch",average:"Durchschnitt",median:"Median",statistics:"Statistiken",averageLine:"Durchschnitt",medianLine:"Median"},chartExport:{abortExport:"Abbrechen",processingMonth:"Verarbeitung Monat: {current} / {total}",processingDay:"Verarbeitung Tag: {current} / {total}",aborting:"Wird abgebrochen...",exportCancelled:"PDF-Export wurde abgebrochen",hourlyConsumptionData:"St\xfcndliche Verbrauchsdaten",dailyConsumptionData:"T\xe4gliche Verbrauchsdaten",exportDropdown:"Exportieren",exportingPDF:"PDF wird erstellt...",exportPDFWithDaily:"PDF mit Stundenwerten",exportExcelWithDaily:"Excel mit Stundenwerten",overviewSheet:"\xdcbersicht",detailsSheet:"Tagesdetails",exportExcel:"Excel exportieren",exportPDF:"PDF exportieren",hour:"Stunde",date:"Datum",consumption:"Verbrauch",counter:"Z\xe4hlerstand",dataSheet:"Verbrauchsdaten",errorExporting:"Fehler beim Exportieren der Daten"},chartPDF:{pageNumbers:"Seite {current} von {total}"},totalConsumption:{menuItem:"Gesamtverbrauch-Diagramm",chartTitle:"Gesamtverbrauch der Anlage",totalDailyConsumption:"T\xe4glicher Gesamtverbrauch (kWh)",noDataAvailable:"Keine Gesamtverbrauchsdaten f\xfcr den ausgew\xe4hlten Zeitraum verf\xfcgbar.",errorLoadingChart:"Fehler beim Laden des Gesamtverbrauch-Diagramms."}}},559:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});const r={charts:{counterValue:"Counter: {0}",backToDailyView:"Back to Daily Overview",clickDayInstructions:"Click on a day to view hourly data",hourlyConsumption:"Hourly Consumption (kWh)",dailyConsumption:"Daily Consumption (kWh)",hourlyData:"Hourly Data: {0}",dailyData:"Daily Consumption: {0}",date:"Date:",startDate:"Start Date",endDate:"End Date",consumption:"Consumption: {0}",noDataAvailable:"No data available for this date range.",close:"Close",day:"Day",hour:"Hour",history:{title:"History: {0}",hourlyData:"Hourly Consumption (Today)",dailyData:"Daily Consumption (Last 7 Days)"},totalConsumption:"Analysis"},chartStats:{title:"Statistics",total:"Total Consumption",average:"Average",median:"Median",statistics:"Statistics",averageLine:"Average",medianLine:"Median"},chartExport:{abortExport:"Abort",processingMonth:"Processing month: {current} / {total}",processingDay:"Processing day: {current} / {total}",aborting:"Aborting...",exportCancelled:"PDF export was cancelled",hourlyConsumptionData:"Hourly Consumption Data",dailyConsumptionData:"Daily Consumption Data",exportDropdown:"Export",exportingPDF:"Generating PDF...",exportPDFWithDaily:"PDF with hourly values",exportExcelWithDaily:"Excel with hourly values",overviewSheet:"Overview",detailsSheet:"Daily Details",exportExcel:"Export Excel",exportPDF:"Export PDF",hour:"Hour",date:"Date",consumption:"Consumption",counter:"Counter",dataSheet:"Consumption Data",errorExporting:"Error exporting data"},chartPDF:{pageNumbers:"Page {current} of {total}"},totalConsumption:{menuItem:"Total Consumption Chart",chartTitle:"Total Site Consumption",totalDailyConsumption:"Total Daily Consumption (kWh)",noDataAvailable:"No total consumption data available for the selected period.",errorLoadingChart:"Error loading total consumption chart."}}},618:(t,e,n)=>{n.d(e,{j:()=>ut,C:()=>it});var r=n(690);function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function o(t){if(!t||0===t.length)return{total:0,average:0,median:0};var e=t.filter((function(t){return null!=t&&!isNaN(t)}));if(0===e.length)return{total:0,average:0,median:0};var n,r,o=e.reduce((function(t,e){return t+e}),0),i=o/e.length,c=(r=e,function(t){if(Array.isArray(t))return a(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort((function(t,e){return t-e}));if(c.length%2==0){var u=c.length/2;n=(c[u-1]+c[u])/2}else n=c[Math.floor(c.length/2)];return{total:o,average:i,median:n}}function i(t,e){return{averageLine:{type:"line",label:window.getTranslatedText("chartStats","averageLine"),data:Array(e).fill(t.average),borderColor:"rgba(255, 99, 132, 1)",borderWidth:1.5,borderDash:[5,5],pointRadius:0,fill:!1,tension:0}}}var c=n(313);function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(){l=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function d(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var o=e&&e.prototype instanceof w?e:w,i=Object.create(o.prototype),c=new O(r||[]);return a(i,"_invoke",{value:L(t,n,c)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var f="suspendedStart",m="suspendedYield",v="executing",g="completed",y={};function w(){}function b(){}function x(){}var D={};d(D,i,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(I([])));E&&E!==n&&r.call(E,i)&&(D=E);var S=x.prototype=w.prototype=Object.create(D);function C(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(a,o,i,c){var l=h(t[a],t,o);if("throw"!==l.type){var s=l.arg,d=s.value;return d&&"object"==u(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(d).then((function(t){s.value=t,i(s)}),(function(t){return n("throw",t,i,c)}))}c(l.arg)}var o;a(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,a){n(t,r,e,a)}))}return o=o?o.then(a,a):a()}})}function L(e,n,r){var a=f;return function(o,i){if(a===v)throw Error("Generator is already running");if(a===g){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var u=j(c,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===f)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var l=h(e,n,r);if("normal"===l.type){if(a=r.done?g:m,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=g,r.method="throw",r.arg=l.arg)}}}function j(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,j(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function I(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(u(e)+" is not iterable")}return b.prototype=x,a(S,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:b,configurable:!0}),b.displayName=d(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,d(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},C(T.prototype),d(T.prototype,c,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new T(p(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},C(S),d(S,s,"Generator"),d(S,i,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;_(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function s(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=d(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){c=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw o}}}}function d(t,e){if(t){if("string"==typeof t)return p(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function h(t,e,n,r,a,o,i){try{var c=t[o](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,a)}function f(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){h(o,r,a,i,c,"next",t)}function c(t){h(o,r,a,i,c,"throw",t)}i(void 0)}))}}var m=!1,v=0;function g(t,e,n,r){return y.apply(this,arguments)}function y(){return y=f(l().mark((function t(e,n,r,a){var o,i,c,u,s,p,h,f,y,b,k,E,S,T,L,j,_,I,F,z,A,M,V,G,W,B,H,U,R,Y,K,Z,q,X,J,$,Q,tt,et,nt,rt,at,ot,it,ct,ut,lt,st,dt,pt,ht,ft,mt,vt,gt=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=gt.length>4&&void 0!==gt[4]?gt[4]:"kWh",i=gt.length>5&&void 0!==gt[5]&&gt[5],t.prev=2,"undefined"!=typeof jspdf||"undefined"!=typeof jsPDF){t.next=7;break}return C((function(){setTimeout((function(){return g(e,n,r,a,o)}),1e3)})),t.abrupt("return");case 7:if(m=!1,v=0,(c=document.createElement("div")).style.position="fixed",c.style.top="0",c.style.left="0",c.style.width="100%",c.style.height="100%",c.style.backgroundColor="rgba(0,0,0,0.5)",c.style.display="flex",c.style.justifyContent="center",c.style.alignItems="center",c.style.zIndex="9999",c.innerHTML='\n            <div style="background: white; padding: 20px; border-radius: 5px; text-align: center; min-width: 300px;">\n                <div><i class="fa-solid fa-spinner fa-spin fa-2x"></i></div>\n                <div style="margin-top: 10px;">'.concat(window.getTranslatedText("chartExport","exportingPDF")||"Generating PDF...",'</div>\n                <div id="pdf-export-month-progress-container" style="margin-top: 15px; display: none;">\n                    <div class="progress" style="height: 10px;">\n                        <div id="pdf-export-month-progress-bar" class="progress-bar" role="progressbar" style="width: 0%;" \n                            aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                    </div>\n                    <div id="pdf-export-month-progress-text" style="margin-top: 5px; font-size: 0.8em;">\n                        <span id="pdf-export-month-current">0</span> / <span id="pdf-export-month-total">0</span>\n                    </div>\n                </div>\n                <div id="pdf-export-progress-container" style="margin-top: 15px; display: none;">\n                    <div class="progress" style="height: 10px;">\n                        <div id="pdf-export-progress-bar" class="progress-bar" role="progressbar" style="width: 0%;" \n                            aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>\n                    </div>\n                    <div id="pdf-export-progress-text" style="margin-top: 5px; font-size: 0.8em;">\n                        <span id="pdf-export-progress-type"></span>: <span id="pdf-export-current">0</span> / <span id="pdf-export-total">0</span>\n                    </div>\n                </div>\n                <div style="margin-top: 15px;">\n                    <button id="pdf-export-abort-btn" class="btn btn-sm btn-outline-secondary">\n                        <i class="fa-solid fa-times me-1"></i>').concat(window.getTranslatedText("chartExport","abortExport")||"Abort","\n                    </button>\n                </div>\n            </div>\n        "),document.body.appendChild(c),(u=document.getElementById("pdf-export-abort-btn"))&&u.addEventListener("click",(function(){m=!0,u.disabled=!0,u.innerHTML='<i class="fa-solid fa-spinner fa-spin me-1"></i>'.concat(window.getTranslatedText("chartExport","aborting")||"Aborting...")})),s=function(t){"Escape"===t.key&&(m=!0,u&&(u.disabled=!0,u.innerHTML='<i class="fa-solid fa-spinner fa-spin me-1"></i>'.concat(window.getTranslatedText("chartExport","aborting")||"Aborting...")))},document.addEventListener("keydown",s),p="undefined"!=typeof jspdf?jspdf.jsPDF:jsPDF,h=e.data.labels||[],f=e.data.datasets||[],y=f.length>0?f[0]:{data:[]},b=y.data||[],k=y.counterValues||[],E=e.data.rawDates||[],S="hourly"===a,T=e.zaehlerid||null,L="",(j=-1===T)?L=j?window.getTranslatedText("totalConsumption","chartTitle"):channel?channel.beschreibung:"Unknown":(_=window.decodeChannel(window.getChannelById(T)),L=_.beschreibung),I=0,F=new Set,z={},!S&&E&&E.length>0&&(I=E.length,E.forEach((function(t,e){var n=t.split("-"),r="".concat(n[0],"-").concat(n[1]);F.add(r),z[r]||(z[r]=[]),z[r].push({date:t,label:h[e],consumption:b[e]||0,counter:k[e]||0})}))),M=new p({orientation:A=I>14?"landscape":"portrait",compress:!0}),V=document.getElementById("sitename").innerHTML,M.setProperties({title:L,subject:window.getTranslatedText("chartExport","hourly"===a?"hourlyConsumptionData":"dailyConsumptionData"),author:V,creator:"CTOOLS.io",compress:!0}),G=M.internal.pageSize.getWidth(),W=M.internal.pageSize.getHeight(),B=15,!(F.size>1&&I>31)){t.next=82;break}N(0,H=Object.keys(z).length),U=0,R=Object.entries(z);case 53:if(!(U<R.length)){t.next=80;break}if(l=R[U],Y=function(t){if(Array.isArray(t))return t}(l)||function(t){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,a,o,i=[],c=!0,u=!1;try{for(a=(e=e.call(t)).next,!2;!(c=(n=a.call(e)).done)&&(i.push(n.value),2!==i.length);c=!0);}catch(t){u=!0,r=t}finally{try{if(!c&&null!=e.return&&(o=e.return(),Object(o)!==o))return}finally{if(u)throw r}}return i}}(l)||d(l,2)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),K=Y[0],Z=Y[1],N(++v,H),!m){t.next=60;break}return t.abrupt("break",80);case 60:return K!==Object.keys(z)[0]&&(M.addPage(A),B=15),q=new Date(K+"-01"),X=q.toLocaleDateString(window.getCurrentLanguage(),{month:"long",year:"numeric"}),M.setFontSize(16),M.text("".concat(L," - ").concat(X),G/2,B,{align:"center"}),B+=10,t.next=68,w(M,Z,B,G,A,o);case 68:if(B=t.sent,"function"==typeof M.autoTable?(J=Z.map((function(t){return{label:t.label,consumption:window.formatNumber(t.consumption||0,"",window.getCurrentLanguage(),2),counter:window.formatNumber(t.counter||0,"",window.getCurrentLanguage(),2)}})),$=[{header:window.getTranslatedText("chartExport","date"),dataKey:"label"},{header:"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(o,")"),dataKey:"consumption"},{header:"".concat(window.getTranslatedText("chartExport","counter")," (").concat(o,")"),dataKey:"counter"}],M.autoTable({startY:B,columns:$,body:J,margin:{left:20,right:20},theme:"grid",headStyles:{fillColor:[0,118,168],textColor:255,fontSize:9},bodyStyles:{fontSize:9},alternateRowStyles:{fillColor:[245,245,245]}})):M.text("Data table could not be generated - autoTable plugin not available",20,B),S||!i){t.next=77;break}if(Q=Z.map((function(t){return t.date})),!m){t.next=75;break}return t.abrupt("break",80);case 75:return t.next=77,D(M,Q,L,o,T);case 77:U++,t.next=53;break;case 80:t.next=101;break;case 82:if("daily"===a?tt=P(h):e&&e.chartDate?(et=new Date(e.chartDate),tt=et.toLocaleDateString(window.getCurrentLanguage())):tt=(new Date).toLocaleDateString(window.getCurrentLanguage()),M.setFontSize(16),M.text(L,G/2,B,{align:"center"}),B+=8,M.setFontSize(12),M.text("".concat("hourly"===a?window.getTranslatedText("charts","hourlyData").replace("{0}",""):window.getTranslatedText("charts","dailyData").replace("{0}","")," ").concat(tt),G/2,B,{align:"center"}),B+=10,nt=e.canvas,rt=nt.toDataURL("image/png",1),at=nt.width/nt.height,"portrait"===A?it=(ot=G-40)/at:(ot=G-40,it=Math.min(ot/at,110)),M.addImage(rt,"PNG",20,B,ot,it,"","FAST"),B+=it+15,!S&&I>14&&(M.addPage(A),B=15,M.setFontSize(14),M.text("".concat(L," - ").concat(window.getTranslatedText("chartExport","detailsSheet")),G/2,B,{align:"center"}),B+=10),ct=x(h,b,k,S,E),"function"==typeof M.autoTable?(ut=[{header:S?window.getTranslatedText("chartExport","hour"):window.getTranslatedText("chartExport","date"),dataKey:"label"},{header:"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(o,")"),dataKey:"consumption"},{header:"".concat(window.getTranslatedText("chartExport","counter")," (").concat(o,")"),dataKey:"counter"}],M.autoTable({startY:B,columns:ut,body:ct,margin:{left:20,right:20},theme:"grid",headStyles:{fillColor:[0,118,168],textColor:255,fontSize:9},bodyStyles:{fontSize:9},alternateRowStyles:{fillColor:[245,245,245]}}),B=M.previousAutoTable.finalY+10):(M.text("Data table could not be generated - autoTable plugin not available",20,B),B+=10,C()),S||!i){t.next=101;break}return t.next=101,D(M,E,L,o,T);case 101:for(lt=M.internal.getNumberOfPages(),st=new Date,dt=window.getCurrentLanguage(),pt=1;pt<=lt;pt++)M.setPage(pt),M.setFontSize(8),M.text(V,20,W-10,{align:"left"}),ht=st.toLocaleDateString(dt,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),ft=(ft=window.getTranslatedText("chartPDF","pageNumbers")).replace("{current}",pt).replace("{total}",lt),M.text("CTOOLS.io - ".concat(ht," - ").concat(ft),G-20,W-10,{align:"right"});mt=O(L,window.formatDate(new Date,"date"),"pdf"),M.save(mt),c&&(document.removeEventListener("keydown",s),document.body.removeChild(c)),t.next=115;break;case 110:t.prev=110,t.t0=t.catch(2),m||window.getTranslatedText("chartExport","errorExporting"),(vt=document.querySelector('div[style*="rgba(0,0,0,0.5)"]'))&&(document.removeEventListener("keydown",keyHandler),document.body.removeChild(vt));case 115:case"end":return t.stop()}var l}),t,null,[[2,110]])}))),y.apply(this,arguments)}function w(t,e,n,r,a){return b.apply(this,arguments)}function b(){return b=f(l().mark((function t(e,n,r,a,i){var c,u=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=u.length>5&&void 0!==u[5]?u[5]:"kWh",t.abrupt("return",new Promise((function(t,i){try{var u=n.map((function(t){return t.label})),l=n.map((function(t){return t.consumption})),s=n.map((function(t){return t.counter})),d=document.createElement("canvas");d.width=800,d.height=400,document.body.appendChild(d);var p={labels:u,datasets:[{label:window.getTranslatedText("charts","dailyConsumption"),data:l,backgroundColor:"rgba(75, 192, 192, 0.5)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1,counterValues:s}]},h=o(l),f=window.formatNumber(h.total," kWh",window.getCurrentLanguage(),2),m=window.formatNumber(h.average," kWh",window.getCurrentLanguage(),2),v=window.getTranslatedText("chartStats","total"),g=window.getTranslatedText("charts","day"),y="".concat(f," ").concat(v," - \xd8 ").concat(m," / ").concat(g);h.average>0&&p.datasets.push({type:"line",label:window.getTranslatedText("chartStats","averageLine"),data:Array(l.length).fill(h.average),borderColor:"rgba(255, 99, 132, 1)",borderWidth:1.5,borderDash:[5,5],pointRadius:0,fill:!1,tension:0}),new Chart(d.getContext("2d"),{type:"bar",data:p,options:{responsive:!0,maintainAspectRatio:!0,scales:{y:{beginAtZero:!0,title:{display:!0,text:c},ticks:{callback:function(t){return window.formatNumber(t,"",window.getCurrentLanguage(),2)}}}},plugins:{legend:{display:!0,position:"top"},title:{display:!0,position:"bottom",text:y}},animation:{duration:0}}}),setTimeout((function(){try{var n,o,i=d.toDataURL("image/png");o=(n=a-40)*(d.height/d.width),e.addImage(i,"PNG",20,r,n,o),document.body.removeChild(d),t(r+o+10)}catch(n){e.setFontSize(10),e.text("Error generating monthly chart",20,r+10),document.body.contains(d)&&document.body.removeChild(d),t(r+20)}}),500)}catch(n){e.setFontSize(10),e.text("Error generating monthly chart",20,r+10),t(r+20)}})));case 2:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}function x(t,e,n,r,a){var o=window.getCurrentLanguage(),i=[];return r?t.forEach((function(t,r){r<e.length&&i.push({label:t,consumption:window.formatNumber(e[r]||0,"",o,2),counter:window.formatNumber(n[r]||0,"",o,2)})})):t.forEach((function(t,r){if(r<e.length){var c=_(t,a?a[r]:null);i.push({label:c,consumption:window.formatNumber(e[r]||0,"",o,2),counter:window.formatNumber(n[r]||0,"",o,2)})}})),i}function D(t,e,n,r){return k.apply(this,arguments)}function k(){return k=f(l().mark((function t(e,n,r,a){var o,i,u,d,p,h,f,v,g,y,w,b,x,D=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=D.length>4&&void 0!==D[4]?D[4]:null){t.next=3;break}return t.abrupt("return");case 3:return i=document.getElementById("pdf-export-progress-container"),u=document.getElementById("pdf-export-progress-bar"),d=document.getElementById("pdf-export-current"),p=document.getElementById("pdf-export-total"),i&&u&&d&&p&&(i.style.display="block",p.textContent=n.length,d.textContent="0",u.style.width="0%",u.setAttribute("aria-valuenow","0")),h={},t.prev=9,t.next=12,L(n,r,o);case 12:h=t.sent,t.next=18;break;case 15:t.prev=15,t.t0=t.catch(9);case 18:f=0,v=0,g=!1,y=s(n),t.prev=22,b=l().mark((function t(){var o,i,u,s,d,p,y,b,x,D,k;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=w.value,!m){t.next=4;break}return t.abrupt("return",0);case 4:if(i=h[o]){t.next=10;break}return I(++f,n.length),t.abrupt("return",1);case 10:return t.prev=10,e.addPage("portrait"),u=new Date(o).toLocaleDateString(window.getCurrentLanguage()),e.setFontSize(14),e.text("".concat(r," - ").concat(u),e.internal.pageSize.getWidth()/2,15,{align:"center"}),s=(0,c.nF)(i),d=s.consumption,p=s.counterValues,y=(0,c.MU)(),t.next=19,E(e,i,20,e.internal.pageSize.getWidth(),a);case 19:b=t.sent,x=y.map((function(t,e){return{label:t,consumption:window.formatNumber(d[e]||"0","",window.getCurrentLanguage(),2),counter:d[e]&&p[e]?window.formatNumber(p[e],"",window.getCurrentLanguage(),2):""}})),D=[{header:window.getTranslatedText("chartExport","hour"),dataKey:"label"},{header:"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(a,")"),dataKey:"consumption"},{header:"".concat(window.getTranslatedText("chartExport","counter")," (").concat(a,")"),dataKey:"counter"}],"function"==typeof e.autoTable?(k=new Date(o).toLocaleDateString(window.getCurrentLanguage(),{year:"numeric",month:"numeric",day:"numeric"}),(g=e.internal.pageSize.getWidth()>e.internal.pageSize.getHeight())?v=9:(b-=40,v=8),e.autoTable({startY:b+10,columns:D,body:x,margin:{left:20,right:20},theme:"grid",headStyles:{fillColor:[0,118,168],textColor:255,fontSize:v},bodyStyles:{fontSize:v},alternateRowStyles:{fillColor:[245,245,245]},didDrawPage:function(t){var n=e.internal.pageSize.getWidth();g&&(e.setFont(void 0,"normal"),e.setFontSize(10),e.setTextColor(0,0,0),e.text("".concat(r," - ").concat(k),n/2,10,{align:"center"}))}})):e.text("Hourly data table could not be generated",20,50),I(++f,n.length),t.next=33;break;case 27:return t.prev=27,t.t0=t.catch(10),I(++f,n.length),t.abrupt("return",1);case 33:case"end":return t.stop()}}),t,null,[[10,27]])})),y.s();case 25:if((w=y.n()).done){t.next=34;break}return t.delegateYield(b(),"t1",27);case 27:if(0!==(x=t.t1)){t.next=30;break}return t.abrupt("break",34);case 30:if(1!==x){t.next=32;break}return t.abrupt("continue",32);case 32:t.next=25;break;case 34:t.next=39;break;case 36:t.prev=36,t.t2=t.catch(22),y.e(t.t2);case 39:return t.prev=39,y.f(),t.finish(39);case 42:case"end":return t.stop()}}),t,null,[[9,15],[22,36,39,42]])}))),k.apply(this,arguments)}function E(t,e,n,r){return S.apply(this,arguments)}function S(){return S=f(l().mark((function t(e,n,r,a){var i,u=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.length>4&&void 0!==u[4]?u[4]:"kWh",t.abrupt("return",new Promise((function(t,u){try{var l=(0,c.nF)(n),s=l.consumption,d=l.counterValues,p=(0,c.MU)(),h=document.createElement("canvas");h.width=800,h.height=400,document.body.appendChild(h);var f={labels:p,datasets:[{label:window.getTranslatedText("charts","hourlyConsumption"),data:s,backgroundColor:"rgba(54, 162, 235, 0.5)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1,counterValues:d}]},m=o(s),v=window.formatNumber(m.total," kWh",window.getCurrentLanguage(),2),g=window.formatNumber(m.average," kWh",window.getCurrentLanguage(),2),y=window.getTranslatedText("chartStats","total"),w=window.getTranslatedText("charts","hour"),b="".concat(v," ").concat(y," - \xd8 ").concat(g," / ").concat(w);m.average>0&&f.datasets.push({type:"line",label:window.getTranslatedText("chartStats","averageLine"),data:Array(s.length).fill(m.average),borderColor:"rgba(255, 99, 132, 1)",borderWidth:1.5,borderDash:[5,5],pointRadius:0,fill:!1,tension:0}),new Chart(h.getContext("2d"),{type:"bar",data:f,options:{responsive:!0,maintainAspectRatio:!0,scales:{y:{beginAtZero:!0,title:{display:!0,text:i},ticks:{font:{size:44},callback:function(t){return window.formatNumber(t,"",window.getCurrentLanguage(),2)}}},x:{ticks:{font:{size:44}}}},plugins:{legend:{display:!0,position:"top",labels:{font:{size:44}}},title:{display:!0,position:"bottom",text:b,font:{size:44}}},animation:{duration:0}}}),setTimeout((function(){try{var n=h.toDataURL("image/png"),o=a-40,i=o*(h.height/h.width);e.addImage(n,"PNG",20,r,o,i,"","FAST"),document.body.removeChild(h),t(r+i+10+25)}catch(n){e.setFontSize(10),e.text("Error generating hourly chart",20,r+10),document.body.contains(h)&&document.body.removeChild(h),t(r+20)}}),500)}catch(n){e.setFontSize(10),e.text("Error generating hourly chart",20,r+10),t(r+20)}})));case 2:case"end":return t.stop()}}),t)}))),S.apply(this,arguments)}function C(t){var e=0,n=function(){++e>=2&&"function"==typeof t&&t()};if(void 0===window.jspdf&&void 0===window.jsPDF){var r=document.createElement("script");r.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js",r.onload=n,document.head.appendChild(r)}else n();var a=document.createElement("script");a.src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js",a.onload=n,document.head.appendChild(a)}function T(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"kWh",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;try{var i,u=t.labels||[],l=t.datasets||[],s=l.length>0?l[0]:{data:[]},d=s.data||[],p=s.counterValues||[],h=window.getCurrentLanguage(),f="";if(-1===o.zaehlerid)f=window.getTranslatedText("totalConsumption","chartTitle");else{var m=window.decodeChannel(window.getChannelById(o.zaehlerid));f=m&&m.beschreibung||""}if("daily"===n)i=P(u,t.rawDates);else if(o&&o.chartDate){var v=new Date(o.chartDate);i=v.toLocaleDateString(window.getCurrentLanguage())}else i=(new Date).toLocaleDateString(window.getCurrentLanguage());var g=XLSX.utils.book_new(),y=[];if(y.push(["".concat(f," - ").concat("hourly"===n?window.getTranslatedText("charts","hourlyData").replace("{0}",""):window.getTranslatedText("charts","dailyData").replace("{0}",""))]),y.push(["".concat(i)]),y.push([]),"hourly"===n)y.push([window.getTranslatedText("chartExport","hour"),"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(r,")"),"".concat(window.getTranslatedText("chartExport","counter")," (").concat(r,")")]),u.forEach((function(t,e){e<d.length&&y.push([t,window.formatNumber(d[e]||0,"",window.getCurrentLanguage(),3),window.formatNumber(p[e]||0,"",window.getCurrentLanguage(),3)])}));else{y.push([window.getTranslatedText("chartExport","date"),"".concat(window.getTranslatedText("chartExport","consumption")," (").concat(r,")"),"".concat(window.getTranslatedText("chartExport","counter")," (").concat(r,")")]);var w=t.rawDates||[];u.forEach((function(t,e){if(e<d.length){var n,r=w[e]||null;n=r?new Date(r).toLocaleDateString(h,{year:"numeric",month:"2-digit",day:"2-digit"}):_(t,null),y.push([n,window.formatNumber(d[e]||0,"",h,3),window.formatNumber(p[e]||0,"",h,3)])}}))}y.push([]),y.push([window.getTranslatedText("chartStats","statistics")]),y.push(["".concat(window.getTranslatedText("chartStats","total")," (").concat(r,")"),window.formatNumber(e.total||0,"",h,3)]),y.push(["".concat(window.getTranslatedText("chartStats","average")," (").concat(r,")"),window.formatNumber(e.average||0,"",h,3)]);var b=XLSX.utils.aoa_to_sheet(y);if(b["!cols"]=[{wch:18},{wch:18},{wch:18}],XLSX.utils.book_append_sheet(g,b,window.getTranslatedText("chartExport","overviewSheet")),"daily"===n&&t.rawDates&&t.rawDates.length>0&&a)return void L(t.rawDates,f,o.zaehlerid).then((function(t){!function(t,e,n){if(0!==Object.keys(e).length){var r=[];r.push(["".concat(n," - ").concat(window.getTranslatedText("chartExport","detailsSheet"))]),r.push([]);var a=Object.keys(e).sort(),o=[window.getTranslatedText("chartExport","hour")];a.forEach((function(t){var e=_("",t);o.push(e)})),r.push(o),(0,c.MU)().forEach((function(t,n){var o=[t];if(a.length>0&&0===n){var i=a[0];e[i]}a.forEach((function(t){var r=e[t],a=null;if(r)try{var i;if("function"==typeof c.nF)(i=(0,c.nF)(r))&&i.consumption&&void 0!==i.consumption[n]&&(a=i.consumption[n]);else{var u="val_".concat(n+1),l=0===n?"val_start":"val_".concat(n);void 0!==r[u]&&void 0!==r[l]&&(a=r[u]-r[l])<0&&(a=0)}}catch(t){}if(null!=a){var s="function"==typeof window.formatNumber?window.formatNumber(a,"",window.getCurrentLanguage(),2):a.toFixed(2);o.push(s)}else o.push("")})),r.push(o)}));for(var i=XLSX.utils.aoa_to_sheet(r),u=[{wch:15}],l=0;l<a.length;l++)u.push({wch:15});i["!cols"]=u,XLSX.utils.book_append_sheet(t,i,window.getTranslatedText("chartExport","detailsSheet"))}}(g,t,f);var e=O(f,i,"xlsx");XLSX.writeFile(g,e)})).catch((function(t){"".concat(window.getTranslatedText("chartExport","errorExporting")," (details): ").concat(t.message);var e=O(f,i,"xlsx");XLSX.writeFile(g,e)}));new Date;var x=O(f,i,"xlsx");XLSX.writeFile(g,x)}catch(t){window.getTranslatedText("chartExport","errorExporting")}}function L(t,e){return j.apply(this,arguments)}function j(){return j=f(l().mark((function t(e,n){var a,o,i,c,u,h,m,v,g,y,w=arguments;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=w.length>2&&void 0!==w[2]?w[2]:null){t.next=3;break}throw new Error("Could not determine channel ID from name");case 3:if(o={},e&&0!==e.length){t.next=6;break}return t.abrupt("return",o);case 6:return t.prev=6,i=(n=e,function(t){if(Array.isArray(t))return p(t)}(n)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||d(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(),c=i[0],u=i[i.length-1],t.next=13,(0,r.wi)(c,u,a);case 13:(h=t.sent).length,m=s(h);try{for(m.s();!(v=m.n()).done;)(g=v.value).datum&&e.includes(g.datum)&&(o[g.datum]=g)}catch(t){m.e(t)}finally{m.f()}if(Object.keys(o),!((y=e.filter((function(t){return!o[t]}))).length>0)){t.next=25;break}return t.next=25,Promise.all(y.map(function(){var t=f(l().mark((function t(e){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,r.tZ)(a,e);case 3:(n=t.sent)&&(o[e]=n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()));case 25:t.next=32;break;case 27:return t.prev=27,t.t0=t.catch(6),t.next=32,Promise.all(e.map(function(){var t=f(l().mark((function t(e){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,r.tZ)(a,e);case 3:(n=t.sent)&&(o[e]=n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()));case 32:return t.abrupt("return",o);case 34:case"end":return t.stop()}var n}),t,null,[[6,27]])}))),j.apply(this,arguments)}function P(t){if(!t||0===t.length)return window.formatDate(new Date,"date");if(1===t.length)return _(t[0]);var e=_(t[0]),n=_(t[t.length-1]);return"".concat(e," - ").concat(n)}function _(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e&&e.match(/^\d{4}-\d{2}-\d{2}$/)){var n=e.split("-"),r=n[0],a=n[1],o=n[2],i=window.getCurrentLanguage();return new Date(r,a-1,o).toLocaleDateString(i)}var c=t.match(/(\d{1,2})\.(\d{1,2})\.?/);if(c&&c.length>=3){var u=parseInt(c[1],10),l=parseInt(c[2],10)-1,s=(new Date).getFullYear(),d=window.getCurrentLanguage();return new Date(s,l,u).toLocaleDateString(d)}return t}function O(t,e,n){t||(t="channel_data"),e||(e=window.formatDate(new Date,"date")),n||(n="txt");var r=[t,e].map((function(t){return t.replace(/[\\/:*?"<>|]+/g,"_").replace(/\s+/g,"_")})).join("_"),a=n.replace(/^\./,"");return"".concat(r,".").concat(a)}function I(t,e){var n=document.getElementById("pdf-export-progress-container"),r=document.getElementById("pdf-export-progress-bar"),a=document.getElementById("pdf-export-current"),o=document.getElementById("pdf-export-total"),i=document.getElementById("pdf-export-progress-text"),c=document.getElementById("pdf-export-progress-type");if(n&&r&&a&&o){if(n.style.display="block",c&&(c.textContent=window.getTranslatedText("chartExport","processingDay")||"Processing day"),i){var u=window.getTranslatedText("chartExport","processingDay")||"Processing day: {current} / {total}";i.innerHTML=u.replace("{current}",'<span id="pdf-export-current">'.concat(t,"</span>")).replace("{total}",'<span id="pdf-export-total">'.concat(e,"</span>"))}else a.textContent=t,o.textContent=e;var l=Math.round(t/e*100);r.style.width="".concat(l,"%"),r.setAttribute("aria-valuenow",l)}}function N(t,e){var n=document.getElementById("pdf-export-month-progress-container"),r=document.getElementById("pdf-export-month-progress-bar"),a=document.getElementById("pdf-export-month-current"),o=document.getElementById("pdf-export-month-total"),i=document.getElementById("pdf-export-month-progress-text");if(n&&r&&a&&o){if(n.style.display="block",i){var c=window.getTranslatedText("chartExport","processingMonth")||"Processing month: {current} / {total}";i.innerHTML=c.replace("{current}",'<span id="pdf-export-month-current">'.concat(t,"</span>")).replace("{total}",'<span id="pdf-export-month-total">'.concat(e,"</span>"))}else a.textContent=t,o.textContent=e;var u=Math.round(t/e*100);r.style.width="".concat(u,"%"),r.setAttribute("aria-valuenow",u)}}var F=n(121);function z(){z=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),c=new P(r||[]);return a(i,"_invoke",{value:C(t,n,c)}),i}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",v={};function g(){}function y(){}function w(){}var b={};l(b,i,(function(){return this}));var x=Object.getPrototypeOf,D=x&&x(x(_([])));D&&D!==n&&r.call(D,i)&&(b=D);var k=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(a,o,i,c){var u=d(t[a],t,o);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==W(s)&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,a){n(t,r,e,a)}))}return o=o?o.then(a,a):a()}})}function C(e,n,r){var a=p;return function(o,i){if(a===f)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var u=T(c,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=f;var l=d(e,n,r);if("normal"===l.type){if(a=r.done?m:h,l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=m,r.method="throw",r.arg=l.arg)}}}function T(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=d(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function _(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(W(e)+" is not iterable")}return y.prototype=w,a(k,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:y,configurable:!0}),y.displayName=l(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},E(S.prototype),l(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new S(s(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},E(k),l(k,u,"Generator"),l(k,i,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;j(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:_(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function A(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function M(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?A(Object(n),!0).forEach((function(e){V(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function V(t,e,n){return(e=function(t){var e=function(t){if("object"!=W(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==W(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function W(t){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},W(t)}function B(t,e,n,r,a,o,i){try{var c=t[o](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,a)}function H(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){B(o,r,a,i,c,"next",t)}function c(t){B(o,r,a,i,c,"throw",t)}i(void 0)}))}}var U={},R={},Y={};function K(){return(K=H(z().mark((function t(e,a,u){var l,s,d,p,h,f,m,v,g,y,w,b,x,D,k,E,S,C,T,L;return z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"undefined"!=typeof Chart){t.next=11;break}return t.next=4,Promise.resolve().then(n.bind(n,121));case 4:return l=t.sent,s=l.loadChartJs,t.next=8,s();case 8:if(t.sent){t.next=11;break}throw new Error("Failed to load Chart.js");case 11:if(d=document.getElementById(e)){t.next=15;break}return t.abrupt("return",null);case 15:if(null!=a){t.next=17;break}throw new Error("zaehlerid must be provided");case 17:if(p=Number(a),!isNaN(p)){t.next=21;break}throw new Error("Invalid zaehlerid: ".concat(a));case 21:if(-1!==p){t.next=28;break}return t.next=25,(0,r.WL)(u);case 25:h=t.sent,t.next=32;break;case 28:return t.next=31,(0,r.tZ)(a,u);case 31:h=t.sent;case 32:if(h){t.next=36;break}return(0,c.a1)(d),t.abrupt("return",null);case 36:return f=(0,c.MU)(),m=(0,c.nF)(h),v=m.consumption,g=m.counterValues,y=o(v),w=window.formatNumber(y.total," kWh",window.getCurrentLanguage(),2),b=window.formatNumber(y.average," kWh",window.getCurrentLanguage(),2),x=window.getTranslatedText("chartStats","total"),D=window.getTranslatedText("charts","hour"),k="".concat(w," ").concat(x," - \xd8 ").concat(b," / ").concat(D),d.innerHTML='\n            <canvas id="'.concat(e,'-canvas"></canvas>\n        '),E=document.getElementById("".concat(e,"-canvas")),S={labels:f,datasets:[(0,c.lN)("hourly",v,g)]},y.average>0&&(C=i(y,v.length),S.datasets.push(C.averageLine)),R[e]=S,Y[e]=y,T=E.getContext("2d"),L=new Chart(T,{type:"bar",data:S,options:M(M({},(0,c.Ah)()),{},{responsive:!0,plugins:M(M({},(0,c.Ah)().plugins),{},{title:{display:!0,position:"bottom",text:k}}),layout:{padding:{top:10,right:25,bottom:10,left:10}},animation:{duration:0},resizeDelay:0})}),U[e]=L,L.zaehlerid=a,L.chartDate=u,t.abrupt("return",L);case 58:return t.prev=58,t.t0=t.catch(0),t.abrupt("return",null);case 62:case"end":return t.stop()}}),t,null,[[0,58]])})))).apply(this,arguments)}function Z(t,e,n,r){return q.apply(this,arguments)}function q(){return q=H(z().mark((function t(e,a,u,l){var s,d,p,h,f,m,v,g,y,w,b,x,D,k,E,S,C,T,L,j,P,_,O,I,N,F,A,V,G,W=arguments;return z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=W.length>4&&void 0!==W[4]?W[4]:[],d=W.length>5&&void 0!==W[5]&&W[5],p=W.length>6&&void 0!==W[6]?W[6]:"",t.prev=3,"undefined"!=typeof Chart){t.next=14;break}return t.next=7,Promise.resolve().then(n.bind(n,121));case 7:return h=t.sent,f=h.loadChartJs,t.next=11,f();case 11:if(t.sent){t.next=14;break}throw new Error("Failed to load Chart.js");case 14:if(-1!==a){t.next=18;break}return t.next=17,Q(e,u,l);case 17:return t.abrupt("return",t.sent);case 18:return t.next=20,(0,r.wi)(u,l,a);case 20:if(m=t.sent,v=document.getElementById(e)){t.next=24;break}return t.abrupt("return",null);case 24:if(0!==m.length){t.next=28;break}return(0,c.a1)(v),t.abrupt("return",null);case 28:for(g={},y={},m.forEach((function(t){g[t.datum]=t.usage_day||0,y[t.datum]=t.val_end||0})),w=new Date(u),(b=new Date(l)).setHours(23,59,59);w<=b;)x=w.toISOString().split("T")[0],g[x]||(g[x]=0),y[x]||((D=new Date(w)).setDate(D.getDate()-1),k=D.toISOString().split("T")[0],y[x]=y[k]||0),w.setDate(w.getDate()+1);if(E=Object.keys(g).sort(),S=E.map((function(t){return g[t]})),C=E.map((function(t){return y[t]})),T=(0,c.yC)(E),L=o(S),j=window.formatNumber(L.total," kWh",window.getCurrentLanguage(),2),P=window.formatNumber(L.average," kWh",window.getCurrentLanguage(),2),_=window.getTranslatedText("chartStats","total"),O=window.getTranslatedText("charts","day"),I="".concat(j," ").concat(_," - \xd8 ").concat(P," / ").concat(O),v.innerHTML='\n            <canvas id="'.concat(e,'-canvas"></canvas>\n        '),N=document.getElementById("".concat(e,"-canvas"))){t.next=49;break}return t.abrupt("return",null);case 49:return F={labels:T,datasets:[(0,c.lN)("daily",S,C)],rawDates:E},L.average>0&&(A=i(L,S.length),F.datasets.push(A.averageLine)),F.rawDates=E,R[e]=F,Y[e]=L,V=N.getContext("2d"),(G=new Chart(V,{type:"bar",data:F,options:M(M({},(0,c.Ah)()),{},{responsive:!0,plugins:M(M({},(0,c.Ah)().plugins),{},{title:{display:!0,position:"bottom",text:I}}),onClick:d?function(t,e){if("click"===t.type&&e&&1===e.length){var n=e[0].index,r=E[n];s.includes(r)&&ut(a,p,r,s)}}:void 0,layout:{padding:{top:10,right:25,bottom:10,left:10}},animation:{duration:0},resizeDelay:0})})).zaehlerid=a,U[e]=G,G.zaehlerid=a,t.abrupt("return",G);case 62:return t.prev=62,t.t0=t.catch(3),t.abrupt("return",null);case 66:case"end":return t.stop()}}),t,null,[[3,62]])}))),q.apply(this,arguments)}function X(t,e,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(null!=t){var o=Number(t);if(!isNaN(o)){if(!n){var i=new Date;n="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(String(i.getDate()).padStart(2,"0"))}var u=null;if(a&&(u=document.getElementById(a))){var l=bootstrap.Modal.getInstance(u);l&&l.hide()}var s="hourly-data-modal-".concat(t),d="hourly-data-chart-".concat(t),p=document.getElementById(s);p&&p.remove();var h=new Date(n).toLocaleDateString(window.getCurrentLanguage()),f=(0,c.rJ)({modalId:s,chartId:d,title:window.getTranslatedText("charts","hourlyData").replace("{0}","".concat(e," (").concat(h,")")),isHourly:!0,hasParent:!!a});if(document.body.insertAdjacentHTML("beforeend",f),p=document.getElementById(s),function(t,e,n){K.apply(this,arguments)}(d,t,n),a&&u){var m=document.getElementById("back-to-daily-btn");m&&m.addEventListener("click",(function(){var t=p.querySelector(".btn-close");t&&t.click()}))}new bootstrap.Modal(p).show(),p.addEventListener("hidden.bs.modal",(function(){if(a){var t=document.getElementById(a);t&&new bootstrap.Modal(t).show()}}))}}}function J(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=new Date;if(r||(r="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(String(i.getDate()).padStart(2,"0"))),!n){var u=new Date(i);u.setDate(i.getDate()-6),n="".concat(u.getFullYear(),"-").concat(String(u.getMonth()+1).padStart(2,"0"),"-").concat(String(u.getDate()).padStart(2,"0"))}var l="daily-consumption-modal-".concat(t),s="daily-consumption-chart-".concat(t),d=document.getElementById(l);d&&d.remove();var p=(0,c.rJ)({modalId:l,chartId:s,title:window.getTranslatedText("charts","dailyData").replace("{0}",e),isHourly:!1,hasParent:!1,startDate:n,endDate:r,showClickInstructions:o});document.body.insertAdjacentHTML("beforeend",p),d=document.getElementById(l),Z(s,t,n,r,a,o,e);var h,f=window.safeParseDate(n),m=window.safeParseDate(r),v=(h=a,function(t){if(Array.isArray(t))return G(t)}(h)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(h)||function(t,e){if(t){if("string"==typeof t)return G(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(t,e):void 0}}(h)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).sort(),g=v.length>0?v[0]:null,y=(0,F.initDatePicker)("".concat(l,"-start-datepicker"),f,a,g,null),w=(0,F.initDatePicker)("".concat(l,"-end-datepicker"),m,a,g,null);[document.getElementById("".concat(l,"-start-datepicker")),document.getElementById("".concat(l,"-end-datepicker"))].forEach((function(t){if(t&&(t.classList.add("force-visible"),!t.querySelector(".tempus-dominus-widget"))){var e=t.id.includes("start")?f:m;(0,F.initDatePicker)(t.id,e,a,g,null)}}));var b=new Set(a);(0,F.highlightAvailableDates)("".concat(l,"-start-datepicker"),b),(0,F.highlightAvailableDates)("".concat(l,"-end-datepicker"),b);var x=null,D=null,k=function(){var n=document.getElementById("".concat(l,"-start-date")).value,r=document.getElementById("".concat(l,"-end-date")).value;n&&r&&(n===x&&r===D||(x=n,D=r,Z(s,t,n,r,a,o,e)))};y.subscribe(tempusDominus.Namespace.events.update,(function(t){(0,F.highlightAvailableDates)("".concat(l,"-start-datepicker"),b)})),y.subscribe(tempusDominus.Namespace.events.change,(function(t){try{var e=(0,F.formatDateFromPicker)(t);e&&(document.getElementById("".concat(l,"-start-date")).value=e,e>document.getElementById("".concat(l,"-end-date")).value&&(document.getElementById("".concat(l,"-end-date")).value=e,t.date&&w.dates.setValue(t.date)),k())}catch(t){}})),w.subscribe(tempusDominus.Namespace.events.update,(function(t){(0,F.highlightAvailableDates)("".concat(l,"-end-datepicker"),b)})),w.subscribe(tempusDominus.Namespace.events.change,(function(t){try{var e=(0,F.formatDateFromPicker)(t);e&&(document.getElementById("".concat(l,"-end-date")).value=e,e<document.getElementById("".concat(l,"-start-date")).value&&(document.getElementById("".concat(l,"-start-date")).value=e,t.date&&y.dates.setValue(t.date)),k())}catch(t){}})),new bootstrap.Modal(d).show()}function $(){return($=H(z().mark((function t(){var e,n,a,o,i,c,u,l;return z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e=new Date,n="".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0")),t.next=5,(0,r.Bc)();case 5:if((a=t.sent)&&0!==a.length){t.next=9;break}return window.getTranslatedText("totalConsumption","noDataAvailable"),t.abrupt("return");case 9:return o=a[0],(i=new Date(e)).setDate(e.getDate()-29),c=new Date(o+"T00:00:00"),i<c&&(i=new Date(c)),u="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(String(i.getDate()).padStart(2,"0")),t.next=17,(0,r.ut)(u,n);case 17:if((l=t.sent)&&0!==l.length){t.next=21;break}return window.getTranslatedText("totalConsumption","noDataAvailable"),t.abrupt("return");case 21:l.sort((function(t,e){return t.date.localeCompare(e.date)})),J(-1,window.getTranslatedText("totalConsumption","chartTitle"),u,n,a,!0),t.next=31;break;case 27:t.prev=27,t.t0=t.catch(0),window.getTranslatedText("totalConsumption","errorLoadingChart");case 31:case"end":return t.stop()}}),t,null,[[0,27]])})))).apply(this,arguments)}function Q(t,e,n){return tt.apply(this,arguments)}function tt(){return(tt=H(z().mark((function t(e,a,u){var l,s,d,p,h,f,m,v,g,y,w,b,x,D,k,E,S,C;return z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"undefined"!=typeof Chart){t.next=11;break}return t.next=4,Promise.resolve().then(n.bind(n,121));case 4:return l=t.sent,s=l.loadChartJs,t.next=8,s();case 8:if(t.sent){t.next=11;break}throw new Error("Failed to load Chart.js");case 11:if(d=document.getElementById(e)){t.next=14;break}return t.abrupt("return",null);case 14:return t.next=16,(0,r.ut)(a,u);case 16:if(0!==(p=t.sent).length){t.next=21;break}return(0,c.a1)(d),t.abrupt("return",null);case 21:if(p.sort((function(t,e){return t.date.localeCompare(e.date)})),h=p.map((function(t){return t.date})),f=p.map((function(t){return t.totalConsumption})),m=(0,c.yC)(h),v=o(f),g=window.formatNumber(v.total," kWh",window.getCurrentLanguage(),2),y=window.formatNumber(v.average," kWh",window.getCurrentLanguage(),2),w=window.getTranslatedText("chartStats","total"),b=window.getTranslatedText("charts","day"),x="".concat(g," ").concat(w," - \xd8 ").concat(y," / ").concat(b),d.innerHTML='\n            <canvas id="'.concat(e,'-canvas"></canvas>\n        '),D=document.getElementById("".concat(e,"-canvas"))){t.next=35;break}return t.abrupt("return",null);case 35:return k={labels:m,datasets:[{label:window.getTranslatedText("totalConsumption","totalDailyConsumption"),data:f,backgroundColor:"rgba(75, 192, 192, 0.5)",borderColor:"rgba(75, 192, 192, 1)",borderWidth:1}],rawDates:h},v.average>0&&(E=i(v,f.length),k.datasets.push(E.averageLine)),R[e]=k,Y[e]=v,S=D.getContext("2d"),(C=new Chart(S,{type:"bar",data:k,options:M(M({},(0,c.Ah)()),{},{responsive:!0,plugins:M(M({},(0,c.Ah)().plugins),{},{title:{display:!0,position:"bottom",text:x}}),onClick:function(t,e){if("click"===t.type&&e&&1===e.length){var n=e[0].index;et(-1,h[n],h)}},layout:{padding:{top:10,right:25,bottom:10,left:10}},animation:{duration:0},resizeDelay:0})})).zaehlerid=-1,C.chartDate=null,C.chartTitle=window.getTranslatedText("totalConsumption","chartTitle"),U[e]=C,R[e]=k,Y[e]=v,t.abrupt("return",C);case 50:return t.prev=50,t.t0=t.catch(0),t.abrupt("return",null);case 54:case"end":return t.stop()}}),t,null,[[0,50]])})))).apply(this,arguments)}function et(t,e,n,r){try{var a=window.getTranslatedText("totalConsumption","chartTitle"),o="daily-consumption-modal-".concat(t),i=document.getElementById(o);if(i){var c=bootstrap.Modal.getInstance(i);c&&c.hide()}X(-1,a,e,n,o)}catch(t){window.getTranslatedText("totalConsumption","errorLoadingChart")}}function nt(t){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(t)}function rt(){rt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function s(t,e,n,r){var o=e&&e.prototype instanceof g?e:g,i=Object.create(o.prototype),c=new P(r||[]);return a(i,"_invoke",{value:C(t,n,c)}),i}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=s;var p="suspendedStart",h="suspendedYield",f="executing",m="completed",v={};function g(){}function y(){}function w(){}var b={};l(b,i,(function(){return this}));var x=Object.getPrototypeOf,D=x&&x(x(_([])));D&&D!==n&&r.call(D,i)&&(b=D);var k=w.prototype=g.prototype=Object.create(b);function E(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(a,o,i,c){var u=d(t[a],t,o);if("throw"!==u.type){var l=u.arg,s=l.value;return s&&"object"==nt(s)&&r.call(s,"__await")?e.resolve(s.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(s).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(u.arg)}var o;a(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,a){n(t,r,e,a)}))}return o=o?o.then(a,a):a()}})}function C(e,n,r){var a=p;return function(o,i){if(a===f)throw Error("Generator is already running");if(a===m){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var u=T(c,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===p)throw a=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=f;var l=d(e,n,r);if("normal"===l.type){if(a=r.done?m:h,l.arg===v)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=m,r.method="throw",r.arg=l.arg)}}}function T(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=d(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function _(e){if(e||""===e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(nt(e)+" is not iterable")}return y.prototype=w,a(k,"constructor",{value:w,configurable:!0}),a(w,"constructor",{value:y,configurable:!0}),y.displayName=l(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,l(t,u,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},E(S.prototype),l(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new S(s(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},E(k),l(k,u,"Generator"),l(k,i,(function(){return this})),l(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=_,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;j(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:_(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function at(t,e,n,r,a,o,i){try{var c=t[o](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,a)}document.addEventListener("click",(function(t){!function(t,e,n,r){var a,o,i=t.target.closest("[data-export-action]");if(i){t.preventDefault();var c=i.getAttribute("data-chart-id"),u="true"===i.getAttribute("data-include-daily"),l=i.getAttribute("data-export-action"),s=e[c],d=n[c],p=r[c];if(s){var h=c.includes("hourly")?"hourly":"daily",f="kWh";switch(l){case"excel":d&&T(d,p,h,f,u,s);break;case"excel-daily":d&&T(d,p,h,f,!0,s);break;case"pdf":g(s,(null===(a=s.options.plugins.title)||void 0===a?void 0:a.text)||"Chart",p,h,f,u);break;case"pdf-daily":g(s,(null===(o=s.options.plugins.title)||void 0===o?void 0:o.text)||"Chart",p,h,f,!0)}}}}(t,U,R,Y)})),window.showTotalConsumptionChart=function(){return $.apply(this,arguments)};var ot=!1;function it(){ot||(ot=!0,document.addEventListener("click",(function(t){var e=t.target.closest('a[data-translation-key="actions.history"]');if(e){t.preventDefault();var n=e.closest('tr[id^="chn"]'),r=e.closest('div[id^="mobile-chn"]'),a=null;if(n?a=n.id.replace("chn",""):r&&(a=r.id.replace("mobile-chn","")),a){var o=window.getChannelById(a);o&&function(t,e){ct.apply(this,arguments)}(a,window.decodeChannel(o).beschreibung)}}})))}function ct(){var t;return t=rt().mark((function t(e,a){var o,i,c,u,l,s,d,p,h,f,m;return rt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o="daily-consumption-modal-".concat(e),!(i=document.getElementById(o))){t.next=7;break}return(c=bootstrap.Modal.getInstance(i))?c.show():new bootstrap.Modal(i).show(),t.abrupt("return");case 7:if("undefined"!=typeof Chart){t.next=18;break}return t.next=10,Promise.resolve().then(n.bind(n,121));case 10:return u=t.sent,l=u.loadChartJs,t.next=14,l();case 14:if(t.sent){t.next=18;break}return t.abrupt("return");case 18:if(s=Number(e),!isNaN(s)){t.next=22;break}return t.abrupt("return");case 22:return d=new Date,p="".concat(d.getFullYear(),"-").concat(String(d.getMonth()+1).padStart(2,"0"),"-").concat(String(d.getDate()).padStart(2,"0")),(h=new Date(d)).setDate(d.getDate()-6),f="".concat(h.getFullYear(),"-").concat(String(h.getMonth()+1).padStart(2,"0"),"-").concat(String(h.getDate()).padStart(2,"0")),m=[],t.prev=28,t.next=31,(0,r.kC)(s);case 31:m=t.sent,t.next=38;break;case 35:t.prev=35,t.t0=t.catch(28);case 38:J(s,a,f,p,m,!0);case 39:case"end":return t.stop()}}),t,null,[[28,35]])})),ct=function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){at(o,r,a,i,c,"next",t)}function c(t){at(o,r,a,i,c,"throw",t)}i(void 0)}))},ct.apply(this,arguments)}function ut(t,e,n,r){X(t,e,n,r,"daily-consumption-modal-".concat(t))}},690:(t,e,n)=>{n.d(e,{Bc:()=>ot,Qm:()=>T,WL:()=>L,kC:()=>V,tZ:()=>A,ut:()=>at,wi:()=>M});var r=n(313);function a(t){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function o(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=c(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,a=function(){};return{s:a,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){u=!0,o=t},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function i(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||c(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){if(t){if("string"==typeof t)return u(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function l(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function s(t,e,n){return(e=function(t){var e=function(t){if("object"!=a(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==a(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(){d=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function s(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var a=e&&e.prototype instanceof w?e:w,i=Object.create(a.prototype),c=new O(r||[]);return o(i,"_invoke",{value:L(t,n,c)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var f="suspendedStart",m="suspendedYield",v="executing",g="completed",y={};function w(){}function b(){}function x(){}var D={};s(D,c,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(I([])));E&&E!==n&&r.call(E,c)&&(D=E);var S=x.prototype=w.prototype=Object.create(D);function C(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(o,i,c,u){var l=h(t[o],t,i);if("throw"!==l.type){var s=l.arg,d=s.value;return d&&"object"==a(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,c,u)}),(function(t){n("throw",t,c,u)})):e.resolve(d).then((function(t){s.value=t,c(s)}),(function(t){return n("throw",t,c,u)}))}u(l.arg)}var i;o(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,a){n(t,r,e,a)}))}return i=i?i.then(a,a):a()}})}function L(e,n,r){var a=f;return function(o,i){if(a===v)throw Error("Generator is already running");if(a===g){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var u=j(c,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===f)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var l=h(e,n,r);if("normal"===l.type){if(a=r.done?g:m,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=g,r.method="throw",r.arg=l.arg)}}}function j(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,j(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function I(e){if(e||""===e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(a(e)+" is not iterable")}return b.prototype=x,o(S,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:b,configurable:!0}),b.displayName=s(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,s(t,l,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},C(T.prototype),s(T.prototype,u,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new T(p(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},C(S),s(S,l,"Generator"),s(S,c,(function(){return this})),s(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;_(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function p(t,e,n,r,a,o,i){try{var c=t[o](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,a)}function h(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){p(o,r,a,i,c,"next",t)}function c(t){p(o,r,a,i,c,"throw",t)}i(void 0)}))}}var f,m,v="ctoolsHourlyDataV2",g=3,y="hourlyReadings",w="ctoolsHourlyDataSyncVersion",b="1.0.1",x=1e4,D="ctoolsLastHourlyPoll",k="ctoolsTotalConsumption",E=2,S="dailyAggregates",C=!1;function T(){if(!C){C=!0;var t=indexedDB.deleteDatabase("ctoolsHourlyData");t.onsuccess=function(){},t.onerror=function(t){},t.onblocked=function(){};var e=indexedDB.open(v,g);e.onerror=function(t){},e.onupgradeneeded=function(t){var e=t.target.result;if(1===t.oldVersion&&e.objectStoreNames.contains(y)&&e.deleteObjectStore(y),!e.objectStoreNames.contains(y)){var n=e.createObjectStore(y,{keyPath:"dsid"});n.createIndex("zaehlerid","zaehlerid",{unique:!1}),n.createIndex("datum","datum",{unique:!1}),n.createIndex("zaehlerid_datum",["zaehlerid","datum"],{unique:!1}),n.createIndex("complete_status","complete_status",{unique:!1})}},e.onsuccess=function(t){m=t.target.result,localStorage.getItem(w)!==b&&localStorage.setItem(w,b),new Promise((function(t,e){var n=indexedDB.open(k,E);n.onerror=function(t){e(t.target.error)},n.onupgradeneeded=function(t){var e=t.target.result;if(!e.objectStoreNames.contains(S)){var n=e.createObjectStore(S,{keyPath:"date"});n.createIndex("date","date",{unique:!0}),n.createIndex("complete_status","complete_status",{unique:!1});for(var r=0;r<24;r++){var a="usage_".concat(r.toString().padStart(2,"0"));n.createIndex(a,a,{unique:!1})}}},n.onsuccess=function(e){f=e.target.result,t(!0)}})).then((function(){return new Promise((function(t){if(f)try{var e=f.transaction([S],"readonly").objectStore(S).count();e.onsuccess=function(e){e.target.result,t(!0)},e.onerror=function(e){t(!1)}}catch(e){t(!1)}else t(!1)}))})).then((function(t){t?(O(),Q(),z()):(O(),z())})).catch((function(t){O(),z()}))}}}function L(t){return j.apply(this,arguments)}function j(){return(j=h(d().mark((function t(e){var n,r,a,o,i;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(f){t.next=3;break}return t.abrupt("return",null);case 3:return t.prev=3,t.next=6,rt(e);case 6:if(n=t.sent){t.next=10;break}return t.abrupt("return",null);case 10:for(r={datum:e,zaehlerid:-1,usage_day:n.totalConsumption||0,complete_status:n.complete_status||0},a=0;a<24;a++)o="usage_".concat(a.toString().padStart(2,"0")),i=n[o]||0,r[o]=i;return t.abrupt("return",r);case 15:return t.prev=15,t.t0=t.catch(3),t.abrupt("return",null);case 19:case"end":return t.stop()}}),t,null,[[3,15]])})))).apply(this,arguments)}function P(){return _.apply(this,arguments)}function _(){return(_=h(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){try{var n=function(){var e=new Date,n="".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(e.getDate()).padStart(2,"0"));if(null!==o){var u=r.index("datum").openCursor(IDBKeyRange.upperBound(n,!0),"prev");u.onsuccess=function(e){var n=e.target.result;n&&(o=n.value.dsid),t({oldestDsid:a,newestDsid:o,oldestIncompleteDsid:i,highestCompleteDsid:c})},u.onerror=function(e){t({oldestDsid:a,newestDsid:o,oldestIncompleteDsid:i,highestCompleteDsid:c})}}else t({oldestDsid:a,newestDsid:o,oldestIncompleteDsid:i,highestCompleteDsid:c})};if(!m)return void e(new Error("Database not initialized"));var r=m.transaction([y],"readonly").objectStore(y),a=null,o=null,i=null,c=null;r.openCursor(null,"next").onsuccess=function(e){var u=e.target.result;if(u){a=u.value.dsid;var l=r.openCursor(null,"prev");l.onsuccess=function(e){var u=e.target.result;if(u){o=u.value.dsid;var l=r.index("complete_status"),s=l.openCursor(IDBKeyRange.only(0),"next");s.onsuccess=function(t){var e=t.target.result;e&&(i=e.value.dsid);var r=l.openCursor(IDBKeyRange.only(1),"prev");r.onsuccess=function(t){var e=t.target.result;e&&(c=e.value.dsid),n()},r.onerror=function(t){n()}},s.onerror=function(t){n()}}else t({oldestDsid:a,newestDsid:null,oldestIncompleteDsid:null,highestCompleteDsid:null})},l.onerror=function(e){t({oldestDsid:a,newestDsid:null,oldestIncompleteDsid:null,highestCompleteDsid:null})}}else t({oldestDsid:null,newestDsid:null,oldestIncompleteDsid:null,highestCompleteDsid:null})}}catch(t){e(t)}})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function O(){return new Promise(function(){var e=h(d().mark((function e(r,a){var o,i,c,u,l,s;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,P();case 3:return o=e.sent,i=o.oldestDsid,c=o.newestDsid,u=o.oldestIncompleteDsid,l=o.highestCompleteDsid,e.next=10,t(u,l,c);case 10:return e.next=12,P();case 12:if(s=e.sent,!(null!==(i=s.oldestDsid)&&i>1)){e.next=19;break}return e.next=17,n(i);case 17:e.next=19;break;case 19:localStorage.setItem(D,Date.now().toString()),r(!0),e.next=27;break;case 23:e.prev=23,e.t0=e.catch(0),a(e.t0);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t,n){return e.apply(this,arguments)}}());function t(t,n,r){return e.apply(this,arguments)}function e(){return(e=h(d().mark((function t(e,n,r){var o;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=null!==e?e-1:null!==n?n:r,t.next=4,a("newestDsid",o,!0);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function n(t){return r.apply(this,arguments)}function r(){return(r=h(d().mark((function t(e){var n;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e,t.next=4,a("oldestDsid",n,!1);case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function a(t,e,n){return o.apply(this,arguments)}function o(){return(o=h(d().mark((function t(e,n,r){var a,o,i,c;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a={action:"hourlyData",limit:x},null!==n&&(a[e]=n),o=!1,i=0,c=d().mark((function t(){var e,n,c,u,l,s,p,h;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("index.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams(a)});case 2:if((n=t.sent).ok){t.next=5;break}throw new Error("HTTP error: ".concat(n.status));case 5:return t.next=7,n.json();case 7:if(c=t.sent,u=c.data||[],o=(null===(e=c.meta)||void 0===e?void 0:e.has_more)||!1,0!==u.length){t.next=12;break}return t.abrupt("return",1);case 12:return l=new Date,s="".concat(l.getFullYear(),"-").concat(String(l.getMonth()+1).padStart(2,"0"),"-").concat(String(l.getDate()).padStart(2,"0")),t.next=16,I(u,s);case 16:return i+=u.length,t.next=19,N();case 19:o&&(p=0,h=Number.MAX_SAFE_INTEGER,u.forEach((function(t){t[0]>p&&(p=t[0]),t[0]<h&&(h=t[0])})),a={action:"hourlyData",limit:x},r?a.newestDsid=p:a.oldestDsid=h);case 20:case"end":return t.stop()}}),t)}));case 5:return t.delegateYield(c(),"t0",6);case 6:if(!t.t0){t.next=8;break}return t.abrupt("break",9);case 8:if(o){t.next=5;break}case 9:if(!(i>0)){t.next=18;break}return t.prev=10,t.next=13,Q();case 13:t.next=18;break;case 15:t.prev=15,t.t1=t.catch(10);case 18:localStorage.setItem(D,Date.now().toString());case 19:case"end":return t.stop()}}),t,null,[[10,15]])})))).apply(this,arguments)}}function I(t,e){return new Promise((function(n,r){try{if(!m)return void r(new Error("Database not initialized"));var a=m.transaction([y],"readwrite"),o=a.objectStore(y);a.onerror=function(t){r(t.target.error)},a.oncomplete=function(){n()},t.forEach((function(t){try{var n=Number(t[0]),r=Number(t[1]),a=String(t[2]),i=e&&a<e?1:0,c={dsid:n,zaehlerid:r,datum:a,val_start:null!==t[3]?Number(t[3]):0,val_0:null!==t[4]?Number(t[4]):0,val_1:null!==t[5]?Number(t[5]):0,val_2:null!==t[6]?Number(t[6]):0,val_3:null!==t[7]?Number(t[7]):0,val_4:null!==t[8]?Number(t[8]):0,val_5:null!==t[9]?Number(t[9]):0,val_6:null!==t[10]?Number(t[10]):0,val_7:null!==t[11]?Number(t[11]):0,val_8:null!==t[12]?Number(t[12]):0,val_9:null!==t[13]?Number(t[13]):0,val_10:null!==t[14]?Number(t[14]):0,val_11:null!==t[15]?Number(t[15]):0,val_12:null!==t[16]?Number(t[16]):0,val_13:null!==t[17]?Number(t[17]):0,val_14:null!==t[18]?Number(t[18]):0,val_15:null!==t[19]?Number(t[19]):0,val_16:null!==t[20]?Number(t[20]):0,val_17:null!==t[21]?Number(t[21]):0,val_18:null!==t[22]?Number(t[22]):0,val_19:null!==t[23]?Number(t[23]):0,val_20:null!==t[24]?Number(t[24]):0,val_21:null!==t[25]?Number(t[25]):0,val_22:null!==t[26]?Number(t[26]):0,val_23:null!==t[27]?Number(t[27]):0,val_end:null!==t[28]?Number(t[28]):0,usage_day:null!==t[29]?Number(t[29]):0,complete_status:i};o.put(c)}catch(t){}}))}catch(t){r(t)}}))}function N(){return F.apply(this,arguments)}function F(){return(F=h(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){try{if(!m)return void t();var n=m.transaction([y],"readonly").objectStore(y).index("complete_status").getAll(IDBKeyRange.only(0));n.onsuccess=function(e){var n=e.target.result||[];if(n.length>0&&(n.sort((function(t,e){return t.dsid-e.dsid})),n.map((function(t){return{dsid:t.dsid,date:t.datum,zaehlerid:t.zaehlerid}})),n.length>20)){var r={};n.forEach((function(t){r[t.datum]=(r[t.datum]||0)+1}))}t()},n.onerror=function(e){t()}}catch(e){t()}})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function z(){var t=function(){var e=new Date,n=60*(60-e.getMinutes()-1)*1e3+1e3*(60-e.getSeconds())+(1e3-e.getMilliseconds())+(6e4+Math.floor(12e4*Math.random()));Math.floor(n/6e4),Math.floor(n%6e4/1e3),setTimeout((function(){O().then((function(){t()})).catch((function(e){t()}))}),n)},e=function(){var t=localStorage.getItem(D),e=new Date;t?(e-new Date(parseInt(t,10)))/36e5>1.5&&O():O()};e(),t(),document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&e()})),setInterval(e,9e5)}function A(t,e){return new Promise((function(n,r){try{var a=function(){var t=i.index("zaehlerid").getAll(o);t.onsuccess=function(t){var r=t.target.result.find((function(t){return t.datum===e}));n(r||null)},t.onerror=function(t){r(t.target.error)}};if(!m)return void r(new Error("Database not initialized"));if(null==t)return void r(new Error("zaehlerid must be provided"));var o=Number(t);if(isNaN(o))return void r(new Error("Invalid zaehlerid: ".concat(t)));var i=m.transaction([y],"readonly").objectStore(y);if(i.indexNames.contains("zaehlerid_datum")){var c=i.index("zaehlerid_datum"),u=[o,e],l=c.get(u);l.onsuccess=function(t){var e=t.target.result;n(e||null)},l.onerror=function(t){a()}}else a()}catch(t){r(t)}}))}function M(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(r,a){try{var o=function(){if(null!==n&&"number"==typeof n){var a=u.index("zaehlerid").getAll(n);a.onsuccess=function(n){var a=(n.target.result||[]).filter((function(n){return n.datum>=t&&n.datum<=e}));r(a)},a.onerror=function(t){i()}}else i()},i=function(){var o=u.index("datum"),i=IDBKeyRange.bound(t,e),c=o.getAll(i);c.onsuccess=function(t){var e=t.target.result||[],a=null!==n&&"number"==typeof n?e.filter((function(t){return t.zaehlerid===n})):e;r(a)},c.onerror=function(t){a(t.target.error)}};if(!m)return void a(new Error("db_not_init"));if(!t||!e)return void a(new Error("supply_start_and_end_date"));if(!/^\d{4}-\d{2}-\d{2}$/.test(t)||!/^\d{4}-\d{2}-\d{2}$/.test(e))return void a(new Error("date_mismatch"));if(t>e){var c=[e,t];t=c[0],e=c[1]}var u=m.transaction([y],"readonly").objectStore(y);if(null!==n&&"number"==typeof n)if(u.indexNames.contains("zaehlerid_datum")){var l=u.index("zaehlerid_datum"),s=[],d=[n,t],p=[n,e],h=IDBKeyRange.bound(d,p),f=l.openCursor(h);f.onsuccess=function(t){var e=t.target.result;e?(s.push(e.value),e.continue()):r(s)},f.onerror=function(t){o()}}else o();else o()}catch(t){a(t)}}))}function V(t){return new Promise((function(e,n){try{if(!m)return void n(new Error("Database not initialized"));if(null==t)return void n(new Error("zaehlerid must be provided"));var r=Number(t);if(isNaN(r))return void n(new Error("Invalid zaehlerid: ".concat(t)));var a=m.transaction([y],"readonly").objectStore(y).index("zaehlerid").getAll(r);a.onsuccess=function(t){var n=t.target.result,r=new Set;n.forEach((function(t){t.datum&&r.add(t.datum)}));var a=Array.from(r).sort();e(a)},a.onerror=function(t){n(t.target.error)}}catch(t){n(t)}}))}function G(t){return W.apply(this,arguments)}function W(){return(W=h(d().mark((function t(e){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){if(m)try{var r=m.transaction([y],"readonly").objectStore(y).index("datum").getAll(IDBKeyRange.only(e));r.onsuccess=function(e){var n=e.target.result||[],r=i(new Set(n.map((function(t){return t.zaehlerid}))));t(r)},r.onerror=function(e){t([])}}catch(e){t([])}else n(new Error("Hourly database not initialized"))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function B(t){return H.apply(this,arguments)}function H(){return H=h(d().mark((function t(e){var n,r,a,o,i,c,u,l=arguments;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:[],f){t.next=4;break}return t.abrupt("return");case 4:return t.prev=4,t.next=7,K(e,n);case 7:if(r=t.sent,0!==Object.keys(r).length){t.next=10;break}return t.abrupt("return");case 10:return a=R(r),o=U(r),i=new Date,c="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(String(i.getDate()).padStart(2,"0")),u=e<c?1:0,t.next=17,Y(e,a,o,u,Object.keys(r).length);case 17:t.next=22;break;case 19:t.prev=19,t.t0=t.catch(4);case 22:case"end":return t.stop()}}),t,null,[[4,19]])}))),H.apply(this,arguments)}function U(t){for(var e={},n=0;n<24;n++){var a="usage_".concat(n.toString().padStart(2,"0"));e[a]=0}for(var o in t){var i=t[o];i&&(0,r.nF)(i).consumption.forEach((function(t,n){if(n<24&&!isNaN(t)){var r="usage_".concat(n.toString().padStart(2,"0"));e[r]+=t}}))}return e}function R(t){var e=0;for(var n in t){var r=t[n];r&&r.usage_day&&(e+=Number(r.usage_day)||0)}return e}function Y(t,e,n,r,a){return new Promise((function(o,i){if(f)try{var c=f.transaction([S],"readwrite");c.onerror=function(t){i(t.target.error)},c.onabort=function(t){i(new Error("Transaction aborted"))};var u=c.objectStore(S),d=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?l(Object(n),!0).forEach((function(e){s(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({date:t,totalConsumption:Number(e),complete_status:Number(r),channelCount:Number(a),lastUpdated:Date.now()},n),p=u.put(d);p.onsuccess=function(t){o()},p.onerror=function(t){i(t.target.error)},c.oncomplete=function(){}}catch(t){i(t)}else i(new Error("Total consumption database not initialized"))}))}function K(t,e){return Z.apply(this,arguments)}function Z(){return(Z=h(d().mark((function t(e,n){var r,a,i,c,u;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r={},t.prev=1,n&&0!==n.length){t.next=10;break}return t.next=5,G(e);case 5:if(0!==(n=t.sent).length){t.next=10;break}return t.next=9,q();case 9:n=t.sent;case 10:a=o(n),t.prev=12,a.s();case 14:if((i=a.n()).done){t.next=28;break}return c=i.value,t.prev=16,t.next=19,A(c,e);case 19:(u=t.sent)&&(r[c]=u),t.next=26;break;case 23:t.prev=23,t.t0=t.catch(16);case 26:t.next=14;break;case 28:t.next=33;break;case 30:t.prev=30,t.t1=t.catch(12),a.e(t.t1);case 33:return t.prev=33,a.f(),t.finish(33);case 36:t.next=41;break;case 38:t.prev=38,t.t2=t.catch(1);case 41:return t.abrupt("return",r);case 42:case"end":return t.stop()}}),t,null,[[1,38],[12,30,33,36],[16,23]])})))).apply(this,arguments)}function q(){return X.apply(this,arguments)}function X(){return(X=h(d().mark((function t(){var e;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!window.$channels||!Array.isArray(window.$channels)){t.next=4;break}if(!((e=window.$channels.map((function(t){return Number(t[0])})).filter((function(t){return!isNaN(t)}))).length>0)){t.next=4;break}return t.abrupt("return",e);case 4:return t.abrupt("return",J());case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function J(){return $.apply(this,arguments)}function $(){return($=h(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){if(m)try{var n=m.transaction([y],"readonly").objectStore(y).index("zaehlerid").getAllKeys();n.onsuccess=function(e){var n=i(new Set(e.target.result));t(n)},n.onerror=function(e){t([])}}catch(e){t([])}else e(new Error("Hourly database not initialized"))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Q(){return tt.apply(this,arguments)}function tt(){return(tt=h(d().mark((function t(){var e,n,r,a,i,c;return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(m&&f){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,t.next=6,et();case 6:e=t.sent,n=o(e),t.prev=8,n.s();case 10:if((r=n.n()).done){t.next=16;break}return a=r.value,t.next=14,B(a);case 14:t.next=10;break;case 16:t.next=21;break;case 18:t.prev=18,t.t0=t.catch(8),n.e(t.t0);case 21:return t.prev=21,n.f(),t.finish(21);case 24:return i=new Date,c="".concat(i.getFullYear(),"-").concat(String(i.getMonth()+1).padStart(2,"0"),"-").concat(String(i.getDate()).padStart(2,"0")),t.next=28,B(c);case 28:t.next=33;break;case 30:t.prev=30,t.t1=t.catch(3);case 33:case"end":return t.stop()}}),t,null,[[3,30],[8,18,21,24]])})))).apply(this,arguments)}function et(){return nt.apply(this,arguments)}function nt(){return(nt=h(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){if(m)try{var n=m.transaction([y],"readonly").objectStore(y).index("complete_status"),r=n.getAllKeys(IDBKeyRange.only(1));r.onsuccess=function(e){e.target.result;var r=new Set,a=n.getAll(IDBKeyRange.only(1));a.onsuccess=function(e){(e.target.result||[]).forEach((function(t){t.datum&&r.add(t.datum)}));var n=Array.from(r).sort();t(n)},a.onerror=function(e){t([])}},r.onerror=function(e){t([])}}catch(e){t([])}else e(new Error("Hourly database not initialized"))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function rt(t){return new Promise((function(e,n){if(f)try{var r=f.transaction([S],"readonly").objectStore(S).get(t);r.onsuccess=function(t){e(t.target.result||null)},r.onerror=function(t){n(t.target.error)}}catch(t){n(t)}else n(new Error("Total consumption database not initialized"))}))}function at(t,e){return new Promise((function(n,r){if(f)try{var a=f.transaction([S],"readonly").objectStore(S).index("date"),o=IDBKeyRange.bound(t,e),i=a.getAll(o);i.onsuccess=function(t){var e=t.target.result||[];n(e)},i.onerror=function(t){r(t.target.error)}}catch(t){r(t)}else r(new Error("Total consumption database not initialized"))}))}function ot(){return it.apply(this,arguments)}function it(){return(it=h(d().mark((function t(){return d().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,e){if(f)try{var n=f.transaction([S],"readonly").objectStore(S).index("date").getAllKeys();n.onsuccess=function(e){var n=e.target.result||[];n.sort(),t(n)},n.onerror=function(e){t([])}}catch(e){t([])}else e(new Error("Total consumption database not initialized"))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}},750:(t,e,n)=>{var r={"./charts-lang-de-DE.js":456,"./charts-lang-en-US.js":559,"./charts-lang-es-ES.js":290,"./charts-lang-fr-FR.js":178,"./charts-lang-hr-HR.js":778,"./charts-lang-it-IT.js":240,"./charts-lang-nl-NL.js":846,"./charts-lang-sl-SI.js":359};function a(t){return Promise.resolve().then((()=>{if(!n.o(r,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n(r[t])}))}a.keys=()=>Object.keys(r),a.id=750,t.exports=a},778:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});const r={charts:{counterValue:"Brojilo: {0}",backToDailyView:"Natrag na dnevni pregled",clickDayInstructions:"Kliknite na dan za pregled satnih podataka",hourlyConsumption:"Satna Potro\u0161nja (kWh)",dailyConsumption:"Dnevna Potro\u0161nja (kWh)",hourlyData:"Satni Podaci: {0}",dailyData:"Dnevna Potro\u0161nja: {0}",date:"Datum:",startDate:"Po\u010detni Datum",endDate:"Zavr\u0161ni Datum",consumption:"Potro\u0161nja: {0}",noDataAvailable:"Nema dostupnih podataka za ovo razdoblje.",close:"Zatvori",day:"Dan",hour:"Sat",history:{title:"Povijest: {0}",hourlyData:"Satna Potro\u0161nja (Danas)",dailyData:"Dnevna Potro\u0161nja (Zadnjih 7 Dana)"},totalConsumption:"Analiza"},chartStats:{title:"Statistika",total:"Ukupna Potro\u0161nja",average:"Prosjek",median:"Medijan",statistics:"Statistika",averageLine:"Prosjek",medianLine:"Medijan"},chartExport:{abortExport:"Odustani",processingMonth:"Obrada mjeseca: {current} / {total}",processingDay:"Obrada dana: {current} / {total}",aborting:"Odustajanje...",exportCancelled:"Izvoz PDF-a je otkazan",hourlyConsumptionData:"Podaci o Satnoj Potro\u0161nji",dailyConsumptionData:"Podaci o Dnevnoj Potro\u0161nji",exportDropdown:"Izvoz",exportingPDF:"Stvaranje PDF-a...",exportPDFWithDaily:"PDF sa satnim vrijednostima",exportExcelWithDaily:"Excel sa satnim vrijednostima",overviewSheet:"Pregled",detailsSheet:"Dnevni Detalji",exportExcel:"Izvoz Excel",exportPDF:"Izvoz PDF",hour:"Sat",date:"Datum",consumption:"Potro\u0161nja",counter:"Brojilo",dataSheet:"Podaci o Potro\u0161nji",errorExporting:"Gre\u0161ka pri izvozu podataka"},chartPDF:{pageNumbers:"Stranica {current} od {total}"},totalConsumption:{menuItem:"Grafikon Ukupne Potro\u0161nje",chartTitle:"Ukupna Potro\u0161nja Lokacije",totalDailyConsumption:"Ukupna Dnevna Potro\u0161nja (kWh)",noDataAvailable:"Nema dostupnih podataka o ukupnoj potro\u0161nji za odabrano razdoblje.",errorLoadingChart:"Pogre\u0161ka pri u\u010ditavanju grafikona ukupne potro\u0161nje."}}},846:(t,e,n)=>{n.r(e),n.d(e,{default:()=>r});const r={charts:{counterValue:"Teller: {0}",backToDailyView:"Terug naar dagelijks overzicht",clickDayInstructions:"Klik op een dag om uurgegevens te bekijken",hourlyConsumption:"Uurlijks Verbruik (kWh)",dailyConsumption:"Dagelijks Verbruik (kWh)",hourlyData:"Uurlijkse Gegevens: {0}",dailyData:"Dagelijks Verbruik: {0}",date:"Datum:",startDate:"Startdatum",endDate:"Einddatum",consumption:"Verbruik: {0}",noDataAvailable:"Geen gegevens beschikbaar voor deze periode.",close:"Sluiten",day:"Dag",hour:"Uur",history:{title:"Geschiedenis: {0}",hourlyData:"Uurlijks Verbruik (Vandaag)",dailyData:"Dagelijks Verbruik (Laatste 7 Dagen)"},totalConsumption:"Analyses"},chartStats:{title:"Statistieken",total:"Totaal Verbruik",average:"Gemiddelde",median:"Mediaan",statistics:"Statistieken",averageLine:"Gemiddelde",medianLine:"Mediaan"},chartExport:{abortExport:"Afbreken",processingMonth:"Maand verwerken: {current} / {total}",processingDay:"Dag verwerken: {current} / {total}",aborting:"Afbreken...",exportCancelled:"PDF-export is geannuleerd",hourlyConsumptionData:"Uurlijkse Verbruiksgegevens",dailyConsumptionData:"Dagelijkse Verbruiksgegevens",exportDropdown:"Exporteren",exportingPDF:"PDF wordt gegenereerd...",exportPDFWithDaily:"PDF met uurwaarden",exportExcelWithDaily:"Excel met uurwaarden",overviewSheet:"Overzicht",detailsSheet:"Dagelijkse Details",exportExcel:"Exporteren naar Excel",exportPDF:"Exporteren als PDF",hour:"Uur",date:"Datum",consumption:"Verbruik",counter:"Tellerstand",dataSheet:"Verbruiksgegevens",errorExporting:"Fout bij exporteren gegevens"},chartPDF:{pageNumbers:"Pagina {current} van {total}"},totalConsumption:{menuItem:"Totaal Verbruik Grafiek",chartTitle:"Totaal Verbruik van de Locatie",totalDailyConsumption:"Dagelijks Totaal Verbruik (kWh)",noDataAvailable:"Geen totaal verbruiksgegevens beschikbaar voor de geselecteerde periode.",errorLoadingChart:"Fout bij het laden van de totaal verbruik grafiek."}}}},n={};function r(t){var a=n[t];if(void 0!==a)return a.exports;var o=n[t]={exports:{}};return e[t](o,o.exports,r),o.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.e=()=>Promise.resolve(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(t=r(405)).keys().forEach(t),(()=>{var t=r(121),e=r(690),n=r(618),a=r(313);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return(e=function(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function l(){l=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},c=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function d(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var o=e&&e.prototype instanceof w?e:w,i=Object.create(o.prototype),c=new O(r||[]);return a(i,"_invoke",{value:L(t,n,c)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var f="suspendedStart",m="suspendedYield",v="executing",g="completed",y={};function w(){}function b(){}function x(){}var D={};d(D,c,(function(){return this}));var k=Object.getPrototypeOf,E=k&&k(k(I([])));E&&E!==n&&r.call(E,c)&&(D=E);var S=x.prototype=w.prototype=Object.create(D);function C(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function T(t,e){function n(a,i,c,u){var l=h(t[a],t,i);if("throw"!==l.type){var s=l.arg,d=s.value;return d&&"object"==o(d)&&r.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,c,u)}),(function(t){n("throw",t,c,u)})):e.resolve(d).then((function(t){s.value=t,c(s)}),(function(t){return n("throw",t,c,u)}))}u(l.arg)}var i;a(this,"_invoke",{value:function(t,r){function a(){return new e((function(e,a){n(t,r,e,a)}))}return i=i?i.then(a,a):a()}})}function L(e,n,r){var a=f;return function(o,i){if(a===v)throw Error("Generator is already running");if(a===g){if("throw"===o)throw i;return{value:t,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var u=j(c,r);if(u){if(u===y)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===f)throw a=g,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=v;var l=h(e,n,r);if("normal"===l.type){if(a=r.done?g:m,l.arg===y)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=g,r.method="throw",r.arg=l.arg)}}}function j(e,n){var r=n.method,a=e.iterator[r];if(a===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,j(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=h(a,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,y;var i=o.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function I(e){if(e||""===e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(o(e)+" is not iterable")}return b.prototype=x,a(S,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:b,configurable:!0}),b.displayName=d(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,d(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},C(T.prototype),d(T.prototype,u,(function(){return this})),e.AsyncIterator=T,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new T(p(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},C(S),d(S,s,"Generator"),d(S,c,(function(){return this})),d(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=I,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return c.type="throw",c.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=t,i.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),_(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var a=r.arg;_(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),y}},e}function s(t,e,n,r,a,o,i){try{var c=t[o](i),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,a)}function d(t){return function(){var e=this,n=arguments;return new Promise((function(r,a){var o=t.apply(e,n);function i(t){s(o,r,a,i,c,"next",t)}function c(t){s(o,r,a,i,c,"throw",t)}i(void 0)}))}}void 0===window._chartsModuleInitialized&&(window._chartsModuleInitialized=!1);var p,h=new Set,f={initialized:!1,initializing:!1,error:null};function m(){return v.apply(this,arguments)}function v(){return v=d(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,b();case 3:return window.translations=window.translations||{},window.translations.charts=window.translations.charts||{},window.translations.chartStats=window.translations.chartStats||{},window.translations.chartExport=window.translations.chartExport||{},window.translations.chartPDF=window.translations.chartPDF||{},t.next=10,y(window.getCurrentLanguage());case 10:return document.addEventListener("languageChanged",function(){var t=d(l().mark((function t(e){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.detail||!e.detail.newLanguage){t.next=4;break}return t.next=3,y(e.detail.newLanguage);case 3:g();case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),e=void 0,(e=document.createElement("style")).textContent="\n    /* Chart statistics panel */\n    .chart-stats-panel {\n        display: flex;\n        justify-content: space-around;\n        background-color: #f8f9fa;\n        border-radius: 4px;\n        padding: 8px 16px;\n        margin: 15px 0;\n        border: 1px solid #dee2e6;\n    }\n    \n    .chart-stats-panel .stat-item {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        padding: 5px 10px;\n    }\n    \n    .chart-stats-panel .stat-label {\n        font-size: 0.85rem;\n        color: #6c757d;\n        margin-bottom: 3px;\n    }\n    \n    .chart-stats-panel .stat-value {\n        font-size: 1.1rem;\n        font-weight: 500;\n        color: #0076A8; /* CTOOLS blue */\n    }\n    \n    /* Export buttons container */\n    .chart-export-buttons {\n        display: flex;\n        justify-content: flex-end;\n        gap: 10px;\n        margin-bottom: 15px;\n    }\n    \n    .chart-export-buttons .btn {\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        white-space: nowrap;\n    }\n    \n    .chart-export-buttons .btn i {\n        margin-right: 5px;\n    }\n    \n    /* Responsive adjustments */\n    @media (max-width: 768px) {\n        .chart-stats-panel {\n            flex-direction: column;\n            align-items: center;\n            padding: 8px;\n        }\n        \n        .chart-stats-panel .stat-item {\n            margin-bottom: 5px;\n            width: 100%;\n            flex-direction: row;\n            justify-content: space-between;\n        }\n        \n        .chart-stats-panel .stat-label {\n            margin-right: 10px;\n            margin-bottom: 0;\n        }\n        \n        /* Adjust export buttons for mobile */\n        .chart-export-buttons {\n            justify-content: center;\n        }\n        \n        .chart-export-buttons .btn {\n            padding: 4px 8px;\n            font-size: 0.85rem;\n        }\n    }\n    ",document.head.appendChild(e),t.abrupt("return",!0);case 16:return t.prev=16,t.t0=t.catch(0),t.abrupt("return",!1);case 20:case"end":return t.stop()}var e}),t,null,[[0,16]])}))),v.apply(this,arguments)}function g(){var t=document.getElementById("total-consumption-chart");if(t){var e=t.querySelector("span");e&&(e.textContent=window.getTranslatedText("totalConsumption","menuItem"))}}function y(t){return w.apply(this,arguments)}function w(){return(w=d(l().mark((function t(e){var n;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=e||"en-US",!h.has(e)){t.next=4;break}return(0,a.Se)(),t.abrupt("return",!0);case 4:return t.prev=4,t.next=7,r(750)("./charts-lang-".concat(e,".js"));case 7:if(!(n=t.sent).default){t.next=20;break}return n.default.charts&&(window.translations.charts=c(c({},window.translations.charts),n.default.charts)),n.default.chartStats&&(window.translations.chartStats=c(c({},window.translations.chartStats),n.default.chartStats)),n.default.chartExport&&(window.translations.chartExport=c(c({},window.translations.chartExport),n.default.chartExport)),n.default.chartPDF&&(window.translations.chartPDF=c(c({},window.translations.chartPDF),n.default.chartPDF)),n.default.totalConsumption&&(window.translations.totalConsumption=c(c({},window.translations.totalConsumption),n.default.totalConsumption)),(0,a.Se)(),h.add(e),t.abrupt("return",!0);case 20:throw new Error("Invalid language module format for ".concat(e));case 21:t.next=30;break;case 23:if(t.prev=23,t.t0=t.catch(4),"en-US"===e){t.next=29;break}return t.abrupt("return",y("en-US"));case 29:return t.abrupt("return",!1);case 30:case"end":return t.stop()}}),t,null,[[4,23]])})))).apply(this,arguments)}function b(){return x.apply(this,arguments)}function x(){return(x=d(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=4,D("https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js");case 4:return t.next=6,D("https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js");case 6:return t.next=8,D("https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js");case 8:return t.abrupt("return",!0);case 12:return t.prev=12,t.t0=t.catch(0),t.abrupt("return",!1);case 16:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}function D(t){return new Promise((function(e,n){var r=document.createElement("script");r.src=t,r.async=!0,r.onload=function(){return e()},r.onerror=function(t){return n(t)},document.head.appendChild(r)}))}(p=d(l().mark((function r(){var a;return l().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!window.__CTOOLSchartsModuleInitialized){r.next=2;break}return r.abrupt("return");case 2:return window.__CTOOLSchartsModuleInitialized=!0,f.initializing=!0,r.prev=4,r.next=7,(0,n.C)();case 7:return r.next=9,(0,e.Qm)();case 9:return r.next=11,(0,t.initializeChartResources)();case 11:return r.next=13,m();case 13:if(a=r.sent,f.initialized=a,f.initializing=!1,!a){r.next=21;break}document.dispatchEvent(new CustomEvent("moduleReady",{detail:{module:"charts",success:!0}})),r.next=22;break;case 21:throw new Error("Chart initialization failed");case 22:r.next=30;break;case 24:r.prev=24,r.t0=r.catch(4),f.error=r.t0,f.initializing=!1,document.dispatchEvent(new CustomEvent("moduleReady",{detail:{module:"charts",success:!1,error:r.t0.message}}));case 30:case"end":return r.stop()}}),r,null,[[4,24]])}))),function(){return p.apply(this,arguments)})()})();